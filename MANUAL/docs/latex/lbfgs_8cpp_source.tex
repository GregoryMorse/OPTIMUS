\hypertarget{lbfgs_8cpp_source}{}\doxysection{lbfgs.\+cpp}
\label{lbfgs_8cpp_source}\index{lbfgs.cpp@{lbfgs.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}lbfgs.h"{}}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00003}00003 \textcolor{keyword}{static} integer c\_\_1 = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00005}00005 Lbfgs::Lbfgs(\mbox{\hyperlink{classProblem}{Problem}} *p)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00006}00006 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00007}00007     myProblem=p;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00008}00008 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00010}00010 \textcolor{keywordtype}{double} Lbfgs::Solve(Data \&x)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00011}00011 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00012}00012     integer iprint=0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00013}00013     \textcolor{keywordtype}{double} factr=1e7;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00014}00014     \textcolor{keywordtype}{double} pgtol = 1e-\/5;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00015}00015     integer n=x.size();}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00016}00016     integer m=5;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00017}00017     integer *nbd=\textcolor{keyword}{new} integer[x.size()];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00018}00018     \textcolor{keywordtype}{double} *l=\textcolor{keyword}{new} \textcolor{keywordtype}{double}[x.size()];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00019}00019     \textcolor{keywordtype}{double} *u=\textcolor{keyword}{new} \textcolor{keywordtype}{double}[x.size()];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00020}00020     \textcolor{keywordtype}{double} *g=\textcolor{keyword}{new} \textcolor{keywordtype}{double}[x.size()];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00021}00021     Data gg;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00022}00022     gg.resize(x.size());}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00023}00023     myProblem-\/>\mbox{\hyperlink{classProblem_a56c412d0707c8e7212e1dd1353111f35}{getleftmarginx}}(l);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00024}00024     myProblem-\/>\mbox{\hyperlink{classProblem_abc38aa5f26b833cae8d719303ad3e079}{getrightmarginx}}(u);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00025}00025     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<n;i++)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00026}00026     \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00027}00027         nbd[i]=2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00028}00028     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00029}00029     integer taskValue;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00030}00030     integer *task=\&taskValue;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00031}00031     *task = (integer)START;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00032}00032     \textcolor{keywordtype}{double} f;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00033}00033     \textcolor{keyword}{const} \textcolor{keywordtype}{int} mmax=20;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00034}00034     \textcolor{keywordtype}{double} *wa=\textcolor{keyword}{new} \textcolor{keywordtype}{double}[(2*mmax+5)*n+11*mmax*11*mmax+8*mmax];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00035}00035     integer *iwa=\textcolor{keyword}{new} integer[3*n];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00036}00036     integer csaveValue;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00037}00037     integer *csave=\&csaveValue;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00038}00038     \textcolor{keywordtype}{double} dsave[29];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00039}00039     integer isave[44];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00040}00040     logical lsave[4];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00041}00041     \textcolor{keywordtype}{double} *xx=\textcolor{keyword}{new} \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00042}00042     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<x.size();i++) xx[i]=x[i];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00043}00043     \textcolor{keywordtype}{int} iters = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00044}00044 L111:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00045}00045     setulb(\&n, \&m, xx, l, u, nbd, \&f, g, \&factr, \&pgtol, wa, iwa, task, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00046}00046             iprint, csave, lsave, isave, dsave);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00047}00047     \textcolor{keywordflow}{if} ( IS\_FG(*task) ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00048}00048         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<x.size();i++) x[i]=xx[i];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00049}00049         f=myProblem-\/>\mbox{\hyperlink{classProblem_a1d4dd1303141465d145b5b728c0b2d81}{funmin}}(x);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00050}00050         \textcolor{comment}{//printf("{}LBFGS: \%10.5lf TASK: \%d\(\backslash\)n"{},f,*task);}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00051}00051         myProblem-\/>\mbox{\hyperlink{classProblem_a2f694855dacafb36c04abc3886f09543}{granal}}(x,gg);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00052}00052         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<x.size();i++)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00053}00053             g[i]=gg[i];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00054}00054         \textcolor{keywordflow}{goto} L111;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00055}00055     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00056}00056     iters++;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00057}00057     \textcolor{keywordflow}{if} ( *task==NEW\_X || iters<50 ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00058}00058         \textcolor{keywordflow}{goto} L111;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00059}00059     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00060}00060     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<x.size();i++) x[i]=xx[i];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00061}00061     \textcolor{keyword}{delete}[] xx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00062}00062     \textcolor{keyword}{delete}[] iwa;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00063}00063     \textcolor{keyword}{delete}[] wa;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00064}00064     \textcolor{keyword}{delete}[] g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00065}00065     \textcolor{keyword}{delete}[] l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00066}00066     \textcolor{keyword}{delete}[] u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00067}00067     \textcolor{keyword}{delete}[] nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00068}00068     \textcolor{keywordflow}{return} myProblem-\/>\mbox{\hyperlink{classProblem_a1d4dd1303141465d145b5b728c0b2d81}{funmin}}(x);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00069}00069 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00073}00073 \textcolor{keyword}{static} \textcolor{keywordtype}{double} c\_b7 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00074}00074 \textcolor{comment}{/* SRB: note that task\_len is no longer used since task}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00075}00075 \textcolor{comment}{ * is now integer* not char*.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00076}00076 \textcolor{comment}{ * Similarly for csave (now integer*) and so csave\_len not used */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00078}00078 \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} Lbfgs::mainlb(integer *n, integer *m, \textcolor{keywordtype}{double} *x,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00079}00079     \textcolor{keywordtype}{double} *l, \textcolor{keywordtype}{double} *u, integer *nbd, \textcolor{keywordtype}{double} *f, \textcolor{keywordtype}{double}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00080}00080     *g, \textcolor{keywordtype}{double} *factr, \textcolor{keywordtype}{double} *pgtol, \textcolor{keywordtype}{double} *ws, \textcolor{keywordtype}{double} *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00081}00081     wy, \textcolor{keywordtype}{double} *sy, \textcolor{keywordtype}{double} *ss, \textcolor{keywordtype}{double} *wt, \textcolor{keywordtype}{double} *wn,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00082}00082     \textcolor{keywordtype}{double} *snd, \textcolor{keywordtype}{double} *z\_\_, \textcolor{keywordtype}{double} *r\_\_, \textcolor{keywordtype}{double} *d\_\_,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00083}00083     \textcolor{keywordtype}{double} *t, \textcolor{keywordtype}{double} *xp, \textcolor{keywordtype}{double} *wa, integer *index,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00084}00084     integer *iwhere, integer *indx2, integer *task, integer *iprint,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00085}00085     integer *csave, logical *lsave, integer *isave, \textcolor{keywordtype}{double} *dsave) \textcolor{comment}{/*(ftnlen ) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00086}00086 \textcolor{comment}{/*  task\_len, ftnlen csave\_len) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00087}00087 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00089}00089     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00090}00090     integer ws\_dim1, ws\_offset, wy\_dim1, wy\_offset, sy\_dim1, sy\_offset,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00091}00091         ss\_dim1, ss\_offset, wt\_dim1, wt\_offset, wn\_dim1, wn\_offset,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00092}00092         snd\_dim1, snd\_offset, i\_\_1=0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00093}00093     \textcolor{keywordtype}{double} d\_\_1, d\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00094}00094     FILE* o\_\_1=NULL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00096}00096     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00097}00097      integer i\_\_, k;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00098}00098     \textcolor{keywordtype}{double} gd, dr, rr, dtd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00099}00099     integer col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00100}00100     \textcolor{keywordtype}{double} tol;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00101}00101     logical wrk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00102}00102     \textcolor{keywordtype}{double} stp, cpu1, cpu2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00103}00103     integer head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00104}00104     \textcolor{keywordtype}{double} fold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00105}00105     integer nact;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00106}00106     \textcolor{keywordtype}{double} ddum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00107}00107     integer info, nseg;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00108}00108     \textcolor{keywordtype}{double} time;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00109}00109     integer nfgv, ifun, iter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00110}00110     integer wordTemp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00111}00111     integer *word=\&wordTemp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00112}00112     \textcolor{keywordtype}{double} time1, time2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00113}00113     integer iback;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00114}00114     \textcolor{keywordtype}{double} gdold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00115}00115     integer nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00116}00116     logical boxed;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00117}00117     integer itail;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00118}00118     \textcolor{keywordtype}{double} theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00119}00119     \textcolor{keywordtype}{double} dnorm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00120}00120     integer nskip, iword;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00121}00121     \textcolor{keywordtype}{double} xstep, stpmx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00122}00122     integer ileave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00123}00123     \textcolor{keywordtype}{double} cachyt;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00124}00124     integer itfile;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00125}00125     \textcolor{keywordtype}{double} epsmch;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00126}00126     logical updatd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00127}00127     \textcolor{keywordtype}{double} sbtime;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00128}00128     logical prjctd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00129}00129     integer iupdat;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00130}00130     \textcolor{keywordtype}{double} sbgnrm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00131}00131     logical cnstnd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00132}00132     integer nenter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00133}00133     \textcolor{keywordtype}{double} lnscht;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00134}00134     integer nintol;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00136}00136 \textcolor{comment}{/* -\/jlm-\/jn */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00137}00137 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00139}00139 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00140}00140 \textcolor{comment}{    Subroutine mainlb}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00141}00141 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00142}00142 \textcolor{comment}{    This subroutine solves bound constrained optimization problems by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00143}00143 \textcolor{comment}{      using the compact formula of the limited memory BFGS updates.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00144}00144 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00145}00145 \textcolor{comment}{    n is an integer variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00146}00146 \textcolor{comment}{      On entry n is the number of variables.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00147}00147 \textcolor{comment}{      On exit n is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00148}00148 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00149}00149 \textcolor{comment}{    m is an integer variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00150}00150 \textcolor{comment}{      On entry m is the maximum number of variable metric}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00151}00151 \textcolor{comment}{         corrections allowed in the limited memory matrix.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00152}00152 \textcolor{comment}{      On exit m is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00153}00153 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00154}00154 \textcolor{comment}{    x is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00155}00155 \textcolor{comment}{      On entry x is an approximation to the solution.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00156}00156 \textcolor{comment}{      On exit x is the current approximation.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00157}00157 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00158}00158 \textcolor{comment}{    l is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00159}00159 \textcolor{comment}{      On entry l is the lower bound of x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00160}00160 \textcolor{comment}{      On exit l is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00161}00161 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00162}00162 \textcolor{comment}{    u is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00163}00163 \textcolor{comment}{      On entry u is the upper bound of x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00164}00164 \textcolor{comment}{      On exit u is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00165}00165 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00166}00166 \textcolor{comment}{    nbd is an integer array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00167}00167 \textcolor{comment}{      On entry nbd represents the type of bounds imposed on the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00168}00168 \textcolor{comment}{        variables, and must be specified as follows:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00169}00169 \textcolor{comment}{        nbd(i)=0 if x(i) is unbounded,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00170}00170 \textcolor{comment}{               1 if x(i) has only a lower bound,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00171}00171 \textcolor{comment}{               2 if x(i) has both lower and upper bounds,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00172}00172 \textcolor{comment}{               3 if x(i) has only an upper bound.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00173}00173 \textcolor{comment}{      On exit nbd is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00174}00174 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00175}00175 \textcolor{comment}{    f is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00176}00176 \textcolor{comment}{      On first entry f is unspecified.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00177}00177 \textcolor{comment}{      On final exit f is the value of the function at x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00178}00178 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00179}00179 \textcolor{comment}{    g is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00180}00180 \textcolor{comment}{      On first entry g is unspecified.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00181}00181 \textcolor{comment}{      On final exit g is the value of the gradient at x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00182}00182 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00183}00183 \textcolor{comment}{    factr is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00184}00184 \textcolor{comment}{      On entry factr >= 0 is specified by the user.  The iteration}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00185}00185 \textcolor{comment}{        will stop when}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00186}00186 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00187}00187 \textcolor{comment}{        (f\string^k -\/ f\string^\{k+1\})/max\{|f\string^k|,|f\string^\{k+1\}|,1\} <= factr*epsmch}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00188}00188 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00189}00189 \textcolor{comment}{        where epsmch is the machine precision, which is automatically}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00190}00190 \textcolor{comment}{        generated by the code.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00191}00191 \textcolor{comment}{      On exit factr is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00192}00192 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00193}00193 \textcolor{comment}{    pgtol is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00194}00194 \textcolor{comment}{      On entry pgtol >= 0 is specified by the user.  The iteration}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00195}00195 \textcolor{comment}{        will stop when}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00196}00196 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00197}00197 \textcolor{comment}{                max\{|proj g\_i | i = 1, ..., n\} <= pgtol}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00198}00198 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00199}00199 \textcolor{comment}{        where pg\_i is the ith component of the projected gradient.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00200}00200 \textcolor{comment}{      On exit pgtol is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00201}00201 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00202}00202 \textcolor{comment}{    ws, wy, sy, and wt are double precision working arrays used to}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00203}00203 \textcolor{comment}{      store the following information defining the limited memory}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00204}00204 \textcolor{comment}{         BFGS matrix:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00205}00205 \textcolor{comment}{         ws, of dimension n x m, stores S, the matrix of s-\/vectors;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00206}00206 \textcolor{comment}{         wy, of dimension n x m, stores Y, the matrix of y-\/vectors;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00207}00207 \textcolor{comment}{         sy, of dimension m x m, stores S'Y;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00208}00208 \textcolor{comment}{         ss, of dimension m x m, stores S'S;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00209}00209 \textcolor{comment}{         yy, of dimension m x m, stores Y'Y;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00210}00210 \textcolor{comment}{         wt, of dimension m x m, stores the Cholesky factorization}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00211}00211 \textcolor{comment}{                                 of (theta*S'S+LD\string^(-\/1)L'); see eq.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00212}00212 \textcolor{comment}{                                 (2.26) in [3].}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00213}00213 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00214}00214 \textcolor{comment}{    wn is a double precision working array of dimension 2m x 2m}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00215}00215 \textcolor{comment}{      used to store the LEL\string^T factorization of the indefinite matrix}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00216}00216 \textcolor{comment}{                K = [-\/D -\/Y'ZZ'Y/theta     L\_a'-\/R\_z'  ]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00217}00217 \textcolor{comment}{                    [L\_a -\/R\_z           theta*S'AA'S ]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00218}00218 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00219}00219 \textcolor{comment}{      where     E = [-\/I  0]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00220}00220 \textcolor{comment}{                    [ 0  I]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00221}00221 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00222}00222 \textcolor{comment}{    snd is a double precision working array of dimension 2m x 2m}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00223}00223 \textcolor{comment}{      used to store the lower triangular part of}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00224}00224 \textcolor{comment}{                N = [Y' ZZ'Y   L\_a'+R\_z']}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00225}00225 \textcolor{comment}{                    [L\_a +R\_z  S'AA'S   ]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00226}00226 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00227}00227 \textcolor{comment}{    z(n),r(n),d(n),t(n), xp(n),wa(8*m) are double precision working arrays.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00228}00228 \textcolor{comment}{      z  is used at different times to store the Cauchy point and}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00229}00229 \textcolor{comment}{         the Newton point.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00230}00230 \textcolor{comment}{      xp is used to safeguard the projected Newton direction}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00231}00231 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00232}00232 \textcolor{comment}{    sg(m),sgo(m),yg(m),ygo(m) are double precision working arrays.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00233}00233 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00234}00234 \textcolor{comment}{    index is an integer working array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00235}00235 \textcolor{comment}{      In subroutine freev, index is used to store the free and fixed}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00236}00236 \textcolor{comment}{         variables at the Generalized Cauchy Point (GCP).}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00237}00237 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00238}00238 \textcolor{comment}{    iwhere is an integer working array of dimension n used to record}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00239}00239 \textcolor{comment}{      the status of the vector x for GCP computation.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00240}00240 \textcolor{comment}{      iwhere(i)=0 or -\/3 if x(i) is free and has bounds,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00241}00241 \textcolor{comment}{                1       if x(i) is fixed at l(i), and l(i) .ne. u(i)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00242}00242 \textcolor{comment}{                2       if x(i) is fixed at u(i), and u(i) .ne. l(i)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00243}00243 \textcolor{comment}{                3       if x(i) is always fixed, i.e.,  u(i)=x(i)=l(i)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00244}00244 \textcolor{comment}{               -\/1       if x(i) is always free, i.e., no bounds on it.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00245}00245 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00246}00246 \textcolor{comment}{    indx2 is an integer working array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00247}00247 \textcolor{comment}{      Within subroutine cauchy, indx2 corresponds to the array iorder.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00248}00248 \textcolor{comment}{      In subroutine freev, a list of variables entering and leaving}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00249}00249 \textcolor{comment}{      the free set is stored in indx2, and it is passed on to}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00250}00250 \textcolor{comment}{      subroutine formk with this information.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00251}00251 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00252}00252 \textcolor{comment}{    task is a working string of characters of length 60 indicating}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00253}00253 \textcolor{comment}{      the current job when entering and leaving this subroutine.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00254}00254 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00255}00255 \textcolor{comment}{    iprint is an INTEGER variable that must be set by the user.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00256}00256 \textcolor{comment}{      It controls the frequency and type of output generated:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00257}00257 \textcolor{comment}{       iprint<0    no output is generated;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00258}00258 \textcolor{comment}{       iprint=0    print only one line at the last iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00259}00259 \textcolor{comment}{       0<iprint<99 print also f and |proj g| every iprint iterations;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00260}00260 \textcolor{comment}{       iprint=99   print details of every iteration except n-\/vectors;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00261}00261 \textcolor{comment}{       iprint=100  print also the changes of active set and final x;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00262}00262 \textcolor{comment}{       iprint>100  print details of every iteration including x and g;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00263}00263 \textcolor{comment}{      When iprint > 0, the file iterate.dat will be created to}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00264}00264 \textcolor{comment}{                       summarize the iteration.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00265}00265 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00266}00266 \textcolor{comment}{    csave is a working string of characters of length 60.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00267}00267 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00268}00268 \textcolor{comment}{    lsave is a logical working array of dimension 4.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00269}00269 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00270}00270 \textcolor{comment}{    isave is an integer working array of dimension 23.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00271}00271 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00272}00272 \textcolor{comment}{    dsave is a double precision working array of dimension 29.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00273}00273 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00274}00274 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00275}00275 \textcolor{comment}{    Subprograms called}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00276}00276 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00277}00277 \textcolor{comment}{      L-\/BFGS-\/B Library ... cauchy, subsm, lnsrlb, formk,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00278}00278 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00279}00279 \textcolor{comment}{       errclb, prn1lb, prn2lb, prn3lb, active, projgr,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00280}00280 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00281}00281 \textcolor{comment}{       freev, cmprlb, matupd, formt.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00282}00282 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00283}00283 \textcolor{comment}{      Minpack2 Library ... timer}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00284}00284 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00285}00285 \textcolor{comment}{      Linpack Library ... dcopy, ddot.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00286}00286 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00287}00287 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00288}00288 \textcolor{comment}{    References:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00289}00289 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00290}00290 \textcolor{comment}{      [1] R. H. Byrd, P. Lu, J. Nocedal and C. Zhu, ``A limited}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00291}00291 \textcolor{comment}{      memory algorithm for bound constrained optimization'',}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00292}00292 \textcolor{comment}{      SIAM J. Scientific Computing 16 (1995), no. 5, pp. 1190-\/-\/1208.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00293}00293 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00294}00294 \textcolor{comment}{      [2] C. Zhu, R.H. Byrd, P. Lu, J. Nocedal, ``L-\/BFGS-\/B: FORTRAN}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00295}00295 \textcolor{comment}{      Subroutines for Large Scale Bound Constrained Optimization''}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00296}00296 \textcolor{comment}{      Tech. Report, NAM-\/11, EECS Department, Northwestern University,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00297}00297 \textcolor{comment}{      1994.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00298}00298 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00299}00299 \textcolor{comment}{      [3] R. Byrd, J. Nocedal and R. Schnabel "{}Representations of}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00300}00300 \textcolor{comment}{      Quasi-\/Newton Matrices and their use in Limited Memory Methods'',}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00301}00301 \textcolor{comment}{      Mathematical Programming 63 (1994), no. 4, pp. 129-\/156.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00302}00302 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00303}00303 \textcolor{comment}{      (Postscript files of these papers are available via anonymous}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00304}00304 \textcolor{comment}{       ftp to eecs.nwu.edu in the directory pub/lbfgs/lbfgs\_bcm.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00305}00305 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00306}00306 \textcolor{comment}{                          *  *  *}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00307}00307 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00308}00308 \textcolor{comment}{    NEOS, November 1994. (Latest revision June 1996.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00309}00309 \textcolor{comment}{    Optimization Technology Center.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00310}00310 \textcolor{comment}{    Argonne National Laboratory and Northwestern University.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00311}00311 \textcolor{comment}{    Written by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00312}00312 \textcolor{comment}{                       Ciyou Zhu}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00313}00313 \textcolor{comment}{    in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00314}00314 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00315}00315 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00316}00316 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00317}00317 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00318}00318     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00319}00319     -\/-\/indx2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00320}00320     -\/-\/iwhere;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00321}00321     -\/-\/index;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00322}00322     -\/-\/xp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00323}00323     -\/-\/t;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00324}00324     -\/-\/d\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00325}00325     -\/-\/r\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00326}00326     -\/-\/z\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00327}00327     -\/-\/g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00328}00328     -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00329}00329     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00330}00330     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00331}00331     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00332}00332     -\/-\/wa;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00333}00333     snd\_dim1 = 2 * *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00334}00334     snd\_offset = 1 + snd\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00335}00335     snd -\/= snd\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00336}00336     wn\_dim1 = 2 * *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00337}00337     wn\_offset = 1 + wn\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00338}00338     wn -\/= wn\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00339}00339     wt\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00340}00340     wt\_offset = 1 + wt\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00341}00341     wt -\/= wt\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00342}00342     ss\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00343}00343     ss\_offset = 1 + ss\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00344}00344     ss -\/= ss\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00345}00345     sy\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00346}00346     sy\_offset = 1 + sy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00347}00347     sy -\/= sy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00348}00348     wy\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00349}00349     wy\_offset = 1 + wy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00350}00350     wy -\/= wy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00351}00351     ws\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00352}00352     ws\_offset = 1 + ws\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00353}00353     ws -\/= ws\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00354}00354     -\/-\/lsave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00355}00355     -\/-\/isave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00356}00356     -\/-\/dsave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00357}00357 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00358}00358     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00359}00359     \textcolor{keywordflow}{if} ( *task == START ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00360}00360         epsmch = DBL\_EPSILON;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00361}00361         timer(\&time1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00362}00362         \textcolor{comment}{/*        Initialize counters and scalars when task='START'. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00363}00363         \textcolor{comment}{/*           for the limited memory BFGS matrices: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00364}00364         col = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00365}00365         head = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00366}00366         theta = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00367}00367         iupdat = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00368}00368         updatd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00369}00369         iback = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00370}00370         itail = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00371}00371         iword = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00372}00372         nact = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00373}00373         ileave = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00374}00374         nenter = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00375}00375         fold = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00376}00376         dnorm = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00377}00377         cpu1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00378}00378         gd = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00379}00379         stpmx = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00380}00380         sbgnrm = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00381}00381         stp = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00382}00382         gdold = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00383}00383         dtd = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00384}00384         \textcolor{comment}{/*           for operation counts: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00385}00385         iter = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00386}00386         nfgv = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00387}00387         nseg = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00388}00388         nintol = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00389}00389         nskip = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00390}00390         nfree = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00391}00391         ifun = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00392}00392         \textcolor{comment}{/*           for stopping tolerance: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00393}00393         tol = *factr * epsmch;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00394}00394         \textcolor{comment}{/*           for measuring running time: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00395}00395         cachyt = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00396}00396         sbtime = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00397}00397         lnscht = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00398}00398         \textcolor{comment}{/*           'word' records the status of subspace solutions. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00399}00399         *word = WORD\_DEFAULT;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00400}00400 \textcolor{comment}{/*         s\_copy(word, "{}-\/-\/-\/"{}, (ftnlen)3, (ftnlen)3); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00401}00401         \textcolor{comment}{/*           'info' records the termination information. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00402}00402         info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00403}00403         itfile = 8;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00404}00404         \textcolor{comment}{/* Note: no longer trying to write to file */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00405}00405         \textcolor{comment}{/*        Check the input arguments for errors. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00406}00406         errclb(n, m, factr, \&l[1], \&u[1], \&nbd[1], task, \&info, \&k, (ftnlen)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00407}00407                 60);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00408}00408         \textcolor{keywordflow}{if} ( IS\_ERROR(*task) )\{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00409}00409             prn3lb(n, \&x[1], f, task, iprint, \&info, o\_\_1, \&iter, \&nfgv, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00410}00410                     nintol, \&nskip, \&nact, \&sbgnrm, \&c\_b7, \&nseg, word, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00411}00411                     iback, \&stp, \&xstep, \&k, \&cachyt, \&sbtime, \&lnscht, (}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00412}00412                         ftnlen)60, (ftnlen)3);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00413}00413             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00414}00414         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00415}00415         prn1lb(n, m, \&l[1], \&u[1], \&x[1], iprint, o\_\_1, \&epsmch);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00416}00416         active(n, \&l[1], \&u[1], \&nbd[1], \&x[1], \&iwhere[1], iprint, \&prjctd,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00417}00417                 \&cnstnd, \&boxed);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00418}00418         \textcolor{comment}{/*        The end of the initialization. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00419}00419     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00420}00420         \textcolor{comment}{/*          restore local variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00421}00421         prjctd = lsave[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00422}00422         cnstnd = lsave[2];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00423}00423         boxed = lsave[3];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00424}00424         updatd = lsave[4];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00425}00425         nintol = isave[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00426}00426         itfile = isave[3];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00427}00427         iback = isave[4];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00428}00428         nskip = isave[5];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00429}00429         head = isave[6];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00430}00430         col = isave[7];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00431}00431         itail = isave[8];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00432}00432         iter = isave[9];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00433}00433         iupdat = isave[10];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00434}00434         nseg = isave[12];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00435}00435         nfgv = isave[13];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00436}00436         info = isave[14];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00437}00437         ifun = isave[15];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00438}00438         iword = isave[16];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00439}00439         nfree = isave[17];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00440}00440         nact = isave[18];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00441}00441         ileave = isave[19];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00442}00442         nenter = isave[20];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00443}00443         theta = dsave[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00444}00444         fold = dsave[2];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00445}00445         tol = dsave[3];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00446}00446         dnorm = dsave[4];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00447}00447         epsmch = dsave[5];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00448}00448         cpu1 = dsave[6];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00449}00449         cachyt = dsave[7];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00450}00450         sbtime = dsave[8];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00451}00451         lnscht = dsave[9];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00452}00452         time1 = dsave[10];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00453}00453         gd = dsave[11];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00454}00454         stpmx = dsave[12];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00455}00455         sbgnrm = dsave[13];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00456}00456         stp = dsave[14];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00457}00457         gdold = dsave[15];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00458}00458         dtd = dsave[16];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00459}00459         \textcolor{comment}{/*        After returning from the driver go to the point where execution */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00460}00460         \textcolor{comment}{/*        is to resume. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00461}00461         \textcolor{keywordflow}{if} ( *task == FG\_LN ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00462}00462             \textcolor{keywordflow}{goto} L666;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00463}00463         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00464}00464         \textcolor{keywordflow}{if} ( *task == NEW\_X ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00465}00465             \textcolor{keywordflow}{goto} L777;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00466}00466         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00467}00467         \textcolor{keywordflow}{if} ( *task == FG\_ST ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00468}00468             \textcolor{keywordflow}{goto} L111;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00469}00469         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00470}00470         \textcolor{keywordflow}{if} ( IS\_STOP(*task) ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00471}00471             \textcolor{keywordflow}{if} ( *task == STOP\_CPU ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00472}00472                 \textcolor{comment}{/*    restore the previous iterate. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00473}00473                 dcopy(n, \&t[1], \&c\_\_1, \&x[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00474}00474                 dcopy(n, \&r\_\_[1], \&c\_\_1, \&g[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00475}00475                 *f = fold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00476}00476             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00477}00477             \textcolor{keywordflow}{goto} L999;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00478}00478         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00479}00479     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00480}00480     \textcolor{comment}{/*     Compute f0 and g0. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00481}00481     *task = FG\_START;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00482}00482     \textcolor{comment}{/*    return to the driver to calculate f and g; reenter at 111. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00483}00483     \textcolor{keywordflow}{goto} L1000;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00484}00484 L111:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00485}00485     nfgv = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00486}00486     \textcolor{comment}{/*     Compute the infinity norm of the (-\/) projected gradient. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00487}00487     projgr(n, \&l[1], \&u[1], \&nbd[1], \&x[1], \&g[1], \&sbgnrm);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00488}00488     \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00489}00489         printf(\textcolor{stringliteral}{"{}At iterate \%5ld, f(x)= \%5.2e, ||proj grad||\_infty = \%.2e\(\backslash\)n"{}},iter,*f,sbgnrm );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00490}00490     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00491}00491     \textcolor{keywordflow}{if} (sbgnrm <= *pgtol) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00492}00492         \textcolor{comment}{/*    terminate the algorithm. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00493}00493         *task = CONV\_GRAD;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00494}00494         \textcolor{keywordflow}{goto} L999;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00495}00495     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00496}00496     \textcolor{comment}{/* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ the beginning of the loop -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00497}00497 L222:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00498}00498     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00499}00499         printf(\textcolor{stringliteral}{"{}ITERATION \%5ld\(\backslash\)n"{}}, i\_\_1 );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00500}00500     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00501}00501     iword = -\/1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00503}00503     \textcolor{keywordflow}{if} (! cnstnd \&\& col > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00504}00504         \textcolor{comment}{/*    skip the search for GCP. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00505}00505         dcopy(n, \&x[1], \&c\_\_1, \&z\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00506}00506         wrk = updatd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00507}00507         nseg = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00508}00508         \textcolor{keywordflow}{goto} L333;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00509}00509     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00510}00510     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00511}00511 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00512}00512     \textcolor{comment}{/*     Compute the Generalized Cauchy Point (GCP). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00514}00514     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00515}00515     timer(\&cpu1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00516}00516     info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00517}00517     cauchy(n, \&x[1], \&l[1], \&u[1], \&nbd[1], \&g[1], \&indx2[1], \&iwhere[1], \&t[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00518}00518             1], \&d\_\_[1], \&z\_\_[1], m, \&wy[wy\_offset], \&ws[ws\_offset], \&sy[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00519}00519             sy\_offset], \&wt[wt\_offset], \&theta, \&col, \&head, \&wa[1], \&wa[(*m}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00520}00520                 << 1) + 1], \&wa[(*m << 2) + 1], \&wa[*m * 6 + 1], \&nseg, iprint, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00521}00521             sbgnrm, \&info, \&epsmch);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00522}00522     \textcolor{keywordflow}{if} (info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00523}00523         \textcolor{comment}{/*         singular triangular system detected; refresh the lbfgs memory. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00524}00524         info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00525}00525         col = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00526}00526         head = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00527}00527         theta = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00528}00528         iupdat = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00529}00529         updatd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00530}00530         timer(\&cpu2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00531}00531         cachyt = cachyt + cpu2 -\/ cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00532}00532         \textcolor{keywordflow}{goto} L222;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00533}00533     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00534}00534     timer(\&cpu2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00535}00535     cachyt = cachyt + cpu2 -\/ cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00536}00536     nintol += nseg;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00537}00537     \textcolor{comment}{/*     Count the entering and leaving variables for iter > 0; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00538}00538     \textcolor{comment}{/*     find the index set of free and active variables at the GCP. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00539}00539     freev(n, \&nfree, \&index[1], \&nenter, \&ileave, \&indx2[1], \&iwhere[1], \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00540}00540             wrk, \&updatd, \&cnstnd, iprint, \&iter);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00541}00541     nact = *n -\/ nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00542}00542 L333:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00543}00543     \textcolor{comment}{/*     If there are no free variables or B=theta*I, then */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00544}00544     \textcolor{comment}{/*                                        skip the subspace minimization. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00545}00545     \textcolor{keywordflow}{if} (nfree == 0 || col == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00546}00546         \textcolor{keywordflow}{goto} L555;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00547}00547     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00548}00548     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00549}00549 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00550}00550     \textcolor{comment}{/*     Subspace minimization. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00551}00551 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00552}00552     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00553}00553     timer(\&cpu1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00554}00554     \textcolor{comment}{/*     Form  the LEL\string^T factorization of the indefinite */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00555}00555     \textcolor{comment}{/*       matrix    K = [-\/D -\/Y'ZZ'Y/theta     L\_a'-\/R\_z'  ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00556}00556     \textcolor{comment}{/*                     [L\_a -\/R\_z           theta*S'AA'S ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00557}00557     \textcolor{comment}{/*       where     E = [-\/I  0] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00558}00558     \textcolor{comment}{/*                     [ 0  I] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00559}00559     \textcolor{keywordflow}{if} (wrk) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00560}00560         formk(n, \&nfree, \&index[1], \&nenter, \&ileave, \&indx2[1], \&iupdat, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00561}00561                 updatd, \&wn[wn\_offset], \&snd[snd\_offset], m, \&ws[ws\_offset], \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00562}00562                 wy[wy\_offset], \&sy[sy\_offset], \&theta, \&col, \&head, \&info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00563}00563     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00564}00564     \textcolor{keywordflow}{if} (info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00565}00565         \textcolor{comment}{/*          nonpositive definiteness in Cholesky factorization; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00566}00566         \textcolor{comment}{/*          refresh the lbfgs memory and restart the iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00567}00567         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00568}00568             printf(\textcolor{stringliteral}{"{} Nonpositive definiteness in Cholesky factorization in formk;\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00569}00569             printf(\textcolor{stringliteral}{"{}   refresh the lbfgs memory and restart the iteration.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00570}00570         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00571}00571         info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00572}00572         col = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00573}00573         head = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00574}00574         theta = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00575}00575         iupdat = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00576}00576         updatd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00577}00577         timer(\&cpu2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00578}00578         sbtime = sbtime + cpu2 -\/ cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00579}00579         \textcolor{keywordflow}{goto} L222;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00580}00580     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00581}00581     \textcolor{comment}{/*        compute r=-\/Z'B(xcp-\/xk)-\/Z'g (using wa(2m+1)=W'(xcp-\/x) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00582}00582     \textcolor{comment}{/*                                                   from 'cauchy'). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00583}00583     cmprlb(n, m, \&x[1], \&g[1], \&ws[ws\_offset], \&wy[wy\_offset], \&sy[sy\_offset]}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00584}00584             , \&wt[wt\_offset], \&z\_\_[1], \&r\_\_[1], \&wa[1], \&index[1], \&theta, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00585}00585             col, \&head, \&nfree, \&cnstnd, \&info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00586}00586     \textcolor{keywordflow}{if} (info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00587}00587         \textcolor{keywordflow}{goto} L444;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00588}00588     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00589}00589     \textcolor{comment}{/* -\/jlm-\/jn   call the direct method. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00590}00590     subsm(n, m, \&nfree, \&index[1], \&l[1], \&u[1], \&nbd[1], \&z\_\_[1], \&r\_\_[1], \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00591}00591             xp[1], \&ws[ws\_offset], \&wy[wy\_offset], \&theta, \&x[1], \&g[1], \&col,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00592}00592             \&head, \&iword, \&wa[1], \&wn[wn\_offset], iprint, \&info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00593}00593 L444:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00594}00594     \textcolor{keywordflow}{if} (info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00595}00595         \textcolor{comment}{/*          singular triangular system detected; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00596}00596         \textcolor{comment}{/*          refresh the lbfgs memory and restart the iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00597}00597         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00598}00598             printf(\textcolor{stringliteral}{"{} Singular triangular system detected;\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00599}00599             printf(\textcolor{stringliteral}{"{}   refresh the lbfgs memory and restart the iteration.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00600}00600         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00601}00601         info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00602}00602         col = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00603}00603         head = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00604}00604         theta = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00605}00605         iupdat = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00606}00606         updatd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00607}00607         timer(\&cpu2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00608}00608         sbtime = sbtime + cpu2 -\/ cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00609}00609         \textcolor{keywordflow}{goto} L222;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00610}00610     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00611}00611     timer(\&cpu2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00612}00612     sbtime = sbtime + cpu2 -\/ cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00613}00613 L555:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00614}00614     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00616}00616     \textcolor{comment}{/*     Line search and optimality tests. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00617}00617 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00618}00618     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00619}00619     \textcolor{comment}{/*     Generate the search direction d:=z-\/x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00620}00620     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00621}00621     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00622}00622         d\_\_[i\_\_] = z\_\_[i\_\_] -\/ x[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00623}00623         \textcolor{comment}{/* L40: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00624}00624     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00625}00625     timer(\&cpu1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00626}00626 L666:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00627}00627     lnsrlb(n, \&l[1], \&u[1], \&nbd[1], \&x[1], f, \&fold, \&gd, \&gdold, \&g[1], \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00628}00628             d\_\_[1], \&r\_\_[1], \&t[1], \&z\_\_[1], \&stp, \&dnorm, \&dtd, \&xstep, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00629}00629             stpmx, \&iter, \&ifun, \&iback, \&nfgv, \&info, task, \&boxed, \&cnstnd,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00630}00630             csave, \&isave[22], \&dsave[17]); \textcolor{comment}{/* (ftnlen)60, (ftnlen)60); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00631}00631     \textcolor{keywordflow}{if} (info != 0 || iback >= 20) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00632}00632         \textcolor{comment}{/*          restore the previous iterate. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00633}00633         dcopy(n, \&t[1], \&c\_\_1, \&x[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00634}00634         dcopy(n, \&r\_\_[1], \&c\_\_1, \&g[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00635}00635         *f = fold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00636}00636         \textcolor{keywordflow}{if} (col == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00637}00637             \textcolor{comment}{/*             abnormal termination. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00638}00638             \textcolor{keywordflow}{if} (info == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00639}00639                 info = -\/9;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00640}00640                 \textcolor{comment}{/*                restore the actual number of f and g evaluations etc. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00641}00641                 -\/-\/nfgv;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00642}00642                 -\/-\/ifun;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00643}00643                 -\/-\/iback;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00644}00644             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00645}00645             *task = ABNORMAL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00646}00646             ++iter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00647}00647             \textcolor{keywordflow}{goto} L999;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00648}00648         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00649}00649             \textcolor{comment}{/*             refresh the lbfgs memory and restart the iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00650}00650             \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00651}00651                 printf(\textcolor{stringliteral}{"{} Bad direction in the line search;\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00652}00652                 printf(\textcolor{stringliteral}{"{}   refresh the lbfgs memory and restart the iteration.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00653}00653             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00654}00654             \textcolor{keywordflow}{if} (info == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00655}00655                 -\/-\/nfgv;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00656}00656             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00657}00657             info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00658}00658             col = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00659}00659             head = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00660}00660             theta = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00661}00661             iupdat = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00662}00662             updatd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00663}00663             *task = RESTART;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00664}00664             timer(\&cpu2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00665}00665             lnscht = lnscht + cpu2 -\/ cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00666}00666             \textcolor{keywordflow}{goto} L222;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00667}00667         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00668}00668     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( *task == FG\_LN ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00669}00669         \textcolor{comment}{/*          return to the driver for calculating f and g; reenter at 666. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00670}00670         \textcolor{keywordflow}{goto} L1000;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00671}00671     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00672}00672         \textcolor{comment}{/*          calculate and print out the quantities related to the new X. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00673}00673         timer(\&cpu2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00674}00674         lnscht = lnscht + cpu2 -\/ cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00675}00675         ++iter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00676}00676         \textcolor{comment}{/*        Compute the infinity norm of the projected (-\/)gradient. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00677}00677         projgr(n, \&l[1], \&u[1], \&nbd[1], \&x[1], \&g[1], \&sbgnrm);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00678}00678         \textcolor{comment}{/*        Print iteration information. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00679}00679 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00680}00680 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00681}00681 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00682}00682         prn2lb(n, \&x[1], f, \&g[1], iprint, o\_\_1, \&iter, \&nfgv, \&nact, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00683}00683                 sbgnrm, \&nseg, word, \&iword, \&iback, \&stp, \&xstep, (ftnlen)3);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00684}00684         \textcolor{keywordflow}{goto} L1000;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00685}00685     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00686}00686 L777:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00687}00687     \textcolor{comment}{/*     Test for termination. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00688}00688     \textcolor{keywordflow}{if} (sbgnrm <= *pgtol) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00689}00689         \textcolor{comment}{/*                                terminate the algorithm. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00690}00690         *task = CONV\_GRAD;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00691}00691         \textcolor{keywordflow}{goto} L999;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00692}00692     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00693}00693     \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00694}00694     d\_\_1 = fabs(fold), d\_\_2 = fabs(*f), d\_\_1 = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00695}00695     ddum = fmax(d\_\_1,1.);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00696}00696     \textcolor{keywordflow}{if} (fold -\/ *f <= tol * ddum) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00697}00697         \textcolor{comment}{/*                                        terminate the algorithm. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00698}00698         *task = CONV\_F;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00699}00699         \textcolor{keywordflow}{if} (iback >= 10) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00700}00700             info = -\/5;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00701}00701         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00702}00702         \textcolor{comment}{/*           i.e., to issue a warning if iback>10 in the line search. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00703}00703         \textcolor{keywordflow}{goto} L999;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00704}00704     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00705}00705     \textcolor{comment}{/*     Compute d=newx-\/oldx, r=newg-\/oldg, rr=y'y and dr=y's. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00706}00706     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00707}00707     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00708}00708         r\_\_[i\_\_] = g[i\_\_] -\/ r\_\_[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00709}00709         \textcolor{comment}{/* L42: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00710}00710     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00711}00711     rr = ddot(n, \&r\_\_[1], \&c\_\_1, \&r\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00712}00712     \textcolor{keywordflow}{if} (stp == 1.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00713}00713         dr = gd -\/ gdold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00714}00714         ddum = -\/gdold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00715}00715     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00716}00716         dr = (gd -\/ gdold) * stp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00717}00717         dscal(n, \&stp, \&d\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00718}00718         ddum = -\/gdold * stp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00719}00719     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00720}00720     \textcolor{keywordflow}{if} (dr <= epsmch * ddum) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00721}00721         \textcolor{comment}{/*                            skip the L-\/BFGS update. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00722}00722         ++nskip;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00723}00723         updatd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00724}00724         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00725}00725             printf(\textcolor{stringliteral}{"{}  ys=\%10.3e  -\/gs=\%10.3e BFGS update SKIPPED\(\backslash\)n"{}}, dr, ddum );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00726}00726         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00727}00727         \textcolor{keywordflow}{goto} L888;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00728}00728     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00729}00729     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00730}00730 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00731}00731     \textcolor{comment}{/*     Update the L-\/BFGS matrix. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00732}00732 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00733}00733     \textcolor{comment}{/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00734}00734     updatd = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00735}00735     ++iupdat;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00736}00736     \textcolor{comment}{/*     Update matrices WS and WY and form the middle matrix in B. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00737}00737     matupd(n, m, \&ws[ws\_offset], \&wy[wy\_offset], \&sy[sy\_offset], \&ss[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00738}00738             ss\_offset], \&d\_\_[1], \&r\_\_[1], \&itail, \&iupdat, \&col, \&head, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00739}00739             theta, \&rr, \&dr, \&stp, \&dtd);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00740}00740     \textcolor{comment}{/*     Form the upper half of the pds T = theta*SS + L*D\string^(-\/1)*L'; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00741}00741     \textcolor{comment}{/*        Store T in the upper triangular of the array wt; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00742}00742     \textcolor{comment}{/*        Cholesky factorize T to J*J' with */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00743}00743     \textcolor{comment}{/*           J' stored in the upper triangular of wt. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00744}00744     formt(m, \&wt[wt\_offset], \&sy[sy\_offset], \&ss[ss\_offset], \&col, \&theta, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00745}00745             info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00746}00746     \textcolor{keywordflow}{if} (info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00747}00747         \textcolor{comment}{/*          nonpositive definiteness in Cholesky factorization; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00748}00748         \textcolor{comment}{/*          refresh the lbfgs memory and restart the iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00749}00749         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00750}00750             printf(\textcolor{stringliteral}{"{} Nonpositive definiteness in Cholesky factorization in formt;\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00751}00751             printf(\textcolor{stringliteral}{"{}   refresh the lbfgs memory and restart the iteration.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00752}00752         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00753}00753         info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00754}00754         col = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00755}00755         head = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00756}00756         theta = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00757}00757         iupdat = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00758}00758         updatd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00759}00759         \textcolor{keywordflow}{goto} L222;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00760}00760     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00761}00761     \textcolor{comment}{/*     Now the inverse of the middle matrix in B is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00762}00762     \textcolor{comment}{/*       [  D\string^(1/2)      O ] [ -\/D\string^(1/2)  D\string^(-\/1/2)*L' ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00763}00763     \textcolor{comment}{/*       [ -\/L*D\string^(-\/1/2)   J ] [  0        J'          ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00764}00764 L888:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00765}00765     \textcolor{comment}{/* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ the end of the loop -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00766}00766     \textcolor{keywordflow}{goto} L222;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00767}00767 L999:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00768}00768     timer(\&time2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00769}00769     time = time2 -\/ time1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00770}00770     prn3lb(n, \&x[1], f, task, iprint, \&info, o\_\_1, \&iter, \&nfgv, \&nintol,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00771}00771             \&nskip, \&nact, \&sbgnrm, \&time, \&nseg, word, \&iback, \&stp, \&xstep,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00772}00772             \&k, \&cachyt, \&sbtime, \&lnscht, (ftnlen)60, (ftnlen)3);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00773}00773 L1000:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00774}00774     \textcolor{comment}{/*     Save local variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00775}00775     lsave[1] = prjctd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00776}00776     lsave[2] = cnstnd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00777}00777     lsave[3] = boxed;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00778}00778     lsave[4] = updatd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00779}00779     isave[1] = nintol;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00780}00780     isave[3] = itfile;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00781}00781     isave[4] = iback;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00782}00782     isave[5] = nskip;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00783}00783     isave[6] = head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00784}00784     isave[7] = col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00785}00785     isave[8] = itail;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00786}00786     isave[9] = iter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00787}00787     isave[10] = iupdat;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00788}00788     isave[12] = nseg;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00789}00789     isave[13] = nfgv;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00790}00790     isave[14] = info;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00791}00791     isave[15] = ifun;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00792}00792     isave[16] = iword;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00793}00793     isave[17] = nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00794}00794     isave[18] = nact;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00795}00795     isave[19] = ileave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00796}00796     isave[20] = nenter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00797}00797     dsave[1] = theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00798}00798     dsave[2] = fold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00799}00799     dsave[3] = tol;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00800}00800     dsave[4] = dnorm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00801}00801     dsave[5] = epsmch;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00802}00802     dsave[6] = cpu1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00803}00803     dsave[7] = cachyt;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00804}00804     dsave[8] = sbtime;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00805}00805     dsave[9] = lnscht;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00806}00806     dsave[10] = time1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00807}00807     dsave[11] = gd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00808}00808     dsave[12] = stpmx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00809}00809     dsave[13] = sbgnrm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00810}00810     dsave[14] = stp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00811}00811     dsave[15] = gdold;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00812}00812     dsave[16] = dtd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00813}00813     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00814}00814 \} \textcolor{comment}{/* mainlb */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00815}00815 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00816}00816 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00817}00817 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00818}00818 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00819}00819 \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} Lbfgs::setulb(integer *n, integer *m, \textcolor{keywordtype}{double} *x,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00820}00820     \textcolor{keywordtype}{double} *l, \textcolor{keywordtype}{double} *u, integer *nbd, \textcolor{keywordtype}{double} *f, \textcolor{keywordtype}{double}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00821}00821     *g, \textcolor{keywordtype}{double} *factr, \textcolor{keywordtype}{double} *pgtol, \textcolor{keywordtype}{double} *wa, integer *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00822}00822     iwa, integer *task, integer *iprint, integer *csave, logical *lsave,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00823}00823     integer *isave, \textcolor{keywordtype}{double} *dsave) \textcolor{comment}{/* ftnlen task\_len, ftnlen csave\_len) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00824}00824 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00825}00825     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00826}00826     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00827}00827 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00828}00828 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00829}00829     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00830}00830      integer ld, lr, lt, lz, lwa, lwn, lss, lxp, lws, lwt, lsy, lwy,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00831}00831         lsnd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00832}00832 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00833}00833 \textcolor{comment}{/* -\/jlm-\/jn */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00834}00834     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00835}00835 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00836}00836 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00837}00837 \textcolor{comment}{    Subroutine setulb}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00838}00838 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00839}00839 \textcolor{comment}{    This subroutine partitions the working arrays wa and iwa, and}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00840}00840 \textcolor{comment}{      then uses the limited memory BFGS method to solve the bound}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00841}00841 \textcolor{comment}{      constrained optimization problem by calling mainlb.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00842}00842 \textcolor{comment}{      (The direct method will be used in the subspace minimization.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00843}00843 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00844}00844 \textcolor{comment}{    n is an integer variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00845}00845 \textcolor{comment}{      On entry n is the dimension of the problem.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00846}00846 \textcolor{comment}{      On exit n is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00847}00847 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00848}00848 \textcolor{comment}{    m is an integer variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00849}00849 \textcolor{comment}{      On entry m is the maximum number of variable metric corrections}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00850}00850 \textcolor{comment}{        used to define the limited memory matrix.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00851}00851 \textcolor{comment}{      On exit m is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00852}00852 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00853}00853 \textcolor{comment}{    x is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00854}00854 \textcolor{comment}{      On entry x is an approximation to the solution.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00855}00855 \textcolor{comment}{      On exit x is the current approximation.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00856}00856 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00857}00857 \textcolor{comment}{    l is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00858}00858 \textcolor{comment}{      On entry l is the lower bound on x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00859}00859 \textcolor{comment}{      On exit l is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00860}00860 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00861}00861 \textcolor{comment}{    u is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00862}00862 \textcolor{comment}{      On entry u is the upper bound on x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00863}00863 \textcolor{comment}{      On exit u is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00864}00864 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00865}00865 \textcolor{comment}{    nbd is an integer array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00866}00866 \textcolor{comment}{      On entry nbd represents the type of bounds imposed on the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00867}00867 \textcolor{comment}{        variables, and must be specified as follows:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00868}00868 \textcolor{comment}{        nbd(i)=0 if x(i) is unbounded,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00869}00869 \textcolor{comment}{               1 if x(i) has only a lower bound,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00870}00870 \textcolor{comment}{               2 if x(i) has both lower and upper bounds, and}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00871}00871 \textcolor{comment}{               3 if x(i) has only an upper bound.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00872}00872 \textcolor{comment}{      On exit nbd is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00873}00873 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00874}00874 \textcolor{comment}{    f is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00875}00875 \textcolor{comment}{      On first entry f is unspecified.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00876}00876 \textcolor{comment}{      On final exit f is the value of the function at x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00877}00877 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00878}00878 \textcolor{comment}{    g is a double precision array of dimension n.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00879}00879 \textcolor{comment}{      On first entry g is unspecified.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00880}00880 \textcolor{comment}{      On final exit g is the value of the gradient at x.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00881}00881 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00882}00882 \textcolor{comment}{    factr is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00883}00883 \textcolor{comment}{      On entry factr >= 0 is specified by the user.  The iteration}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00884}00884 \textcolor{comment}{        will stop when}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00885}00885 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00886}00886 \textcolor{comment}{        (f\string^k -\/ f\string^\{k+1\})/max\{|f\string^k|,|f\string^\{k+1\}|,1\} <= factr*epsmch}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00887}00887 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00888}00888 \textcolor{comment}{        where epsmch is the machine precision, which is automatically}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00889}00889 \textcolor{comment}{        generated by the code. Typical values for factr: 1.d+12 for}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00890}00890 \textcolor{comment}{        low accuracy; 1.d+7 for moderate accuracy; 1.d+1 for extremely}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00891}00891 \textcolor{comment}{        high accuracy.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00892}00892 \textcolor{comment}{      On exit factr is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00893}00893 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00894}00894 \textcolor{comment}{    pgtol is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00895}00895 \textcolor{comment}{      On entry pgtol >= 0 is specified by the user.  The iteration}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00896}00896 \textcolor{comment}{        will stop when}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00897}00897 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00898}00898 \textcolor{comment}{                max\{|proj g\_i | i = 1, ..., n\} <= pgtol}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00899}00899 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00900}00900 \textcolor{comment}{        where pg\_i is the ith component of the projected gradient.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00901}00901 \textcolor{comment}{      On exit pgtol is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00902}00902 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00903}00903 \textcolor{comment}{    wa is a double precision working array of length}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00904}00904 \textcolor{comment}{      (2mmax + 5)nmax + 12mmax\string^2 + 12mmax.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00905}00905 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00906}00906 \textcolor{comment}{    iwa is an integer working array of length 3nmax.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00907}00907 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00908}00908 \textcolor{comment}{    task is a working string of characters of length 60 indicating}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00909}00909 \textcolor{comment}{      the current job when entering and quitting this subroutine.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00910}00910 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00911}00911 \textcolor{comment}{    iprint is an integer variable that must be set by the user.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00912}00912 \textcolor{comment}{      It controls the frequency and type of output generated:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00913}00913 \textcolor{comment}{       iprint<0    no output is generated;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00914}00914 \textcolor{comment}{       iprint=0    print only one line at the last iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00915}00915 \textcolor{comment}{       0<iprint<99 print also f and |proj g| every iprint iterations;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00916}00916 \textcolor{comment}{       iprint=99   print details of every iteration except n-\/vectors;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00917}00917 \textcolor{comment}{       iprint=100  print also the changes of active set and final x;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00918}00918 \textcolor{comment}{       iprint>100  print details of every iteration including x and g;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00919}00919 \textcolor{comment}{      When iprint > 0, the file iterate.dat will be created to}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00920}00920 \textcolor{comment}{                       summarize the iteration.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00921}00921 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00922}00922 \textcolor{comment}{    csave is a working string of characters of length 60.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00923}00923 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00924}00924 \textcolor{comment}{    lsave is a logical working array of dimension 4.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00925}00925 \textcolor{comment}{      On exit with 'task' = NEW\_X, the following information is}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00926}00926 \textcolor{comment}{                                                            available:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00927}00927 \textcolor{comment}{        If lsave(1) = .true.  then  the initial X has been replaced by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00928}00928 \textcolor{comment}{                                    its projection in the feasible set;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00929}00929 \textcolor{comment}{        If lsave(2) = .true.  then  the problem is constrained;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00930}00930 \textcolor{comment}{        If lsave(3) = .true.  then  each variable has upper and lower}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00931}00931 \textcolor{comment}{                                    bounds;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00932}00932 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00933}00933 \textcolor{comment}{    isave is an integer working array of dimension 44.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00934}00934 \textcolor{comment}{      On exit with 'task' = NEW\_X, the following information is}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00935}00935 \textcolor{comment}{                                                            available:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00936}00936 \textcolor{comment}{        isave(22) = the total number of intervals explored in the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00937}00937 \textcolor{comment}{                        search of Cauchy points;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00938}00938 \textcolor{comment}{        isave(26) = the total number of skipped BFGS updates before}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00939}00939 \textcolor{comment}{                        the current iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00940}00940 \textcolor{comment}{        isave(30) = the number of current iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00941}00941 \textcolor{comment}{        isave(31) = the total number of BFGS updates prior the current}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00942}00942 \textcolor{comment}{                        iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00943}00943 \textcolor{comment}{        isave(33) = the number of intervals explored in the search of}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00944}00944 \textcolor{comment}{                        Cauchy point in the current iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00945}00945 \textcolor{comment}{        isave(34) = the total number of function and gradient}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00946}00946 \textcolor{comment}{                        evaluations;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00947}00947 \textcolor{comment}{        isave(36) = the number of function value or gradient}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00948}00948 \textcolor{comment}{                                 evaluations in the current iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00949}00949 \textcolor{comment}{        if isave(37) = 0  then the subspace argmin is within the box;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00950}00950 \textcolor{comment}{        if isave(37) = 1  then the subspace argmin is beyond the box;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00951}00951 \textcolor{comment}{        isave(38) = the number of free variables in the current}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00952}00952 \textcolor{comment}{                        iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00953}00953 \textcolor{comment}{        isave(39) = the number of active constraints in the current}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00954}00954 \textcolor{comment}{                        iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00955}00955 \textcolor{comment}{        n + 1 -\/ isave(40) = the number of variables leaving the set of}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00956}00956 \textcolor{comment}{                          active constraints in the current iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00957}00957 \textcolor{comment}{        isave(41) = the number of variables entering the set of active}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00958}00958 \textcolor{comment}{                        constraints in the current iteration.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00959}00959 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00960}00960 \textcolor{comment}{    dsave is a double precision working array of dimension 29.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00961}00961 \textcolor{comment}{      On exit with 'task' = NEW\_X, the following information is}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00962}00962 \textcolor{comment}{                                                            available:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00963}00963 \textcolor{comment}{        dsave(1) = current 'theta' in the BFGS matrix;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00964}00964 \textcolor{comment}{        dsave(2) = f(x) in the previous iteration;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00965}00965 \textcolor{comment}{        dsave(3) = factr*epsmch;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00966}00966 \textcolor{comment}{        dsave(4) = 2-\/norm of the line search direction vector;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00967}00967 \textcolor{comment}{        dsave(5) = the machine precision epsmch generated by the code;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00968}00968 \textcolor{comment}{        dsave(7) = the accumulated time spent on searching for}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00969}00969 \textcolor{comment}{                                                        Cauchy points;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00970}00970 \textcolor{comment}{        dsave(8) = the accumulated time spent on}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00971}00971 \textcolor{comment}{                                                subspace minimization;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00972}00972 \textcolor{comment}{        dsave(9) = the accumulated time spent on line search;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00973}00973 \textcolor{comment}{        dsave(11) = the slope of the line search function at}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00974}00974 \textcolor{comment}{                                 the current point of line search;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00975}00975 \textcolor{comment}{        dsave(12) = the maximum relative step length imposed in}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00976}00976 \textcolor{comment}{                                                          line search;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00977}00977 \textcolor{comment}{        dsave(13) = the infinity norm of the projected gradient;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00978}00978 \textcolor{comment}{        dsave(14) = the relative step length in the line search;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00979}00979 \textcolor{comment}{        dsave(15) = the slope of the line search function at}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00980}00980 \textcolor{comment}{                                the starting point of the line search;}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00981}00981 \textcolor{comment}{        dsave(16) = the square of the 2-\/norm of the line search}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00982}00982 \textcolor{comment}{                                                     direction vector.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00983}00983 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00984}00984 \textcolor{comment}{    Subprograms called:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00985}00985 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00986}00986 \textcolor{comment}{      L-\/BFGS-\/B Library ... mainlb.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00987}00987 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00988}00988 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00989}00989 \textcolor{comment}{    References:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00990}00990 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00991}00991 \textcolor{comment}{      [1] R. H. Byrd, P. Lu, J. Nocedal and C. Zhu, ``A limited}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00992}00992 \textcolor{comment}{      memory algorithm for bound constrained optimization'',}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00993}00993 \textcolor{comment}{      SIAM J. Scientific Computing 16 (1995), no. 5, pp. 1190-\/-\/1208.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00994}00994 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00995}00995 \textcolor{comment}{      [2] C. Zhu, R.H. Byrd, P. Lu, J. Nocedal, ``L-\/BFGS-\/B: a}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00996}00996 \textcolor{comment}{      limited memory FORTRAN code for solving bound constrained}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00997}00997 \textcolor{comment}{      optimization problems'', Tech. Report, NAM-\/11, EECS Department,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00998}00998 \textcolor{comment}{      Northwestern University, 1994.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l00999}00999 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01000}01000 \textcolor{comment}{      (Postscript files of these papers are available via anonymous}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01001}01001 \textcolor{comment}{       ftp to eecs.nwu.edu in the directory pub/lbfgs/lbfgs\_bcm.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01002}01002 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01003}01003 \textcolor{comment}{                          *  *  *}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01004}01004 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01005}01005 \textcolor{comment}{    NEOS, November 1994. (Latest revision June 1996.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01006}01006 \textcolor{comment}{    Optimization Technology Center.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01007}01007 \textcolor{comment}{    Argonne National Laboratory and Northwestern University.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01008}01008 \textcolor{comment}{    Written by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01009}01009 \textcolor{comment}{                       Ciyou Zhu}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01010}01010 \textcolor{comment}{    in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01011}01011 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01012}01012 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01013}01013 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01014}01014 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01015}01015 \textcolor{comment}{/* -\/jlm-\/jn */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01016}01016     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01017}01017     -\/-\/iwa;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01018}01018     -\/-\/g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01019}01019     -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01020}01020     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01021}01021     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01022}01022     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01023}01023     -\/-\/wa;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01024}01024     -\/-\/lsave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01025}01025     -\/-\/isave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01026}01026     -\/-\/dsave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01027}01027 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01028}01028     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01029}01029     \textcolor{keywordflow}{if} ( *task == START ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01030}01030         isave[1] = *m * *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01031}01031         \textcolor{comment}{/* Computing 2nd power */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01032}01032         i\_\_1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01033}01033         isave[2] = i\_\_1 * i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01034}01034         \textcolor{comment}{/* Computing 2nd power */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01035}01035         i\_\_1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01036}01036         isave[3] = i\_\_1 * i\_\_1 << 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01037}01037         isave[4] = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01038}01038         \textcolor{comment}{/* ws      m*n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01039}01039         isave[5] = isave[4] + isave[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01040}01040         \textcolor{comment}{/* wy      m*n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01041}01041         isave[6] = isave[5] + isave[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01042}01042         \textcolor{comment}{/* wsy     m**2 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01043}01043         isave[7] = isave[6] + isave[2];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01044}01044         \textcolor{comment}{/* wss     m**2 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01045}01045         isave[8] = isave[7] + isave[2];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01046}01046         \textcolor{comment}{/* wt      m**2 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01047}01047         isave[9] = isave[8] + isave[2];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01048}01048         \textcolor{comment}{/* wn      4*m**2 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01049}01049         isave[10] = isave[9] + isave[3];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01050}01050         \textcolor{comment}{/* wsnd    4*m**2 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01051}01051         isave[11] = isave[10] + isave[3];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01052}01052         \textcolor{comment}{/* wz      n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01053}01053         isave[12] = isave[11] + *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01054}01054         \textcolor{comment}{/* wr      n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01055}01055         isave[13] = isave[12] + *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01056}01056         \textcolor{comment}{/* wd      n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01057}01057         isave[14] = isave[13] + *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01058}01058         \textcolor{comment}{/* wt      n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01059}01059         isave[15] = isave[14] + *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01060}01060         \textcolor{comment}{/* wxp     n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01061}01061         isave[16] = isave[15] + *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01062}01062         \textcolor{comment}{/* wa      8*m */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01063}01063     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01064}01064     lws = isave[4];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01065}01065     lwy = isave[5];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01066}01066     lsy = isave[6];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01067}01067     lss = isave[7];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01068}01068     lwt = isave[8];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01069}01069     lwn = isave[9];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01070}01070     lsnd = isave[10];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01071}01071     lz = isave[11];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01072}01072     lr = isave[12];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01073}01073     ld = isave[13];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01074}01074     lt = isave[14];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01075}01075     lxp = isave[15];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01076}01076     lwa = isave[16];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01077}01077     mainlb(n, m, \&x[1], \&l[1], \&u[1], \&nbd[1], f, \&g[1], factr, pgtol, \&wa[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01078}01078             lws], \&wa[lwy], \&wa[lsy], \&wa[lss], \&wa[lwt], \&wa[lwn], \&wa[lsnd],}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01079}01079             \&wa[lz], \&wa[lr], \&wa[ld], \&wa[lt], \&wa[lxp], \&wa[lwa], \&iwa[1],}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01080}01080             \&iwa[*n + 1], \&iwa[(*n << 1) + 1], task, iprint, csave, \&lsave[1],}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01081}01081             \&isave[22], \&dsave[1]); \textcolor{comment}{/* (ftnlen)60, (ftnlen)60); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01082}01082     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01083}01083 \} \textcolor{comment}{/* setulb\_ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01084}01084 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01085}01085 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01086}01086 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01087}01087 \textcolor{keywordtype}{int} Lbfgs::lnsrlb(integer *n, \textcolor{keywordtype}{double} *l, \textcolor{keywordtype}{double} *u,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01088}01088    integer *nbd, \textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{double} *f, \textcolor{keywordtype}{double} *fold,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01089}01089    \textcolor{keywordtype}{double} *gd, \textcolor{keywordtype}{double} *gdold, \textcolor{keywordtype}{double} *g, \textcolor{keywordtype}{double} *d\_\_,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01090}01090    \textcolor{keywordtype}{double} *r\_\_, \textcolor{keywordtype}{double} *t, \textcolor{keywordtype}{double} *z\_\_, \textcolor{keywordtype}{double} *stp,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01091}01091    \textcolor{keywordtype}{double} *dnorm, \textcolor{keywordtype}{double} *dtd, \textcolor{keywordtype}{double} *xstep, \textcolor{keywordtype}{double} *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01092}01092    stpmx, integer *iter, integer *ifun, integer *iback, integer *nfgv,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01093}01093    integer *info, integer *task, logical *boxed, logical *cnstnd, integer *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01094}01094    csave, integer *isave, \textcolor{keywordtype}{double} *dsave) \textcolor{comment}{/* ftnlen task\_len, ftnlen}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01095}01095 \textcolor{comment}{   csave\_len) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01096}01096 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01097}01097    \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01098}01098 \textcolor{comment}{   **********}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01099}01099 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01100}01100 \textcolor{comment}{   Subroutine lnsrlb}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01101}01101 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01102}01102 \textcolor{comment}{   This subroutine calls subroutine dcsrch from the Minpack2 library}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01103}01103 \textcolor{comment}{     to perform the line search.  Subroutine dscrch is safeguarded so}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01104}01104 \textcolor{comment}{     that all trial points lie within the feasible region.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01105}01105 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01106}01106 \textcolor{comment}{   Subprograms called:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01107}01107 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01108}01108 \textcolor{comment}{     Minpack2 Library ... dcsrch.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01109}01109 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01110}01110 \textcolor{comment}{     Linpack ... dtrsl, ddot.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01111}01111 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01112}01112 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01113}01113 \textcolor{comment}{                         *  *  *}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01114}01114 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01115}01115 \textcolor{comment}{   NEOS, November 1994. (Latest revision June 1996.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01116}01116 \textcolor{comment}{   Optimization Technology Center.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01117}01117 \textcolor{comment}{   Argonne National Laboratory and Northwestern University.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01118}01118 \textcolor{comment}{   Written by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01119}01119 \textcolor{comment}{                      Ciyou Zhu}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01120}01120 \textcolor{comment}{   in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01121}01121 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01122}01122 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01123}01123 \textcolor{comment}{   **********}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01124}01124 \textcolor{comment}{   */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01125}01125 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01126}01126 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01127}01127    \textcolor{comment}{/* Table of constant values */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01128}01128    \textcolor{keyword}{static} \textcolor{keywordtype}{double} c\_b14 = FTOL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01129}01129    \textcolor{keyword}{static} \textcolor{keywordtype}{double} c\_b15 = GTOL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01130}01130    \textcolor{keyword}{static} \textcolor{keywordtype}{double} c\_b16 = XTOL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01131}01131    \textcolor{keyword}{static} \textcolor{keywordtype}{double} c\_b17 = STEPMIN;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01132}01132    \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01133}01133    integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01134}01134    \textcolor{keywordtype}{double} d\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01135}01135 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01136}01136 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01137}01137    \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01138}01138    integer i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01139}01139    \textcolor{keywordtype}{double} a1, a2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01140}01140 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01141}01141    \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01142}01142    -\/-\/z\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01143}01143    -\/-\/t;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01144}01144    -\/-\/r\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01145}01145    -\/-\/d\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01146}01146    -\/-\/g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01147}01147    -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01148}01148    -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01149}01149    -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01150}01150    -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01151}01151    -\/-\/isave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01152}01152    -\/-\/dsave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01153}01153 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01154}01154    \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01155}01155    \textcolor{keywordflow}{if} ( *task == FG\_LN ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01156}01156        \textcolor{keywordflow}{goto} L556;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01157}01157    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01158}01158    *dtd = ddot(n, \&d\_\_[1], \&c\_\_1, \&d\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01159}01159    *dnorm = sqrt(*dtd);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01160}01160    \textcolor{comment}{/*     Determine the maximum step length. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01161}01161    *stpmx = 1e10;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01162}01162    \textcolor{keywordflow}{if} (*cnstnd) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01163}01163        \textcolor{keywordflow}{if} (*iter == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01164}01164            *stpmx = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01165}01165        \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01166}01166            i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01167}01167            \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01168}01168                a1 = d\_\_[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01169}01169                \textcolor{keywordflow}{if} (nbd[i\_\_] != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01170}01170                    \textcolor{keywordflow}{if} (a1 < 0. \&\& nbd[i\_\_] <= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01171}01171                        a2 = l[i\_\_] -\/ x[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01172}01172                        \textcolor{keywordflow}{if} (a2 >= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01173}01173                            *stpmx = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01174}01174                        \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (a1 * *stpmx < a2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01175}01175                            *stpmx = a2 / a1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01176}01176                        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01177}01177                    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (a1 > 0. \&\& nbd[i\_\_] >= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01178}01178                        a2 = u[i\_\_] -\/ x[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01179}01179                        \textcolor{keywordflow}{if} (a2 <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01180}01180                            *stpmx = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01181}01181                        \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (a1 * *stpmx > a2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01182}01182                            *stpmx = a2 / a1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01183}01183                        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01184}01184                    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01185}01185                \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01186}01186                \textcolor{comment}{/* L43: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01187}01187            \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01188}01188        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01189}01189    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01190}01190    \textcolor{keywordflow}{if} (*iter == 0 \&\& ! (*boxed)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01191}01191        \textcolor{comment}{/* Computing MIN */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01192}01192        d\_\_1 = 1. / *dnorm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01193}01193        *stp = fmin(d\_\_1,*stpmx);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01194}01194    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01195}01195        *stp = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01196}01196    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01197}01197    dcopy(n, \&x[1], \&c\_\_1, \&t[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01198}01198    dcopy(n, \&g[1], \&c\_\_1, \&r\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01199}01199    *fold = *f;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01200}01200    *ifun = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01201}01201    *iback = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01202}01202    *csave = START;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01203}01203 L556:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01204}01204    *gd = ddot(n, \&g[1], \&c\_\_1, \&d\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01205}01205    \textcolor{keywordflow}{if} (*ifun == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01206}01206        *gdold = *gd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01207}01207        \textcolor{keywordflow}{if} (*gd >= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01208}01208            \textcolor{comment}{/*  the directional derivative >=0. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01209}01209            \textcolor{comment}{/*  Line search is impossible. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01210}01210            *info = -\/4;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01211}01211            \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01212}01212        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01213}01213    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01214}01214    dcsrch(f, gd, stp, \&c\_b14, \&c\_b15, \&c\_b16, \&c\_b17, stpmx, csave, \&isave[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01215}01215            1], \&dsave[1]);\textcolor{comment}{/* (ftnlen)60);*/}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01216}01216    *xstep = *stp * *dnorm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01217}01217    \textcolor{keywordflow}{if} (  !(IS\_WARNING(*csave)) \&\& !(IS\_CONVERGED(*csave)) )  \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01218}01218 \textcolor{comment}{/*     if (     !( (csave>=WARNING)\&\&(csave<=WARNING\_END) )   \&\&   */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01219}01219 \textcolor{comment}{/*              !( (csave>=CONVERGENCE)\&\&(csave<=CONVERGENCE\_END) )   ) \{ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01220}01220 \textcolor{comment}{/*     if (s\_cmp(csave, "{}CONV"{}, (ftnlen)4, (ftnlen)4) != 0 \&\& s\_cmp(csave, "{}WARN"{} */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01221}01221 \textcolor{comment}{/*                 , (ftnlen)4, (ftnlen)4) != 0) \{ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01222}01222        *task = FG\_LNSRCH;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01223}01223        ++(*ifun);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01224}01224        ++(*nfgv);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01225}01225        *iback = *ifun -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01226}01226        \textcolor{keywordflow}{if} (*stp == 1.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01227}01227            dcopy(n, \&z\_\_[1], \&c\_\_1, \&x[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01228}01228        \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01229}01229            i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01230}01230            \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01231}01231                x[i\_\_] = *stp * d\_\_[i\_\_] + t[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01232}01232                \textcolor{comment}{/* L41: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01233}01233            \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01234}01234        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01235}01235    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01236}01236        *task = NEW\_X;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01237}01237    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01238}01238    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01239}01239 \} \textcolor{comment}{/* lnsrlb */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01240}01240 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01241}01241 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01242}01242 \textcolor{keywordtype}{int} Lbfgs::dcsrch(\textcolor{keywordtype}{double} *f, \textcolor{keywordtype}{double} *g, \textcolor{keywordtype}{double} *stp,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01243}01243         \textcolor{keywordtype}{double} *ftol, \textcolor{keywordtype}{double} *gtol, \textcolor{keywordtype}{double} *xtol, \textcolor{keywordtype}{double} *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01244}01244         stpmin, \textcolor{keywordtype}{double} *stpmax, integer *task, integer *isave, \textcolor{keywordtype}{double} *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01245}01245         dsave) \textcolor{comment}{/* ftnlen task\_len) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01246}01246 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01247}01247     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01248}01248     \textcolor{keywordtype}{double} d\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01249}01249 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01250}01250 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01251}01251     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01252}01252     \textcolor{keywordtype}{double} fm, gm, fx, fy, gx, gy, fxm, fym, gxm, gym, stx, sty;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01253}01253     integer stage;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01254}01254     \textcolor{keywordtype}{double} finit, ginit, width, ftest, gtest, stmin, stmax, width1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01255}01255     logical brackt;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01256}01256 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01257}01257     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01258}01258 \textcolor{comment}{     **********}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01259}01259 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01260}01260 \textcolor{comment}{     Subroutine dcsrch}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01261}01261 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01262}01262 \textcolor{comment}{     This subroutine finds a step that satisfies a sufficient}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01263}01263 \textcolor{comment}{     decrease condition and a curvature condition.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01264}01264 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01265}01265 \textcolor{comment}{     Each call of the subroutine updates an interval with}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01266}01266 \textcolor{comment}{     endpoints stx and sty. The interval is initially chosen}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01267}01267 \textcolor{comment}{     so that it contains a minimizer of the modified function}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01268}01268 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01269}01269 \textcolor{comment}{     psi(stp) = f(stp) -\/ f(0) -\/ ftol*stp*f'(0).}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01270}01270 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01271}01271 \textcolor{comment}{     If psi(stp) <= 0 and f'(stp) >= 0 for some step, then the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01272}01272 \textcolor{comment}{     interval is chosen so that it contains a minimizer of f.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01273}01273 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01274}01274 \textcolor{comment}{     The algorithm is designed to find a step that satisfies}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01275}01275 \textcolor{comment}{     the sufficient decrease condition}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01276}01276 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01277}01277 \textcolor{comment}{     f(stp) <= f(0) + ftol*stp*f'(0),}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01278}01278 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01279}01279 \textcolor{comment}{     and the curvature condition}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01280}01280 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01281}01281 \textcolor{comment}{     abs(f'(stp)) <= gtol*abs(f'(0)).}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01282}01282 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01283}01283 \textcolor{comment}{     If ftol is less than gtol and if, for example, the function}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01284}01284 \textcolor{comment}{     is bounded below, then there is always a step which satisfies}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01285}01285 \textcolor{comment}{     both conditions.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01286}01286 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01287}01287 \textcolor{comment}{     If no step can be found that satisfies both conditions, then}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01288}01288 \textcolor{comment}{     the algorithm stops with a warning. In this case stp only}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01289}01289 \textcolor{comment}{     satisfies the sufficient decrease condition.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01290}01290 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01291}01291 \textcolor{comment}{     A typical invocation of dcsrch has the following outline:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01292}01292 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01293}01293 \textcolor{comment}{     task = 'START'}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01294}01294 \textcolor{comment}{     10 continue}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01295}01295 \textcolor{comment}{     call dcsrch( ... )}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01296}01296 \textcolor{comment}{     if (task .eq. 'FG') then}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01297}01297 \textcolor{comment}{     Evaluate the function and the gradient at stp}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01298}01298 \textcolor{comment}{     goto 10}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01299}01299 \textcolor{comment}{     end if}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01300}01300 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01301}01301 \textcolor{comment}{NOTE: The user must no alter work arrays between calls.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01302}01302 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01303}01303 \textcolor{comment}{The subroutine statement is}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01304}01304 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01305}01305 \textcolor{comment}{subroutine dcsrch(f,g,stp,ftol,gtol,xtol,stpmin,stpmax,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01306}01306 \textcolor{comment}{task,isave,dsave)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01307}01307 \textcolor{comment}{where}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01308}01308 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01309}01309 \textcolor{comment}{f is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01310}01310 \textcolor{comment}{On initial entry f is the value of the function at 0.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01311}01311 \textcolor{comment}{On subsequent entries f is the value of the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01312}01312 \textcolor{comment}{function at stp.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01313}01313 \textcolor{comment}{On exit f is the value of the function at stp.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01314}01314 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01315}01315 \textcolor{comment}{g is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01316}01316 \textcolor{comment}{On initial entry g is the derivative of the function at 0.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01317}01317 \textcolor{comment}{On subsequent entries g is the derivative of the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01318}01318 \textcolor{comment}{function at stp.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01319}01319 \textcolor{comment}{On exit g is the derivative of the function at stp.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01320}01320 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01321}01321 \textcolor{comment}{stp is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01322}01322 \textcolor{comment}{On entry stp is the current estimate of a satisfactory}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01323}01323 \textcolor{comment}{step. On initial entry, a positive initial estimate}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01324}01324 \textcolor{comment}{must be provided.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01325}01325 \textcolor{comment}{On exit stp is the current estimate of a satisfactory step}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01326}01326 \textcolor{comment}{if task = 'FG'. If task = 'CONV' then stp satisfies}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01327}01327 \textcolor{comment}{the sufficient decrease and curvature condition.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01328}01328 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01329}01329 \textcolor{comment}{    ftol is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01330}01330 \textcolor{comment}{        On entry ftol specifies a nonnegative tolerance for the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01331}01331 \textcolor{comment}{        sufficient decrease condition.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01332}01332 \textcolor{comment}{        On exit ftol is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01333}01333 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01334}01334 \textcolor{comment}{        gtol is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01335}01335 \textcolor{comment}{        On entry gtol specifies a nonnegative tolerance for the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01336}01336 \textcolor{comment}{        curvature condition.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01337}01337 \textcolor{comment}{        On exit gtol is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01338}01338 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01339}01339 \textcolor{comment}{        xtol is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01340}01340 \textcolor{comment}{        On entry xtol specifies a nonnegative relative tolerance}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01341}01341 \textcolor{comment}{        for an acceptable step. The subroutine exits with a}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01342}01342 \textcolor{comment}{            warning if the relative difference between sty and stx}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01343}01343 \textcolor{comment}{                is less than xtol.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01344}01344 \textcolor{comment}{                On exit xtol is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01345}01345 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01346}01346 \textcolor{comment}{                stpmin is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01347}01347 \textcolor{comment}{                On entry stpmin is a nonnegative lower bound for the step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01348}01348 \textcolor{comment}{                On exit stpmin is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01349}01349 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01350}01350 \textcolor{comment}{                stpmax is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01351}01351 \textcolor{comment}{                On entry stpmax is a nonnegative upper bound for the step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01352}01352 \textcolor{comment}{                On exit stpmax is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01353}01353 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01354}01354 \textcolor{comment}{                task is a character variable of length at least 60.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01355}01355 \textcolor{comment}{                On initial entry task must be set to 'START'.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01356}01356 \textcolor{comment}{                On exit task indicates the required action:}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01357}01357 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01358}01358 \textcolor{comment}{                If task(1:2) = 'FG' then evaluate the function and}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01359}01359 \textcolor{comment}{                derivative at stp and call dcsrch again.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01360}01360 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01361}01361 \textcolor{comment}{                If task(1:4) = 'CONV' then the search is successful.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01362}01362 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01363}01363 \textcolor{comment}{                If task(1:4) = 'WARN' then the subroutine is not able}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01364}01364 \textcolor{comment}{                to satisfy the convergence conditions. The exit value of}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01365}01365 \textcolor{comment}{                stp contains the best point found during the search.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01366}01366 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01367}01367 \textcolor{comment}{                If task(1:5) = 'ERROR' then there is an error in the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01368}01368 \textcolor{comment}{                input arguments.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01369}01369 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01370}01370 \textcolor{comment}{                On exit with convergence, a warning or an error, the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01371}01371 \textcolor{comment}{                variable task contains additional information.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01372}01372 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01373}01373 \textcolor{comment}{                isave is an integer work array of dimension 2.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01374}01374 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01375}01375 \textcolor{comment}{                dsave is a double precision work array of dimension 13.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01376}01376 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01377}01377 \textcolor{comment}{                Subprograms called}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01378}01378 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01379}01379 \textcolor{comment}{                MINPACK-\/2 ... dcstep}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01380}01380 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01381}01381 \textcolor{comment}{                MINPACK-\/1 Project. June 1983.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01382}01382 \textcolor{comment}{                Argonne National Laboratory.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01383}01383 \textcolor{comment}{                Jorge J. More' and David J. Thuente.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01384}01384 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01385}01385 \textcolor{comment}{                MINPACK-\/2 Project. October 1993.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01386}01386 \textcolor{comment}{                Argonne National Laboratory and University of Minnesota.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01387}01387 \textcolor{comment}{                Brett M. Averick, Richard G. Carter, and Jorge J. More'.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01388}01388 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01389}01389 \textcolor{comment}{                **********}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01390}01390 \textcolor{comment}{                */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01391}01391                 \textcolor{comment}{/*     Initialization block. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01392}01392                 \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01393}01393                 -\/-\/dsave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01394}01394     -\/-\/isave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01395}01395 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01396}01396     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01397}01397     \textcolor{keywordflow}{if} ( *task == START ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01398}01398         \textcolor{comment}{/*        Check the input arguments for errors.  See lbfgsb.h for messages */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01399}01399         \textcolor{keywordflow}{if} (*stp < *stpmin)  *task=ERROR\_SMALLSTP;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01400}01400         \textcolor{keywordflow}{if} (*stp > *stpmax)  *task=ERROR\_LARGESTP;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01401}01401         \textcolor{keywordflow}{if} (*g >= 0.)        *task=ERROR\_INITIAL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01402}01402         \textcolor{keywordflow}{if} (*ftol < 0.)      *task=ERROR\_FTOL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01403}01403         \textcolor{keywordflow}{if} (*gtol < 0.)      *task=ERROR\_GTOL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01404}01404         \textcolor{keywordflow}{if} (*xtol < 0.)      *task=ERROR\_XTOL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01405}01405         \textcolor{keywordflow}{if} (*stpmin < 0.)    *task=ERROR\_STP0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01406}01406         \textcolor{keywordflow}{if} (*stpmax < *stpmin) *task=ERROR\_STP1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01407}01407         \textcolor{comment}{/*        Exit if there are errors on input. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01408}01408         \textcolor{keywordflow}{if} ( IS\_ERROR(*task) ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01409}01409             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01410}01410         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01411}01411         \textcolor{comment}{/*        Initialize local variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01412}01412         brackt = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01413}01413         stage = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01414}01414         finit = *f;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01415}01415         ginit = *g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01416}01416         gtest = *ftol * ginit;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01417}01417         width = *stpmax -\/ *stpmin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01418}01418         width1 = width / .5;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01419}01419         \textcolor{comment}{/*        The variables stx, fx, gx contain the values of the step, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01420}01420         \textcolor{comment}{/*        function, and derivative at the best step. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01421}01421         \textcolor{comment}{/*        The variables sty, fy, gy contain the value of the step, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01422}01422         \textcolor{comment}{/*        function, and derivative at sty. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01423}01423         \textcolor{comment}{/*        The variables stp, f, g contain the values of the step, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01424}01424         \textcolor{comment}{/*        function, and derivative at stp. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01425}01425         stx = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01426}01426         fx = finit;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01427}01427         gx = ginit;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01428}01428         sty = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01429}01429         fy = finit;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01430}01430         gy = ginit;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01431}01431         stmin = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01432}01432         stmax = *stp + *stp * 4.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01433}01433 \textcolor{comment}{/*         s\_copy(task, "{}FG"{}, task\_len, (ftnlen)2); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01434}01434         *task = FG;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01435}01435         \textcolor{keywordflow}{goto} L1000;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01436}01436     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01437}01437         \textcolor{comment}{/*        Restore local variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01438}01438         \textcolor{keywordflow}{if} (isave[1] == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01439}01439             brackt = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01440}01440         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01441}01441             brackt = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01442}01442         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01443}01443         stage = isave[2];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01444}01444         ginit = dsave[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01445}01445         gtest = dsave[2];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01446}01446         gx = dsave[3];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01447}01447         gy = dsave[4];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01448}01448         finit = dsave[5];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01449}01449         fx = dsave[6];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01450}01450         fy = dsave[7];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01451}01451         stx = dsave[8];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01452}01452         sty = dsave[9];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01453}01453         stmin = dsave[10];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01454}01454         stmax = dsave[11];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01455}01455         width = dsave[12];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01456}01456         width1 = dsave[13];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01457}01457     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01458}01458     \textcolor{comment}{/*     If psi(stp) <= 0 and f'(stp) >= 0 for some step, then the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01459}01459     \textcolor{comment}{/*     algorithm enters the second stage. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01460}01460     ftest = finit + *stp * gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01461}01461     \textcolor{keywordflow}{if} (stage == 1 \&\& *f <= ftest \&\& *g >= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01462}01462         stage = 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01463}01463     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01464}01464     \textcolor{comment}{/*     Test for warnings. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01465}01465     \textcolor{keywordflow}{if} (brackt \&\& (*stp <= stmin || *stp >= stmax)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01466}01466         *task = WARNING\_ROUND;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01467}01467     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01468}01468     \textcolor{keywordflow}{if} (brackt \&\& stmax -\/ stmin <= *xtol * stmax) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01469}01469         *task = WARNING\_XTOL;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01470}01470     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01471}01471     \textcolor{keywordflow}{if} (*stp == *stpmax \&\& *f <= ftest \&\& *g <= gtest) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01472}01472         *task = WARNING\_STPMAX;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01473}01473     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01474}01474     \textcolor{keywordflow}{if} (*stp == *stpmin \&\& (*f > ftest || *g >= gtest)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01475}01475         *task = WARNING\_STPMIN;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01476}01476     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01477}01477     \textcolor{comment}{/*     Test for convergence. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01478}01478     \textcolor{keywordflow}{if} (*f <= ftest \&\& fabs(*g) <= *gtol * (-\/ginit)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01479}01479         *task = CONVERGENCE;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01480}01480     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01481}01481     \textcolor{comment}{/*     Test for termination. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01482}01482 \textcolor{comment}{/*     if (     ( (task>=WARNING)\&\&(task<=WARNING\_END) )    || */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01483}01483 \textcolor{comment}{/*              ( (task>=CONVERGENCE)\&\&(task<=CONVERGENCE\_END) )   ) \{ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01484}01484     \textcolor{keywordflow}{if} ( (IS\_WARNING(*task)) || (IS\_CONVERGED(*task) ) ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01485}01485         \textcolor{keywordflow}{goto} L1000;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01486}01486     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01487}01487     \textcolor{comment}{/*     A modified function is used to predict the step during the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01488}01488     \textcolor{comment}{/*     first stage if a lower function value has been obtained but */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01489}01489     \textcolor{comment}{/*     the decrease is not sufficient. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01490}01490     \textcolor{keywordflow}{if} (stage == 1 \&\& *f <= fx \&\& *f > ftest) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01491}01491         \textcolor{comment}{/*        Define the modified function and derivative values. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01492}01492         fm = *f -\/ *stp * gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01493}01493         fxm = fx -\/ stx * gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01494}01494         fym = fy -\/ sty * gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01495}01495         gm = *g -\/ gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01496}01496         gxm = gx -\/ gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01497}01497         gym = gy -\/ gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01498}01498         \textcolor{comment}{/*        Call dcstep to update stx, sty, and to compute the new step. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01499}01499         dcstep(\&stx, \&fxm, \&gxm, \&sty, \&fym, \&gym, stp, \&fm, \&gm, \&brackt, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01500}01500                 stmin, \&stmax);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01501}01501         \textcolor{comment}{/*        Reset the function and derivative values for f. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01502}01502         fx = fxm + stx * gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01503}01503         fy = fym + sty * gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01504}01504         gx = gxm + gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01505}01505         gy = gym + gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01506}01506     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01507}01507         \textcolor{comment}{/*       Call dcstep to update stx, sty, and to compute the new step. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01508}01508         dcstep(\&stx, \&fx, \&gx, \&sty, \&fy, \&gy, stp, f, g, \&brackt, \&stmin, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01509}01509                 stmax);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01510}01510     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01511}01511     \textcolor{comment}{/*     Decide if a bisection step is needed. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01512}01512     \textcolor{keywordflow}{if} (brackt) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01513}01513         \textcolor{keywordflow}{if} ((d\_\_1 = sty -\/ stx, fabs(d\_\_1)) >= width1 * .66) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01514}01514             *stp = stx + (sty -\/ stx) * .5;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01515}01515         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01516}01516         width1 = width;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01517}01517         width = (d\_\_1 = sty -\/ stx, fabs(d\_\_1));}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01518}01518     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01519}01519     \textcolor{comment}{/*     Set the minimum and maximum steps allowed for stp. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01520}01520     \textcolor{keywordflow}{if} (brackt) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01521}01521         stmin = fmin(stx,sty);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01522}01522         stmax = fmax(stx,sty);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01523}01523     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01524}01524         stmin = *stp + (*stp -\/ stx) * 1.1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01525}01525         stmax = *stp + (*stp -\/ stx) * 4.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01526}01526     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01527}01527     \textcolor{comment}{/*     Force the step to be within the bounds stpmax and stpmin. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01528}01528     *stp = fmax(*stp,*stpmin);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01529}01529     *stp = fmin(*stp,*stpmax);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01530}01530     \textcolor{comment}{/*     If further progress is not possible, let stp be the best */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01531}01531     \textcolor{comment}{/*     point obtained during the search. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01532}01532     \textcolor{comment}{/*     if (brackt \&\& (*stp <= stmin || *stp >= stmax) || brackt \&\& stmax -\/ stmin  */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01533}01533     \textcolor{comment}{/* SRB: guess the precedence. \&\& precedence over || */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01534}01534     \textcolor{keywordflow}{if} ( (brackt \&\& (*stp <= stmin || *stp >= stmax) ) || (brackt \&\& stmax -\/ stmin}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01535}01535                 <= *xtol * stmax)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01536}01536         *stp = stx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01537}01537     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01538}01538     \textcolor{comment}{/*     Obtain another function and derivative. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01539}01539 \textcolor{comment}{/*     s\_copy(task, "{}FG"{}, task\_len, (ftnlen)2); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01540}01540     *task = FG;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01541}01541 L1000:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01542}01542     \textcolor{comment}{/*     Save local variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01543}01543     \textcolor{keywordflow}{if} (brackt) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01544}01544         isave[1] = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01545}01545     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01546}01546         isave[1] = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01547}01547     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01548}01548     isave[2] = stage;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01549}01549     dsave[1] = ginit;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01550}01550     dsave[2] = gtest;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01551}01551     dsave[3] = gx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01552}01552     dsave[4] = gy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01553}01553     dsave[5] = finit;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01554}01554     dsave[6] = fx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01555}01555     dsave[7] = fy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01556}01556     dsave[8] = stx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01557}01557     dsave[9] = sty;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01558}01558     dsave[10] = stmin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01559}01559     dsave[11] = stmax;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01560}01560     dsave[12] = width;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01561}01561     dsave[13] = width1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01562}01562     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01563}01563 \} \textcolor{comment}{/* dcsrch */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01564}01564 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01565}01565 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01566}01566 \textcolor{keywordtype}{int} Lbfgs::dcstep(\textcolor{keywordtype}{double} *stx, \textcolor{keywordtype}{double} *fx, \textcolor{keywordtype}{double} *dx,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01567}01567        \textcolor{keywordtype}{double} *sty, \textcolor{keywordtype}{double} *fy, \textcolor{keywordtype}{double} *dy, \textcolor{keywordtype}{double} *stp,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01568}01568        \textcolor{keywordtype}{double} *fp, \textcolor{keywordtype}{double} *dp, logical *brackt, \textcolor{keywordtype}{double} *stpmin,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01569}01569        \textcolor{keywordtype}{double} *stpmax)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01570}01570 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01571}01571    \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01572}01572    \textcolor{keywordtype}{double} d\_\_1, d\_\_2, d\_\_3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01573}01573 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01574}01574    \textcolor{comment}{/* Builtin functions */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01575}01575    \textcolor{keywordtype}{double} sqrt(\textcolor{keywordtype}{double});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01576}01576 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01577}01577    \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01578}01578    \textcolor{keywordtype}{double} p, q, r\_\_, s, sgnd, stpc, stpf, stpq, gamma, theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01579}01579 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01580}01580    \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01581}01581 \textcolor{comment}{    **********}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01582}01582 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01583}01583 \textcolor{comment}{    Subroutine dcstep}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01584}01584 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01585}01585 \textcolor{comment}{    This subroutine computes a safeguarded step for a search}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01586}01586 \textcolor{comment}{    procedure and updates an interval that contains a step that}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01587}01587 \textcolor{comment}{    satisfies a sufficient decrease and a curvature condition.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01588}01588 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01589}01589 \textcolor{comment}{    The parameter stx contains the step with the least function}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01590}01590 \textcolor{comment}{    value. If brackt is set to .true. then a minimizer has}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01591}01591 \textcolor{comment}{    been bracketed in an interval with endpoints stx and sty.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01592}01592 \textcolor{comment}{    The parameter stp contains the current step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01593}01593 \textcolor{comment}{    The subroutine assumes that if brackt is set to .true. then}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01594}01594 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01595}01595 \textcolor{comment}{    min(stx,sty) < stp < fmax(stx,sty),}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01596}01596 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01597}01597 \textcolor{comment}{    and that the derivative at stx is negative in the direction}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01598}01598 \textcolor{comment}{    of the step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01599}01599 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01600}01600 \textcolor{comment}{    The subroutine statement is}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01601}01601 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01602}01602 \textcolor{comment}{    subroutine dcstep(stx,fx,dx,sty,fy,dy,stp,fp,dp,brackt,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01603}01603 \textcolor{comment}{    stpmin,stpmax)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01604}01604 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01605}01605 \textcolor{comment}{    where}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01606}01606 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01607}01607 \textcolor{comment}{    stx is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01608}01608 \textcolor{comment}{    On entry stx is the best step obtained so far and is an}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01609}01609 \textcolor{comment}{    endpoint of the interval that contains the minimizer.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01610}01610 \textcolor{comment}{    On exit stx is the updated best step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01611}01611 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01612}01612 \textcolor{comment}{    fx is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01613}01613 \textcolor{comment}{    On entry fx is the function at stx.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01614}01614 \textcolor{comment}{    On exit fx is the function at stx.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01615}01615 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01616}01616 \textcolor{comment}{    dx is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01617}01617 \textcolor{comment}{    On entry dx is the derivative of the function at}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01618}01618 \textcolor{comment}{    stx. The derivative must be negative in the direction of}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01619}01619 \textcolor{comment}{    the step, that is, dx and stp -\/ stx must have opposite}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01620}01620 \textcolor{comment}{    signs.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01621}01621 \textcolor{comment}{    On exit dx is the derivative of the function at stx.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01622}01622 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01623}01623 \textcolor{comment}{    sty is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01624}01624 \textcolor{comment}{    On entry sty is the second endpoint of the interval that}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01625}01625 \textcolor{comment}{    contains the minimizer.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01626}01626 \textcolor{comment}{    On exit sty is the updated endpoint of the interval that}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01627}01627 \textcolor{comment}{    contains the minimizer.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01628}01628 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01629}01629 \textcolor{comment}{    fy is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01630}01630 \textcolor{comment}{    On entry fy is the function at sty.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01631}01631 \textcolor{comment}{    On exit fy is the function at sty.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01632}01632 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01633}01633 \textcolor{comment}{    dy is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01634}01634 \textcolor{comment}{    On entry dy is the derivative of the function at sty.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01635}01635 \textcolor{comment}{    On exit dy is the derivative of the function at the exit sty.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01636}01636 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01637}01637 \textcolor{comment}{    stp is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01638}01638 \textcolor{comment}{    On entry stp is the current step. If brackt is set to .true.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01639}01639 \textcolor{comment}{    then on input stp must be between stx and sty.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01640}01640 \textcolor{comment}{    On exit stp is a new trial step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01641}01641 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01642}01642 \textcolor{comment}{    fp is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01643}01643 \textcolor{comment}{    On entry fp is the function at stp}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01644}01644 \textcolor{comment}{    On exit fp is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01645}01645 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01646}01646 \textcolor{comment}{    dp is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01647}01647 \textcolor{comment}{    On entry dp is the the derivative of the function at stp.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01648}01648 \textcolor{comment}{    On exit dp is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01649}01649 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01650}01650 \textcolor{comment}{    brackt is an logical variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01651}01651 \textcolor{comment}{   On entry brackt specifies if a minimizer has been bracketed.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01652}01652 \textcolor{comment}{       Initially brackt must be set to .false.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01653}01653 \textcolor{comment}{       On exit brackt specifies if a minimizer has been bracketed.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01654}01654 \textcolor{comment}{       When a minimizer is bracketed brackt is set to .true.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01655}01655 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01656}01656 \textcolor{comment}{       stpmin is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01657}01657 \textcolor{comment}{       On entry stpmin is a lower bound for the step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01658}01658 \textcolor{comment}{       On exit stpmin is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01659}01659 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01660}01660 \textcolor{comment}{       stpmax is a double precision variable.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01661}01661 \textcolor{comment}{       On entry stpmax is an upper bound for the step.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01662}01662 \textcolor{comment}{       On exit stpmax is unchanged.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01663}01663 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01664}01664 \textcolor{comment}{       MINPACK-\/1 Project. June 1983}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01665}01665 \textcolor{comment}{       Argonne National Laboratory.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01666}01666 \textcolor{comment}{       Jorge J. More' and David J. Thuente.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01667}01667 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01668}01668 \textcolor{comment}{       MINPACK-\/2 Project. October 1993.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01669}01669 \textcolor{comment}{       Argonne National Laboratory and University of Minnesota.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01670}01670 \textcolor{comment}{       Brett M. Averick and Jorge J. More'.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01671}01671 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01672}01672 \textcolor{comment}{       **********}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01673}01673 \textcolor{comment}{       */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01674}01674        sgnd = *dp * (*dx / fabs(*dx));}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01675}01675    \textcolor{comment}{/*     First case: A higher function value. The minimum is bracketed. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01676}01676    \textcolor{comment}{/*     If the cubic step is closer to stx than the quadratic step, the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01677}01677    \textcolor{comment}{/*     cubic step is taken, otherwise the average of the cubic and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01678}01678    \textcolor{comment}{/*     quadratic steps is taken. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01679}01679    \textcolor{keywordflow}{if} (*fp > *fx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01680}01680        theta = (*fx -\/ *fp) * 3. / (*stp -\/ *stx) + *dx + *dp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01681}01681        \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01682}01682        d\_\_1 = fabs(theta), d\_\_2 = fabs(*dx), d\_\_1 = fmax(d\_\_1,d\_\_2),}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01683}01683          d\_\_2 = fabs(*dp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01684}01684        s = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01685}01685        \textcolor{comment}{/* Computing 2nd power */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01686}01686        d\_\_1 = theta / s;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01687}01687        gamma = s * sqrt(d\_\_1 * d\_\_1 -\/ *dx / s * (*dp / s));}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01688}01688        \textcolor{keywordflow}{if} (*stp < *stx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01689}01689            gamma = -\/gamma;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01690}01690        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01691}01691        p = gamma -\/ *dx + theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01692}01692        q = gamma -\/ *dx + gamma + *dp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01693}01693        r\_\_ = p / q;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01694}01694        stpc = *stx + r\_\_ * (*stp -\/ *stx);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01695}01695        stpq = *stx + *dx / ((*fx -\/ *fp) / (*stp -\/ *stx) + *dx) / 2. * (*stp}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01696}01696                -\/ *stx);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01697}01697        \textcolor{keywordflow}{if} ((d\_\_1 = stpc -\/ *stx, fabs(d\_\_1)) < (d\_\_2 = stpq -\/ *stx, fabs(d\_\_2)))}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01698}01698        \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01699}01699            stpf = stpc;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01700}01700        \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01701}01701            stpf = stpc + (stpq -\/ stpc) / 2.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01702}01702        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01703}01703        *brackt = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01704}01704        \textcolor{comment}{/*     Second case: A lower function value and derivatives of opposite */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01705}01705        \textcolor{comment}{/*     sign. The minimum is bracketed. If the cubic step is farther from */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01706}01706        \textcolor{comment}{/*     stp than the secant step, the cubic step is taken, otherwise the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01707}01707        \textcolor{comment}{/*     secant step is taken. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01708}01708    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sgnd < 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01709}01709        theta = (*fx -\/ *fp) * 3. / (*stp -\/ *stx) + *dx + *dp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01710}01710        \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01711}01711        d\_\_1 = fabs(theta), d\_\_2 = fabs(*dx), d\_\_1 = fmax(d\_\_1,d\_\_2),}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01712}01712          d\_\_2 = fabs(*dp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01713}01713        s = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01714}01714        \textcolor{comment}{/* Computing 2nd power */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01715}01715        d\_\_1 = theta / s;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01716}01716        gamma = s * sqrt(d\_\_1 * d\_\_1 -\/ *dx / s * (*dp / s));}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01717}01717        \textcolor{keywordflow}{if} (*stp > *stx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01718}01718            gamma = -\/gamma;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01719}01719        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01720}01720        p = gamma -\/ *dp + theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01721}01721        q = gamma -\/ *dp + gamma + *dx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01722}01722        r\_\_ = p / q;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01723}01723        stpc = *stp + r\_\_ * (*stx -\/ *stp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01724}01724        stpq = *stp + *dp / (*dp -\/ *dx) * (*stx -\/ *stp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01725}01725        \textcolor{keywordflow}{if} ((d\_\_1 = stpc -\/ *stp, fabs(d\_\_1)) > (d\_\_2 = stpq -\/ *stp, fabs(d\_\_2)))}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01726}01726        \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01727}01727            stpf = stpc;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01728}01728        \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01729}01729            stpf = stpq;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01730}01730        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01731}01731        *brackt = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01732}01732        \textcolor{comment}{/*     Third case: A lower function value, derivatives of the same sign, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01733}01733        \textcolor{comment}{/*     and the magnitude of the derivative decreases. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01734}01734    \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (fabs(*dp) < fabs(*dx)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01735}01735        \textcolor{comment}{/*        The cubic step is computed only if the cubic tends to infinity */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01736}01736        \textcolor{comment}{/*        in the direction of the step or if the minimum of the cubic */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01737}01737        \textcolor{comment}{/*        is beyond stp. Otherwise the cubic step is defined to be the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01738}01738        \textcolor{comment}{/*        secant step. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01739}01739        theta = (*fx -\/ *fp) * 3. / (*stp -\/ *stx) + *dx + *dp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01740}01740        \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01741}01741        d\_\_1 = fabs(theta), d\_\_2 = fabs(*dx), d\_\_1 = fmax(d\_\_1,d\_\_2),}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01742}01742          d\_\_2 = fabs(*dp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01743}01743        s = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01744}01744        \textcolor{comment}{/*        The case gamma = 0 only arises if the cubic does not tend */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01745}01745        \textcolor{comment}{/*        to infinity in the direction of the step. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01746}01746        \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01747}01747        \textcolor{comment}{/* Computing 2nd power */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01748}01748        d\_\_3 = theta / s;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01749}01749        d\_\_1 = 0., d\_\_2 = d\_\_3 * d\_\_3 -\/ *dx / s * (*dp / s);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01750}01750        gamma = s * sqrt((fmax(d\_\_1,d\_\_2)));}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01751}01751        \textcolor{keywordflow}{if} (*stp > *stx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01752}01752            gamma = -\/gamma;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01753}01753        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01754}01754        p = gamma -\/ *dp + theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01755}01755        q = gamma + (*dx -\/ *dp) + gamma;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01756}01756        r\_\_ = p / q;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01757}01757        \textcolor{keywordflow}{if} (r\_\_ < 0. \&\& gamma != 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01758}01758            stpc = *stp + r\_\_ * (*stx -\/ *stp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01759}01759        \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*stp > *stx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01760}01760            stpc = *stpmax;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01761}01761        \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01762}01762            stpc = *stpmin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01763}01763        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01764}01764        stpq = *stp + *dp / (*dp -\/ *dx) * (*stx -\/ *stp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01765}01765        \textcolor{keywordflow}{if} (*brackt) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01766}01766            \textcolor{comment}{/*           A minimizer has been bracketed. If the cubic step is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01767}01767            \textcolor{comment}{/*           closer to stp than the secant step, the cubic step is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01768}01768            \textcolor{comment}{/*           taken, otherwise the secant step is taken. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01769}01769            \textcolor{keywordflow}{if} ((d\_\_1 = stpc -\/ *stp, fabs(d\_\_1)) <}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01770}01770                (d\_\_2 = stpq -\/ *stp, fabs(d\_\_2))) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01771}01771                stpf = stpc;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01772}01772            \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01773}01773                stpf = stpq;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01774}01774            \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01775}01775            \textcolor{keywordflow}{if} (*stp > *stx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01776}01776                \textcolor{comment}{/* Computing MIN */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01777}01777                d\_\_1 = *stp + (*sty -\/ *stp) * .66;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01778}01778                stpf = fmin(d\_\_1,stpf);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01779}01779            \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01780}01780                \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01781}01781                d\_\_1 = *stp + (*sty -\/ *stp) * .66;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01782}01782                stpf = fmax(d\_\_1,stpf);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01783}01783            \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01784}01784        \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01785}01785            \textcolor{comment}{/*           A minimizer has not been bracketed. If the cubic step is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01786}01786            \textcolor{comment}{/*           farther from stp than the secant step, the cubic step is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01787}01787            \textcolor{comment}{/*           taken, otherwise the secant step is taken. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01788}01788            \textcolor{keywordflow}{if} ((d\_\_1 = stpc -\/ *stp, fabs(d\_\_1)) >}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01789}01789                (d\_\_2 = stpq -\/ *stp, fabs(d\_\_2))) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01790}01790                stpf = stpc;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01791}01791            \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01792}01792                stpf = stpq;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01793}01793            \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01794}01794            stpf = fmin(*stpmax,stpf);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01795}01795            stpf = fmax(*stpmin,stpf);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01796}01796        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01797}01797        \textcolor{comment}{/*     Fourth case: A lower function value, derivatives of the same sign, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01798}01798        \textcolor{comment}{/*     and the magnitude of the derivative does not decrease. If the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01799}01799        \textcolor{comment}{/*     minimum is not bracketed, the step is either stpmin or stpmax, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01800}01800        \textcolor{comment}{/*     otherwise the cubic step is taken. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01801}01801    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01802}01802        \textcolor{keywordflow}{if} (*brackt) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01803}01803            theta = (*fp -\/ *fy) * 3. / (*sty -\/ *stp) + *dy + *dp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01804}01804            \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01805}01805            d\_\_1 = fabs(theta), d\_\_2 = fabs(*dy), d\_\_1 = fmax(d\_\_1,d\_\_2),}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01806}01806              d\_\_2 = fabs(*dp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01807}01807            s = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01808}01808            \textcolor{comment}{/* Computing 2nd power */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01809}01809            d\_\_1 = theta / s;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01810}01810            gamma = s * sqrt(d\_\_1 * d\_\_1 -\/ *dy / s * (*dp / s));}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01811}01811            \textcolor{keywordflow}{if} (*stp > *sty) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01812}01812                gamma = -\/gamma;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01813}01813            \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01814}01814            p = gamma -\/ *dp + theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01815}01815            q = gamma -\/ *dp + gamma + *dy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01816}01816            r\_\_ = p / q;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01817}01817            stpc = *stp + r\_\_ * (*sty -\/ *stp);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01818}01818            stpf = stpc;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01819}01819        \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*stp > *stx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01820}01820            stpf = *stpmax;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01821}01821        \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01822}01822            stpf = *stpmin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01823}01823        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01824}01824    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01825}01825    \textcolor{comment}{/*     Update the interval which contains a minimizer. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01826}01826    \textcolor{keywordflow}{if} (*fp > *fx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01827}01827        *sty = *stp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01828}01828        *fy = *fp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01829}01829        *dy = *dp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01830}01830    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01831}01831        \textcolor{keywordflow}{if} (sgnd < 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01832}01832            *sty = *stx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01833}01833            *fy = *fx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01834}01834            *dy = *dx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01835}01835        \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01836}01836        *stx = *stp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01837}01837        *fx = *fp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01838}01838        *dx = *dp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01839}01839    \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01840}01840    \textcolor{comment}{/*     Compute the new step. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01841}01841    *stp = stpf;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01842}01842    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01843}01843 \} \textcolor{comment}{/* dcstep */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01844}01844 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01845}01845 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01846}01846 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01847}01847 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01848}01848 \textcolor{keywordtype}{int} Lbfgs::dpofa(\textcolor{keywordtype}{double} *a, integer *lda, integer *n, integer *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01849}01849     info)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01850}01850 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01851}01851     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01852}01852     integer a\_dim1, a\_offset, i\_\_1, i\_\_2, i\_\_3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01853}01853 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01854}01854     \textcolor{comment}{/* Builtin functions */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01855}01855     \textcolor{keywordtype}{double} sqrt(\textcolor{keywordtype}{double});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01856}01856 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01857}01857     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01858}01858      integer j, k;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01859}01859      \textcolor{keywordtype}{double} s, t;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01860}01860      integer jm1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01861}01861 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01862}01862 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01863}01863 \textcolor{comment}{    dpofa factors a double precision symmetric positive definite}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01864}01864 \textcolor{comment}{    matrix.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01865}01865 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01866}01866 \textcolor{comment}{    dpofa is usually called by dpoco, but it can be called}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01867}01867 \textcolor{comment}{    directly with a saving in time if  rcond  is not needed.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01868}01868 \textcolor{comment}{    (time for dpoco) = (1 + 18/n)*(time for dpofa) .}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01869}01869 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01870}01870 \textcolor{comment}{    on entry}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01871}01871 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01872}01872 \textcolor{comment}{       a       double precision(lda, n)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01873}01873 \textcolor{comment}{               the symmetric matrix to be factored.  only the}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01874}01874 \textcolor{comment}{               diagonal and upper triangle are used.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01875}01875 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01876}01876 \textcolor{comment}{       lda     integer}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01877}01877 \textcolor{comment}{               the leading dimension of the array  a .}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01878}01878 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01879}01879 \textcolor{comment}{       n       integer}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01880}01880 \textcolor{comment}{               the order of the matrix  a .}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01881}01881 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01882}01882 \textcolor{comment}{    on return}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01883}01883 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01884}01884 \textcolor{comment}{       a       an upper triangular matrix  r  so that  a = trans(r)*r}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01885}01885 \textcolor{comment}{               where  trans(r)  is the transpose.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01886}01886 \textcolor{comment}{               the strict lower triangle is unaltered.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01887}01887 \textcolor{comment}{               if  info .ne. 0 , the factorization is not complete.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01888}01888 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01889}01889 \textcolor{comment}{       info    integer}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01890}01890 \textcolor{comment}{               = 0  for normal return.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01891}01891 \textcolor{comment}{               = k  signals an error condition.  the leading minor}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01892}01892 \textcolor{comment}{                    of order  k  is not positive definite.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01893}01893 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01894}01894 \textcolor{comment}{    linpack.  this version dated 08/14/78 .}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01895}01895 \textcolor{comment}{    cleve moler, university of new mexico, argonne national lab.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01896}01896 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01897}01897 \textcolor{comment}{    subroutines and functions}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01898}01898 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01899}01899 \textcolor{comment}{    blas ddot}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01900}01900 \textcolor{comment}{    fortran sqrt}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01901}01901 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01902}01902 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01903}01903 \textcolor{comment}{/*     internal variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01904}01904 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01905}01905 \textcolor{comment}{/*     begin block with ...exits to 40 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01906}01906 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01907}01907 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01908}01908     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01909}01909     a\_dim1 = *lda;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01910}01910     a\_offset = 1 + a\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01911}01911     a -\/= a\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01912}01912 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01913}01913     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01914}01914     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01915}01915     \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01916}01916     *info = j;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01917}01917     s = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01918}01918     jm1 = j -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01919}01919     \textcolor{keywordflow}{if} (jm1 < 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01920}01920         \textcolor{keywordflow}{goto} L20;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01921}01921     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01922}01922     i\_\_2 = jm1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01923}01923     \textcolor{keywordflow}{for} (k = 1; k <= i\_\_2; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01924}01924         i\_\_3 = k -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01925}01925         t = a[k + j * a\_dim1] -\/ ddot(\&i\_\_3, \&a[k * a\_dim1 + 1], \&c\_\_1, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01926}01926             a[j * a\_dim1 + 1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01927}01927         t /= a[k + k * a\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01928}01928         a[k + j * a\_dim1] = t;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01929}01929         s += t * t;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01930}01930 \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01931}01931     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01932}01932 L20:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01933}01933     s = a[j + j * a\_dim1] -\/ s;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01934}01934 \textcolor{comment}{/*     ......exit */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01935}01935     \textcolor{keywordflow}{if} (s <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01936}01936         \textcolor{keywordflow}{goto} L40;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01937}01937     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01938}01938     a[j + j * a\_dim1] = sqrt(s);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01939}01939 \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01940}01940     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01941}01941     *info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01942}01942 L40:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01943}01943     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01944}01944 \} \textcolor{comment}{/* dpofa */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01945}01945 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01946}01946 \textcolor{comment}{/* ====================== The end of dpofa =============================== */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01947}01947 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01948}01948 \textcolor{keywordtype}{int} Lbfgs::dtrsl(\textcolor{keywordtype}{double} *t, integer *ldt, integer *n,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01949}01949     \textcolor{keywordtype}{double} *b, integer *job, integer *info)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01950}01950 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01951}01951     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01952}01952     integer t\_dim1, t\_offset, i\_\_1, i\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01953}01953 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01954}01954     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01955}01955      integer j, jj, case\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01956}01956      \textcolor{keywordtype}{double} temp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01957}01957     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01958}01958 \textcolor{comment}{    extern double ddot(integer *, double *, integer *, double *,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01959}01959 \textcolor{comment}{        integer *);}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01960}01960 \textcolor{comment}{    extern  int daxpy(integer *, double *, double *,}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01961}01961 \textcolor{comment}{        integer *, double *, integer *);}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01962}01962 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01963}01963 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01964}01964 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01965}01965 \textcolor{comment}{/*     dtrsl solves systems of the form */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01966}01966 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01967}01967 \textcolor{comment}{/*                   t * x = b */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01968}01968 \textcolor{comment}{/*     or */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01969}01969 \textcolor{comment}{/*                   trans(t) * x = b */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01970}01970 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01971}01971 \textcolor{comment}{/*     where t is a triangular matrix of order n. here trans(t) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01972}01972 \textcolor{comment}{/*     denotes the transpose of the matrix t. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01973}01973 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01974}01974 \textcolor{comment}{/*     on entry */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01975}01975 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01976}01976 \textcolor{comment}{/*         t         double precision(ldt,n) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01977}01977 \textcolor{comment}{/*                   t contains the matrix of the system. the zero */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01978}01978 \textcolor{comment}{/*                   elements of the matrix are not referenced, and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01979}01979 \textcolor{comment}{/*                   the corresponding elements of the array can be */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01980}01980 \textcolor{comment}{/*                   used to store other information. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01981}01981 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01982}01982 \textcolor{comment}{/*         ldt       integer */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01983}01983 \textcolor{comment}{/*                   ldt is the leading dimension of the array t. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01984}01984 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01985}01985 \textcolor{comment}{/*         n         integer */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01986}01986 \textcolor{comment}{/*                   n is the order of the system. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01987}01987 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01988}01988 \textcolor{comment}{/*         b         double precision(n). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01989}01989 \textcolor{comment}{/*                   b contains the right hand side of the system. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01990}01990 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01991}01991 \textcolor{comment}{/*         job       integer */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01992}01992 \textcolor{comment}{/*                   job specifies what kind of system is to be solved. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01993}01993 \textcolor{comment}{/*                   if job is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01994}01994 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01995}01995 \textcolor{comment}{/*                        00   solve t*x=b, t lower triangular, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01996}01996 \textcolor{comment}{/*                        01   solve t*x=b, t upper triangular, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01997}01997 \textcolor{comment}{/*                        10   solve trans(t)*x=b, t lower triangular, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01998}01998 \textcolor{comment}{/*                        11   solve trans(t)*x=b, t upper triangular. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l01999}01999 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02000}02000 \textcolor{comment}{/*     on return */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02001}02001 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02002}02002 \textcolor{comment}{/*         b         b contains the solution, if info .eq. 0. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02003}02003 \textcolor{comment}{/*                   otherwise b is unaltered. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02004}02004 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02005}02005 \textcolor{comment}{/*         info      integer */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02006}02006 \textcolor{comment}{/*                   info contains zero if the system is nonsingular. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02007}02007 \textcolor{comment}{/*                   otherwise info contains the index of */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02008}02008 \textcolor{comment}{/*                   the first zero diagonal element of t. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02009}02009 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02010}02010 \textcolor{comment}{/*     linpack. this version dated 08/14/78 . */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02011}02011 \textcolor{comment}{/*     g. w. stewart, university of maryland, argonne national lab. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02012}02012 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02013}02013 \textcolor{comment}{/*     subroutines and functions */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02014}02014 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02015}02015 \textcolor{comment}{/*     blas daxpy,ddot */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02016}02016 \textcolor{comment}{/*     fortran mod */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02017}02017 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02018}02018 \textcolor{comment}{/*     internal variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02019}02019 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02020}02020 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02021}02021 \textcolor{comment}{/*     begin block permitting ...exits to 150 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02022}02022 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02023}02023     \textcolor{comment}{/*        check for zero diagonal elements. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02024}02024 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02025}02025     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02026}02026     t\_dim1 = *ldt;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02027}02027     t\_offset = 1 + t\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02028}02028     t -\/= t\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02029}02029     -\/-\/b;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02030}02030 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02031}02031     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02032}02032     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02033}02033 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02034}02034     \textcolor{keywordflow}{for} (*info = 1; *info <= i\_\_1; ++(*info)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02035}02035         \textcolor{comment}{/*     ......exit */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02036}02036         \textcolor{keywordflow}{if} (t[*info + *info * t\_dim1] == 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02037}02037             \textcolor{keywordflow}{goto} L150;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02038}02038         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02039}02039         \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02040}02040     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02041}02041     *info = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02042}02042     \textcolor{comment}{/* SRB: there is a problem with this. Not sure */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02043}02043     \textcolor{comment}{/* It keeps returning with info==2.  Feb 17 2015 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02044}02044 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02045}02045     \textcolor{comment}{/*        determine the task and go to it. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02046}02046 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02047}02047     case\_\_ = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02048}02048     \textcolor{keywordflow}{if} (*job \% 10 != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02049}02049         case\_\_ = 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02050}02050     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02051}02051     \textcolor{keywordflow}{if} (*job \% 100 / 10 != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02052}02052         case\_\_ += 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02053}02053     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02054}02054     \textcolor{keywordflow}{switch} (case\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02055}02055         \textcolor{keywordflow}{case} 1:  \textcolor{keywordflow}{goto} L20;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02056}02056         \textcolor{keywordflow}{case} 2:  \textcolor{keywordflow}{goto} L50;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02057}02057         \textcolor{keywordflow}{case} 3:  \textcolor{keywordflow}{goto} L80;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02058}02058         \textcolor{keywordflow}{case} 4:  \textcolor{keywordflow}{goto} L110;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02059}02059     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02060}02060 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02061}02061     \textcolor{comment}{/*        solve t*x=b for t lower triangular */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02062}02062 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02063}02063 L20:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02064}02064     b[1] /= t[t\_dim1 + 1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02065}02065     \textcolor{keywordflow}{if} (*n < 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02066}02066         \textcolor{keywordflow}{goto} L40;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02067}02067     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02068}02068     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02069}02069     \textcolor{keywordflow}{for} (j = 2; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02070}02070         temp = -\/b[j -\/ 1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02071}02071         i\_\_2 = *n -\/ j + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02072}02072         daxpy(\&i\_\_2, \&temp, \&t[j + (j -\/ 1) * t\_dim1], \&c\_\_1, \&b[j], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02073}02073         b[j] /= t[j + j * t\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02074}02074         \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02075}02075     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02076}02076 L40:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02077}02077     \textcolor{keywordflow}{goto} L140;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02078}02078 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02079}02079 \textcolor{comment}{/*        solve t*x=b for t upper triangular. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02080}02080 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02081}02081 L50:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02082}02082     b[*n] /= t[*n + *n * t\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02083}02083     \textcolor{keywordflow}{if} (*n < 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02084}02084         \textcolor{keywordflow}{goto} L70;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02085}02085     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02086}02086     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02087}02087     \textcolor{keywordflow}{for} (jj = 2; jj <= i\_\_1; ++jj) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02088}02088         j = *n -\/ jj + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02089}02089         temp = -\/b[j + 1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02090}02090         daxpy(\&j, \&temp, \&t[(j + 1) * t\_dim1 + 1], \&c\_\_1, \&b[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02091}02091         b[j] /= t[j + j * t\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02092}02092         \textcolor{comment}{/* L60: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02093}02093     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02094}02094 L70:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02095}02095     \textcolor{keywordflow}{goto} L140;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02096}02096 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02097}02097 \textcolor{comment}{/*        solve trans(t)*x=b for t lower triangular. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02098}02098 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02099}02099 L80:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02100}02100     b[*n] /= t[*n + *n * t\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02101}02101     \textcolor{keywordflow}{if} (*n < 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02102}02102         \textcolor{keywordflow}{goto} L100;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02103}02103     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02104}02104     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02105}02105     \textcolor{keywordflow}{for} (jj = 2; jj <= i\_\_1; ++jj) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02106}02106         j = *n -\/ jj + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02107}02107         i\_\_2 = jj -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02108}02108         b[j] -\/= ddot(\&i\_\_2, \&t[j + 1 + j * t\_dim1], \&c\_\_1, \&b[j + 1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02109}02109         b[j] /= t[j + j * t\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02110}02110         \textcolor{comment}{/* L90: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02111}02111     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02112}02112 L100:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02113}02113     \textcolor{keywordflow}{goto} L140;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02114}02114 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02115}02115 \textcolor{comment}{/*        solve trans(t)*x=b for t upper triangular. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02116}02116 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02117}02117 L110:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02118}02118     b[1] /= t[t\_dim1 + 1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02119}02119     \textcolor{keywordflow}{if} (*n < 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02120}02120         \textcolor{keywordflow}{goto} L130;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02121}02121     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02122}02122     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02123}02123     \textcolor{keywordflow}{for} (j = 2; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02124}02124         i\_\_2 = j -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02125}02125         b[j] -\/= ddot(\&i\_\_2, \&t[j * t\_dim1 + 1], \&c\_\_1, \&b[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02126}02126         b[j] /= t[j + j * t\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02127}02127         \textcolor{comment}{/* L120: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02128}02128     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02129}02129 L130:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02130}02130 L140:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02131}02131 L150:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02132}02132     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02133}02133 \} \textcolor{comment}{/* dtrsl */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02134}02134 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02135}02135 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02136}02136 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02137}02137 \textcolor{keywordtype}{int} Lbfgs::daxpy(integer *n, \textcolor{keywordtype}{double} *da, \textcolor{keywordtype}{double} *dx,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02138}02138     integer *incx, \textcolor{keywordtype}{double} *dy, integer *incy)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02139}02139 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02140}02140 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02141}02141     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02142}02142     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02143}02143 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02144}02144     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02145}02145      integer i, m, ix, iy, mp1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02146}02146 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02147}02147 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02148}02148 \textcolor{comment}{/*     constant times a vector plus a vector.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02149}02149 \textcolor{comment}{       uses unrolled loops for increments equal to one.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02150}02150 \textcolor{comment}{       jack dongarra, linpack, 3/11/78.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02151}02151 \textcolor{comment}{       modified 12/3/93, array(1) declarations changed to array(*)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02152}02152 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02153}02153 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02154}02154 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02155}02155 \textcolor{comment}{       Parameter adjustments}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02156}02156 \textcolor{comment}{       Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02157}02157 \textcolor{preprocessor}{\#define DY(I) dy[(I)-\/1]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02158}02158 \textcolor{preprocessor}{\#define DX(I) dx[(I)-\/1]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02159}02159 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02160}02160 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02161}02161     \textcolor{keywordflow}{if} (*n <= 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02162}02162         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02163}02163     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02164}02164     \textcolor{keywordflow}{if} (*da == 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02165}02165         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02166}02166     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02167}02167     \textcolor{keywordflow}{if} (*incx == 1 \&\& *incy == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02168}02168         \textcolor{keywordflow}{goto} L20;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02169}02169     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02170}02170 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02171}02171     \textcolor{comment}{/*        code for unequal increments or equal increments}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02172}02172 \textcolor{comment}{              not equal to 1 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02173}02173 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02174}02174     ix = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02175}02175     iy = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02176}02176     \textcolor{keywordflow}{if} (*incx < 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02177}02177         ix = (-\/(*n) + 1) * *incx + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02178}02178     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02179}02179     \textcolor{keywordflow}{if} (*incy < 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02180}02180         iy = (-\/(*n) + 1) * *incy + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02181}02181     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02182}02182     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02183}02183     \textcolor{keywordflow}{for} (i = 1; i <= *n; ++i) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02184}02184         DY(iy) += *da * DX(ix);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02185}02185         ix += *incx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02186}02186         iy += *incy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02187}02187         \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02188}02188     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02189}02189     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02190}02190 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02191}02191     \textcolor{comment}{/*        code for both increments equal to 1}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02192}02192 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02193}02193 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02194}02194 \textcolor{comment}{              clean-\/up loop */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02195}02195 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02196}02196 L20:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02197}02197     m = *n \% 4;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02198}02198     \textcolor{keywordflow}{if} (m == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02199}02199         \textcolor{keywordflow}{goto} L40;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02200}02200     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02201}02201     i\_\_1 = m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02202}02202     \textcolor{keywordflow}{for} (i = 1; i <= m; ++i) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02203}02203         DY(i) += *da * DX(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02204}02204         \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02205}02205     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02206}02206     \textcolor{keywordflow}{if} (*n < 4) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02207}02207         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02208}02208     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02209}02209 L40:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02210}02210     mp1 = m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02211}02211     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02212}02212     \textcolor{keywordflow}{for} (i = mp1; i <= *n; i += 4) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02213}02213         DY(i) += *da * DX(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02214}02214         DY(i + 1) += *da * DX(i + 1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02215}02215         DY(i + 2) += *da * DX(i + 2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02216}02216         DY(i + 3) += *da * DX(i + 3);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02217}02217         \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02218}02218     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02219}02219     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02220}02220 \} \textcolor{comment}{/* daxpyRef */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02221}02221 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02222}02222 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02223}02223 \textcolor{keywordtype}{int} Lbfgs::dcopy(integer *n, \textcolor{keywordtype}{double} *dx, integer *incx,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02224}02224         \textcolor{keywordtype}{double} *dy, integer *incy)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02225}02225 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02226}02226 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02227}02227 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02228}02228     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02229}02229     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02230}02230 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02231}02231     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02232}02232      integer i, m, ix, iy, mp1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02233}02233 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02234}02234 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02235}02235     \textcolor{comment}{/*     copies a vector, x, to a vector, y.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02236}02236 \textcolor{comment}{           uses unrolled loops for increments equal to one.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02237}02237 \textcolor{comment}{           jack dongarra, linpack, 3/11/78.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02238}02238 \textcolor{comment}{           modified 12/3/93, array(1) declarations changed to array(*)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02239}02239 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02240}02240 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02241}02241 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02242}02242 \textcolor{comment}{           Parameter adjustments}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02243}02243 \textcolor{comment}{           Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02244}02244 \textcolor{preprocessor}{\#define DY(I) dy[(I)-\/1]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02245}02245 \textcolor{preprocessor}{\#define DX(I) dx[(I)-\/1]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02246}02246 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02247}02247 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02248}02248     \textcolor{keywordflow}{if} (*n <= 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02249}02249         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02250}02250     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02251}02251     \textcolor{keywordflow}{if} (*incx == 1 \&\& *incy == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02252}02252         \textcolor{keywordflow}{goto} L20;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02253}02253     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02254}02254 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02255}02255     \textcolor{comment}{/*        code for unequal increments or equal increments}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02256}02256 \textcolor{comment}{              not equal to 1 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02257}02257 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02258}02258     ix = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02259}02259     iy = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02260}02260     \textcolor{keywordflow}{if} (*incx < 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02261}02261         ix = (-\/(*n) + 1) * *incx + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02262}02262     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02263}02263     \textcolor{keywordflow}{if} (*incy < 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02264}02264         iy = (-\/(*n) + 1) * *incy + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02265}02265     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02266}02266     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02267}02267     \textcolor{keywordflow}{for} (i = 1; i <= *n; ++i) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02268}02268         DY(iy) = DX(ix);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02269}02269         ix += *incx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02270}02270         iy += *incy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02271}02271         \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02272}02272     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02273}02273     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02274}02274 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02275}02275     \textcolor{comment}{/*        code for both increments equal to 1}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02276}02276 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02277}02277 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02278}02278 \textcolor{comment}{              clean-\/up loop */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02279}02279 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02280}02280 L20:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02281}02281     m = *n \% 7;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02282}02282     \textcolor{keywordflow}{if} (m == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02283}02283         \textcolor{keywordflow}{goto} L40;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02284}02284     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02285}02285     i\_\_1 = m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02286}02286     \textcolor{keywordflow}{for} (i = 1; i <= m; ++i) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02287}02287         DY(i) = DX(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02288}02288         \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02289}02289     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02290}02290     \textcolor{keywordflow}{if} (*n < 7) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02291}02291         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02292}02292     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02293}02293 L40:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02294}02294     mp1 = m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02295}02295     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02296}02296     \textcolor{keywordflow}{for} (i = mp1; i <= *n; i += 7) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02297}02297         DY(i) = DX(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02298}02298         DY(i + 1) = DX(i + 1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02299}02299         DY(i + 2) = DX(i + 2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02300}02300         DY(i + 3) = DX(i + 3);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02301}02301         DY(i + 4) = DX(i + 4);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02302}02302         DY(i + 5) = DX(i + 5);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02303}02303         DY(i + 6) = DX(i + 6);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02304}02304         \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02305}02305     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02306}02306     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02307}02307 \} \textcolor{comment}{/* dcopyRef */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02308}02308 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02309}02309 \textcolor{keywordtype}{double} Lbfgs::ddot(integer *n, \textcolor{keywordtype}{double} *dx, integer *incx, \textcolor{keywordtype}{double} *dy,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02310}02310         integer *incy)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02311}02311 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02312}02312 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02313}02313 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02314}02314     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02315}02315     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02316}02316     \textcolor{keywordtype}{double} ret\_val;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02317}02317 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02318}02318     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02319}02319      integer i, m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02320}02320      \textcolor{keywordtype}{double} dtemp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02321}02321      integer ix, iy, mp1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02322}02322 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02323}02323 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02324}02324     \textcolor{comment}{/*     forms the dot product of two vectors.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02325}02325 \textcolor{comment}{           uses unrolled loops for increments equal to one.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02326}02326 \textcolor{comment}{           jack dongarra, linpack, 3/11/78.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02327}02327 \textcolor{comment}{           modified 12/3/93, array(1) declarations changed to array(*)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02328}02328 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02329}02329 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02330}02330 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02331}02331 \textcolor{comment}{           Parameter adjustments}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02332}02332 \textcolor{comment}{           Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02333}02333 \textcolor{preprocessor}{\#define DY(I) dy[(I)-\/1]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02334}02334 \textcolor{preprocessor}{\#define DX(I) dx[(I)-\/1]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02335}02335 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02336}02336 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02337}02337     ret\_val = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02338}02338     dtemp = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02339}02339     \textcolor{keywordflow}{if} (*n <= 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02340}02340         \textcolor{keywordflow}{return} ret\_val;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02341}02341     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02342}02342     \textcolor{keywordflow}{if} (*incx == 1 \&\& *incy == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02343}02343         \textcolor{keywordflow}{goto} L20;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02344}02344     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02345}02345 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02346}02346     \textcolor{comment}{/*        code for unequal increments or equal increments}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02347}02347 \textcolor{comment}{              not equal to 1 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02348}02348 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02349}02349     ix = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02350}02350     iy = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02351}02351     \textcolor{keywordflow}{if} (*incx < 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02352}02352         ix = (-\/(*n) + 1) * *incx + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02353}02353     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02354}02354     \textcolor{keywordflow}{if} (*incy < 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02355}02355         iy = (-\/(*n) + 1) * *incy + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02356}02356     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02357}02357     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02358}02358     \textcolor{keywordflow}{for} (i = 1; i <= *n; ++i) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02359}02359         dtemp += DX(ix) * DY(iy);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02360}02360         ix += *incx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02361}02361         iy += *incy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02362}02362         \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02363}02363     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02364}02364     ret\_val = dtemp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02365}02365     \textcolor{keywordflow}{return} ret\_val;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02366}02366 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02367}02367     \textcolor{comment}{/*        code for both increments equal to 1}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02368}02368 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02369}02369 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02370}02370 \textcolor{comment}{              clean-\/up loop */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02371}02371 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02372}02372 L20:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02373}02373     m = *n \% 5;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02374}02374     \textcolor{keywordflow}{if} (m == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02375}02375         \textcolor{keywordflow}{goto} L40;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02376}02376     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02377}02377     i\_\_1 = m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02378}02378     \textcolor{keywordflow}{for} (i = 1; i <= m; ++i) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02379}02379         dtemp += DX(i) * DY(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02380}02380         \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02381}02381     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02382}02382     \textcolor{keywordflow}{if} (*n < 5) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02383}02383         \textcolor{keywordflow}{goto} L60;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02384}02384     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02385}02385 L40:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02386}02386     mp1 = m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02387}02387     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02388}02388     \textcolor{keywordflow}{for} (i = mp1; i <= *n; i += 5) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02389}02389         dtemp = dtemp + DX(i) * DY(i) + DX(i + 1) * DY(i + 1) + DX(i + 2) *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02390}02390             DY(i + 2) + DX(i + 3) * DY(i + 3) + DX(i + 4) * DY(i + 4);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02391}02391         \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02392}02392     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02393}02393 L60:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02394}02394     ret\_val = dtemp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02395}02395     \textcolor{keywordflow}{return} ret\_val;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02396}02396 \} \textcolor{comment}{/* ddotRef */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02397}02397 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02398}02398 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02399}02399 \textcolor{keywordtype}{int} Lbfgs::dscal(integer *n, \textcolor{keywordtype}{double} *da, \textcolor{keywordtype}{double} *dx,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02400}02400         integer *incx)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02401}02401 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02402}02402 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02403}02403 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02404}02404     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02405}02405     integer i\_\_1, i\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02406}02406 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02407}02407     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02408}02408     integer i, m, nincx, mp1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02409}02409 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02410}02410 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02411}02411     \textcolor{comment}{/*     scales a vector by a constant.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02412}02412 \textcolor{comment}{           uses unrolled loops for increment equal to one.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02413}02413 \textcolor{comment}{           jack dongarra, linpack, 3/11/78.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02414}02414 \textcolor{comment}{           modified 3/93 to return if incx .le. 0.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02415}02415 \textcolor{comment}{           modified 12/3/93, array(1) declarations changed to array(*)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02416}02416 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02417}02417 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02418}02418 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02419}02419 \textcolor{comment}{           Parameter adjustments}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02420}02420 \textcolor{comment}{           Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02421}02421 \textcolor{preprocessor}{\#define DX(I) dx[(I)-\/1]}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02422}02422 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02423}02423 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02424}02424     \textcolor{keywordflow}{if} (*n <= 0 || *incx <= 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02425}02425         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02426}02426     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02427}02427     \textcolor{keywordflow}{if} (*incx == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02428}02428         \textcolor{keywordflow}{goto} L20;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02429}02429     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02430}02430 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02431}02431     \textcolor{comment}{/*        code for increment not equal to 1 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02432}02432 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02433}02433     nincx = *n * *incx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02434}02434     i\_\_1 = nincx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02435}02435     i\_\_2 = *incx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02436}02436     \textcolor{keywordflow}{for} (i = 1; *incx < 0 ? i >= nincx : i <= nincx; i += *incx) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02437}02437         DX(i) = *da * DX(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02438}02438         \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02439}02439     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02440}02440     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02441}02441 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02442}02442     \textcolor{comment}{/*        code for increment equal to 1}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02443}02443 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02444}02444 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02445}02445 \textcolor{comment}{              clean-\/up loop */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02446}02446 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02447}02447 L20:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02448}02448     m = *n \% 5;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02449}02449     \textcolor{keywordflow}{if} (m == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02450}02450         \textcolor{keywordflow}{goto} L40;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02451}02451     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02452}02452     i\_\_2 = m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02453}02453     \textcolor{keywordflow}{for} (i = 1; i <= m; ++i) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02454}02454         DX(i) = *da * DX(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02455}02455         \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02456}02456     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02457}02457     \textcolor{keywordflow}{if} (*n < 5) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02458}02458         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02459}02459     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02460}02460 L40:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02461}02461     mp1 = m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02462}02462     i\_\_2 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02463}02463     \textcolor{keywordflow}{for} (i = mp1; i <= *n; i += 5) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02464}02464         DX(i) = *da * DX(i);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02465}02465         DX(i + 1) = *da * DX(i + 1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02466}02466         DX(i + 2) = *da * DX(i + 2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02467}02467         DX(i + 3) = *da * DX(i + 3);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02468}02468         DX(i + 4) = *da * DX(i + 4);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02469}02469         \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02470}02470     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02471}02471     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02472}02472 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02473}02473 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02474}02474 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02475}02475 \textcolor{keywordtype}{int} Lbfgs::prn1lb(integer *n, integer *m, \textcolor{keywordtype}{double} *l,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02476}02476     \textcolor{keywordtype}{double} *u, \textcolor{keywordtype}{double} *x, integer *iprint, FILE* itfile,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02477}02477     \textcolor{keywordtype}{double} *epsmch)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02478}02478 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02479}02479     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02480}02480 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02481}02481 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02482}02482 \textcolor{comment}{    Subroutine prn1lb}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02483}02483 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02484}02484 \textcolor{comment}{    This subroutine prints the input data, initial point, upper and}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02485}02485 \textcolor{comment}{      lower bounds of each variable, machine precision, as well as}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02486}02486 \textcolor{comment}{      the headings of the output.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02487}02487 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02488}02488 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02489}02489 \textcolor{comment}{                          *  *  *}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02490}02490 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02491}02491 \textcolor{comment}{    NEOS, November 1994. (Latest revision June 1996.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02492}02492 \textcolor{comment}{    Optimization Technology Center.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02493}02493 \textcolor{comment}{    Argonne National Laboratory and Northwestern University.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02494}02494 \textcolor{comment}{    Written by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02495}02495 \textcolor{comment}{                       Ciyou Zhu}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02496}02496 \textcolor{comment}{    in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02497}02497 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02498}02498 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02499}02499 \textcolor{comment}{        ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02500}02500 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02501}02501     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02502}02502     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02503}02503 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02504}02504     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02505}02505     integer i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02506}02506 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02507}02507     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02508}02508     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02509}02509     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02510}02510     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02511}02511 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02512}02512     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02513}02513     \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02514}02514         printf(\textcolor{stringliteral}{"{}           * * *\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02515}02515         printf(\textcolor{stringliteral}{"{}        RUNNING THE L-\/BFGS-\/B CODE\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02516}02516         printf(\textcolor{stringliteral}{"{}           * * *\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02517}02517         printf(\textcolor{stringliteral}{"{}Machine precision = \%.2e\(\backslash\)n"{}}, *epsmch );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02518}02518         printf(\textcolor{stringliteral}{"{} N = \%10ld\(\backslash\)n M = \%10ld\(\backslash\)n"{}}, *n, *m );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02519}02519         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02520}02520             \textcolor{keywordflow}{if} (*iprint > 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02521}02521                 printf(\textcolor{stringliteral}{"{}L  ="{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02522}02522                 i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02523}02523                 \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02524}02524                     printf(\textcolor{stringliteral}{"{}\%.2e "{}}, l[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02525}02525                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02526}02526                 printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02527}02527                 printf(\textcolor{stringliteral}{"{}X0 ="{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02528}02528                 i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02529}02529                 \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02530}02530                     printf(\textcolor{stringliteral}{"{}\%.2e "{}}, x[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02531}02531                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02532}02532                 printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02533}02533                 printf(\textcolor{stringliteral}{"{}U  ="{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02534}02534                 i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02535}02535                 \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02536}02536                     printf(\textcolor{stringliteral}{"{}\%.2e "{}}, u[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02537}02537                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02538}02538                 printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02539}02539             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02540}02540         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02541}02541     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02542}02542     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02543}02543 \} \textcolor{comment}{/* prn1lb */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02544}02544 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02545}02545  \textcolor{keywordtype}{int} Lbfgs::prn2lb(integer *n, \textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{double} *f,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02546}02546     \textcolor{keywordtype}{double} *g, integer *iprint, FILE* itfile, integer *iter,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02547}02547     integer *nfgv, integer *nact, \textcolor{keywordtype}{double} *sbgnrm, integer *nseg, integer}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02548}02548     *word, integer *iword, integer *iback, \textcolor{keywordtype}{double} *stp, \textcolor{keywordtype}{double} *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02549}02549     xstep, ftnlen word\_len)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02550}02550 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02551}02551     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02552}02552 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02553}02553 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02554}02554 \textcolor{comment}{    Subroutine prn2lb}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02555}02555 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02556}02556 \textcolor{comment}{    This subroutine prints out new information after a successful}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02557}02557 \textcolor{comment}{      line search.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02558}02558 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02559}02559 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02560}02560 \textcolor{comment}{                          *  *  *}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02561}02561 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02562}02562 \textcolor{comment}{    NEOS, November 1994. (Latest revision June 1996.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02563}02563 \textcolor{comment}{    Optimization Technology Center.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02564}02564 \textcolor{comment}{    Argonne National Laboratory and Northwestern University.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02565}02565 \textcolor{comment}{    Written by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02566}02566 \textcolor{comment}{                       Ciyou Zhu}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02567}02567 \textcolor{comment}{    in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02568}02568 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02569}02569 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02570}02570 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02571}02571 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02572}02572 \textcolor{comment}{/*           'word' records the status of subspace solutions. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02573}02573     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02574}02574     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02575}02575 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02576}02576     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02577}02577     integer i\_\_, imod;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02578}02578 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02579}02579     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02580}02580     -\/-\/g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02581}02581     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02582}02582 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02583}02583     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02584}02584     \textcolor{keywordflow}{if} (*iword == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02585}02585         *word = WORD\_CON;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02586}02586         \textcolor{comment}{/*  the subspace minimization converged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02587}02587 \textcolor{comment}{/*         s\_copy(word, "{}con"{}, (ftnlen)3, (ftnlen)3); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02588}02588     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*iword == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02589}02589         *word = WORD\_BND;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02590}02590         \textcolor{comment}{/*  the subspace minimization stopped at a bound. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02591}02591 \textcolor{comment}{/*         s\_copy(word, "{}bnd"{}, (ftnlen)3, (ftnlen)3); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02592}02592     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*iword == 5) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02593}02593         *word = WORD\_TNT;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02594}02594         \textcolor{comment}{/*  the truncated Newton step has been used. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02595}02595 \textcolor{comment}{/*         s\_copy(word, "{}TNT"{}, (ftnlen)3, (ftnlen)3); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02596}02596     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02597}02597         *word = WORD\_DEFAULT;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02598}02598 \textcolor{comment}{/*         s\_copy(word, "{}-\/-\/-\/"{}, (ftnlen)3, (ftnlen)3); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02599}02599     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02600}02600     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02601}02601         printf(\textcolor{stringliteral}{"{}LINE SEARCH \%ld times; norm of step = \%.2e\(\backslash\)n"{}}, *iback, *xstep );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02602}02602         printf(\textcolor{stringliteral}{"{}At iterate \%5ld, f(x)= \%5.2e, ||proj grad||\_infty = \%.2e\(\backslash\)n"{}},*iter,*f,*sbgnrm );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02603}02603         \textcolor{keywordflow}{if} (*iprint > 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02604}02604             printf(\textcolor{stringliteral}{"{}X ="{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02605}02605             i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02606}02606             \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02607}02607                 printf(\textcolor{stringliteral}{"{}\%.2e "{}}, x[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02608}02608             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02609}02609             printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02610}02610             printf(\textcolor{stringliteral}{"{}G ="{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02611}02611             i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02612}02612             \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02613}02613                 printf(\textcolor{stringliteral}{"{}\%.2e "{}}, g[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02614}02614             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02615}02615             printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02616}02616         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02617}02617     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*iprint > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02618}02618         imod = *iter \% *iprint;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02619}02619         \textcolor{keywordflow}{if} (imod == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02620}02620             printf(\textcolor{stringliteral}{"{}At iterate \%5ld, f(x)= \%5.2e, ||proj grad||\_infty = \%.2e\(\backslash\)n"{}},*iter,*f,*sbgnrm );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02621}02621         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02622}02622     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02623}02623     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02624}02624 \} \textcolor{comment}{/* prn2lb */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02625}02625 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02626}02626 \textcolor{keywordtype}{int} Lbfgs::prn3lb(integer *n, \textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{double} *f, integer *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02627}02627     task, integer *iprint, integer *info, FILE* itfile, integer *iter,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02628}02628     integer *nfgv, integer *nintol, integer *nskip, integer *nact,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02629}02629     \textcolor{keywordtype}{double} *sbgnrm, \textcolor{keywordtype}{double} *time, integer *nseg, integer *word,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02630}02630     integer *iback, \textcolor{keywordtype}{double} *stp, \textcolor{keywordtype}{double} *xstep, integer *k,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02631}02631     \textcolor{keywordtype}{double} *cachyt, \textcolor{keywordtype}{double} *sbtime, \textcolor{keywordtype}{double} *lnscht, ftnlen}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02632}02632     task\_len, ftnlen word\_len)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02633}02633 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02634}02634     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02635}02635 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02636}02636 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02637}02637 \textcolor{comment}{    Subroutine prn3lb}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02638}02638 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02639}02639 \textcolor{comment}{    This subroutine prints out information when either a built-\/in}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02640}02640 \textcolor{comment}{      convergence test is satisfied or when an error message is}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02641}02641 \textcolor{comment}{      generated.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02642}02642 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02643}02643 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02644}02644 \textcolor{comment}{                          *  *  *}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02645}02645 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02646}02646 \textcolor{comment}{    NEOS, November 1994. (Latest revision June 1996.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02647}02647 \textcolor{comment}{    Optimization Technology Center.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02648}02648 \textcolor{comment}{    Argonne National Laboratory and Northwestern University.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02649}02649 \textcolor{comment}{    Written by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02650}02650 \textcolor{comment}{                       Ciyou Zhu}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02651}02651 \textcolor{comment}{    in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02652}02652 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02653}02653 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02654}02654 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02655}02655 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02656}02656     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02657}02657     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02658}02658 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02659}02659     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02660}02660     integer i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02661}02661     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02662}02662     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02663}02663 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02664}02664     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02665}02665 \textcolor{comment}{/*     if (s\_cmp(task, "{}ERROR"{}, (ftnlen)5, (ftnlen)5) == 0) \{ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02666}02666     \textcolor{keywordflow}{if} ( IS\_ERROR(*task) ) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02667}02667         \textcolor{keywordflow}{goto} L999;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02668}02668     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02669}02669     \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02670}02670 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02671}02671 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02672}02672         printf(\textcolor{stringliteral}{"{}           * * * \(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02673}02673         printf(\textcolor{stringliteral}{"{}Tit   = total number of iterations\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02674}02674         printf(\textcolor{stringliteral}{"{}Tnf   = total number of function evaluations\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02675}02675         printf(\textcolor{stringliteral}{"{}Tnint = total number of segments explored during Cauchy searches\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02676}02676         printf(\textcolor{stringliteral}{"{}Skip  = number of BFGS updates skipped\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02677}02677         printf(\textcolor{stringliteral}{"{}Nact  = number of active bounds at final generalized Cauchy point\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02678}02678         printf(\textcolor{stringliteral}{"{}Projg = norm of the final projected gradient\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02679}02679         printf(\textcolor{stringliteral}{"{}F     = final function value\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02680}02680         printf(\textcolor{stringliteral}{"{}           * * * \(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02681}02681 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02682}02682         printf(\textcolor{stringliteral}{"{}   N    Tit   Tnf  Tnint  Skip  Nact      Projg        F\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02683}02683         printf(\textcolor{stringliteral}{"{}\%5ld \%5ld \%5ld \%5ld \%5ld \%5ld\(\backslash\)t\%6.2e \%9.5e\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02684}02684                 *n, *iter, *nfgv, *nintol, *nskip, *nact, *sbgnrm, *f );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02685}02685         \textcolor{keywordflow}{if} (*iprint >= 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02686}02686             printf(\textcolor{stringliteral}{"{}X = "{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02687}02687             i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02688}02688             \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02689}02689                 printf(\textcolor{stringliteral}{"{} \%.2e"{}}, x[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02690}02690             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02691}02691             printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02692}02692         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02693}02693         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02694}02694             printf(\textcolor{stringliteral}{"{}F(x) = \%.9e\(\backslash\)n"{}}, *f );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02695}02695         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02696}02696     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02697}02697 L999:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02698}02698     \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02699}02699         printf(\textcolor{stringliteral}{"{}\%ld\(\backslash\)n"{}},*task);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02700}02700         \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02701}02701             \textcolor{keywordflow}{if} (*info == -\/1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02702}02702                 printf(\textcolor{stringliteral}{"{} Matrix in 1st Cholesky factorization in formk is not Pos. Def.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02703}02703             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02704}02704             \textcolor{keywordflow}{if} (*info == -\/2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02705}02705                 printf(\textcolor{stringliteral}{"{} Matrix in 2nd Cholesky factorization in formk is not Pos. Def.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02706}02706             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02707}02707             \textcolor{keywordflow}{if} (*info == -\/3) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02708}02708                 printf(\textcolor{stringliteral}{"{} Matrix in the Cholesky factorization in formt is not Pos. Def.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02709}02709             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02710}02710             \textcolor{keywordflow}{if} (*info == -\/4) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02711}02711                 printf(\textcolor{stringliteral}{"{} Derivative >= 0, backtracking line search impossible.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02712}02712                 printf(\textcolor{stringliteral}{"{}  Previous x, f and g restored.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02713}02713                 printf(\textcolor{stringliteral}{"{} Possible causes: 1 error in function or gradient evaluation;\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02714}02714                 printf(\textcolor{stringliteral}{"{}                  2 rounding errors dominate computation.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02715}02715             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02716}02716             \textcolor{keywordflow}{if} (*info == -\/5) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02717}02717                 printf(\textcolor{stringliteral}{"{} Warning:  more than 10 function and gradient\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02718}02718                 printf(\textcolor{stringliteral}{"{}   evaluations in the last line search.  Termination\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02719}02719                 printf(\textcolor{stringliteral}{"{}   may possibly be caused by a bad search direction.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02720}02720             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02721}02721             \textcolor{keywordflow}{if} (*info == -\/6) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02722}02722                 printf(\textcolor{stringliteral}{"{} Input nbd(\%ld) is invalid\(\backslash\)n"{}}, *k );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02723}02723             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02724}02724             \textcolor{keywordflow}{if} (*info == -\/7) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02725}02725                 printf(\textcolor{stringliteral}{"{} l(\%ld) > u(\%ld). No feasible solution.\(\backslash\)n"{}}, *k, *k );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02726}02726             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02727}02727             \textcolor{keywordflow}{if} (*info == -\/8) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02728}02728                 printf(\textcolor{stringliteral}{"{} The triangular system is singular.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02729}02729             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02730}02730             \textcolor{keywordflow}{if} (*info == -\/9) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02731}02731                 printf(\textcolor{stringliteral}{"{} Line search cannot locate an adequate point after 20 function\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02732}02732                 printf(\textcolor{stringliteral}{"{}  and gradient evaluations.  Previous x, f and g restored.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02733}02733                 printf(\textcolor{stringliteral}{"{} Possible causes: 1 error in function or gradient evaluation;\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02734}02734                 printf(\textcolor{stringliteral}{"{}                  2 rounding error dominate computation.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02735}02735             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02736}02736         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02737}02737 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02738}02738         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02739}02739             printf(\textcolor{stringliteral}{"{}Cauchy                time \%.3e seconds.\(\backslash\)n"{}}, *cachyt );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02740}02740             printf(\textcolor{stringliteral}{"{}Subspace minimization time \%.3e seconds.\(\backslash\)n"{}}, *sbtime );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02741}02741             printf(\textcolor{stringliteral}{"{}Line search           time \%.3e seconds.\(\backslash\)n"{}}, *lnscht );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02742}02742         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02743}02743         printf(\textcolor{stringliteral}{"{} Total User time \%.3e seconds.\(\backslash\)n"{}}, *time );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02744}02744     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02745}02745     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02746}02746 \} \textcolor{comment}{/* prn3lb */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02747}02747 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02748}02748 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02749}02749 \textcolor{keywordtype}{int} Lbfgs::errclb(integer *n, integer *m, \textcolor{keywordtype}{double} *factr,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02750}02750     \textcolor{keywordtype}{double} *l, \textcolor{keywordtype}{double} *u, integer *nbd, integer *task, integer *info,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02751}02751      integer *k, ftnlen task\_len)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02752}02752 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02753}02753     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02754}02754 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02755}02755 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02756}02756 \textcolor{comment}{    Subroutine errclb}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02757}02757 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02758}02758 \textcolor{comment}{    This subroutine checks the validity of the input data.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02759}02759 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02760}02760 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02761}02761 \textcolor{comment}{                          *  *  *}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02762}02762 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02763}02763 \textcolor{comment}{    NEOS, November 1994. (Latest revision June 1996.)}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02764}02764 \textcolor{comment}{    Optimization Technology Center.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02765}02765 \textcolor{comment}{    Argonne National Laboratory and Northwestern University.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02766}02766 \textcolor{comment}{    Written by}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02767}02767 \textcolor{comment}{                       Ciyou Zhu}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02768}02768 \textcolor{comment}{    in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal.}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02769}02769 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02770}02770 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02771}02771 \textcolor{comment}{    ************}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02772}02772 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02773}02773 \textcolor{comment}{/*     Check the input arguments for errors. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02774}02774     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02775}02775     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02776}02776 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02777}02777     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02778}02778     integer i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02779}02779 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02780}02780     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02781}02781     -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02782}02782     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02783}02783     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02784}02784 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02785}02785     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02786}02786     \textcolor{keywordflow}{if} (*n <= 0) *task = ERROR\_N0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02787}02787     \textcolor{keywordflow}{if} (*m <= 0) *task = ERROR\_M0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02788}02788     \textcolor{keywordflow}{if} (*factr < 0.)  *task = ERROR\_FACTR;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02789}02789     \textcolor{comment}{/*     Check the validity of the arrays nbd(i), u(i), and l(i). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02790}02790     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02791}02791     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02792}02792         \textcolor{keywordflow}{if} (nbd[i\_\_] < 0 || nbd[i\_\_] > 3) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02793}02793             \textcolor{comment}{/*   return */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02794}02794             *task = ERROR\_NBD;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02795}02795             *info = -\/6;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02796}02796             *k = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02797}02797         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02798}02798         \textcolor{keywordflow}{if} (nbd[i\_\_] == 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02799}02799             \textcolor{keywordflow}{if} (l[i\_\_] > u[i\_\_]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02800}02800                 \textcolor{comment}{/* return */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02801}02801                 *task = ERROR\_FEAS;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02802}02802                 *info = -\/7;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02803}02803                 *k = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02804}02804             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02805}02805         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02806}02806         \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02807}02807     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02808}02808     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02809}02809 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02810}02810 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02811}02811 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02812}02812 \textcolor{keyword}{static} integer c\_\_11 = 11;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02813}02813 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02814}02814 \textcolor{keywordtype}{int} Lbfgs::active(integer *n, \textcolor{keywordtype}{double} *l, \textcolor{keywordtype}{double} *u,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02815}02815     integer *nbd, \textcolor{keywordtype}{double} *x, integer *iwhere, integer *iprint,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02816}02816     logical *prjctd, logical *cnstnd, logical *boxed)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02817}02817 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02818}02818     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02819}02819     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02820}02820 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02821}02821     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02822}02822     integer i\_\_, nbdd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02823}02823 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02824}02824 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02825}02825 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02826}02826 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02827}02827 \textcolor{comment}{/*     Subroutine active */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02828}02828 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02829}02829 \textcolor{comment}{/*     This subroutine initializes iwhere and projects the initial x to */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02830}02830 \textcolor{comment}{/*       the feasible set if necessary. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02831}02831 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02832}02832 \textcolor{comment}{/*     iwhere is an integer array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02833}02833 \textcolor{comment}{/*       On entry iwhere is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02834}02834 \textcolor{comment}{/*       On exit iwhere(i)=-\/1  if x(i) has no bounds */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02835}02835 \textcolor{comment}{/*                         3   if l(i)=u(i) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02836}02836 \textcolor{comment}{/*                         0   otherwise. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02837}02837 \textcolor{comment}{/*       In cauchy, iwhere is given finer gradations. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02838}02838 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02839}02839 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02840}02840 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02841}02841 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02842}02842 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02843}02843 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02844}02844 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02845}02845 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02846}02846 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02847}02847 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02848}02848 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02849}02849 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02850}02850 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02851}02851 \textcolor{comment}{/*     Initialize nbdd, prjctd, cnstnd and boxed. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02852}02852     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02853}02853     -\/-\/iwhere;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02854}02854     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02855}02855     -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02856}02856     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02857}02857     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02858}02858 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02859}02859     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02860}02860     nbdd = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02861}02861     *prjctd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02862}02862     *cnstnd = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02863}02863     *boxed = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02864}02864 \textcolor{comment}{/*     Project the initial x to the easible set if necessary. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02865}02865     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02866}02866     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02867}02867     \textcolor{keywordflow}{if} (nbd[i\_\_] > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02868}02868         \textcolor{keywordflow}{if} (nbd[i\_\_] <= 2 \&\& x[i\_\_] <= l[i\_\_]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02869}02869         \textcolor{keywordflow}{if} (x[i\_\_] < l[i\_\_]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02870}02870             *prjctd = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02871}02871             x[i\_\_] = l[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02872}02872         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02873}02873         ++nbdd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02874}02874         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (nbd[i\_\_] >= 2 \&\& x[i\_\_] >= u[i\_\_]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02875}02875         \textcolor{keywordflow}{if} (x[i\_\_] > u[i\_\_]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02876}02876             *prjctd = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02877}02877             x[i\_\_] = u[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02878}02878         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02879}02879         ++nbdd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02880}02880         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02881}02881     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02882}02882 \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02883}02883     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02884}02884 \textcolor{comment}{/*     Initialize iwhere and assign values to cnstnd and boxed. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02885}02885     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02886}02886     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02887}02887     \textcolor{keywordflow}{if} (nbd[i\_\_] != 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02888}02888         *boxed = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02889}02889     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02890}02890     \textcolor{keywordflow}{if} (nbd[i\_\_] == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02891}02891 \textcolor{comment}{/*                                this variable is always free */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02892}02892         iwhere[i\_\_] = -\/1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02893}02893 \textcolor{comment}{/*           otherwise set x(i)=mid(x(i), u(i), l(i)). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02894}02894     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02895}02895         *cnstnd = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02896}02896         \textcolor{keywordflow}{if} (nbd[i\_\_] == 2 \&\& u[i\_\_] -\/ l[i\_\_] <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02897}02897 \textcolor{comment}{/*                   this variable is always fixed */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02898}02898         iwhere[i\_\_] = 3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02899}02899         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02900}02900         iwhere[i\_\_] = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02901}02901         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02902}02902     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02903}02903 \textcolor{comment}{/* L20: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02904}02904     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02905}02905     \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02906}02906     \textcolor{keywordflow}{if} (*prjctd) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02907}02907         printf(\textcolor{stringliteral}{"{}The initial X is infeasible. Restart with its projection\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02908}02908     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02909}02909     \textcolor{keywordflow}{if} (! (*cnstnd)) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02910}02910         printf(\textcolor{stringliteral}{"{}This problem is unconstrained\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02911}02911     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02912}02912     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02913}02913     \textcolor{keywordflow}{if} (*iprint > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02914}02914         printf(\textcolor{stringliteral}{"{}At X0, \%ld variables are exactly at the bounds\(\backslash\)n"{}},nbdd);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02915}02915     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02916}02916     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02917}02917 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02918}02918 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02919}02919 \textcolor{keywordtype}{int} Lbfgs::bmv(integer *m, \textcolor{keywordtype}{double} *sy, \textcolor{keywordtype}{double} *wt, integer}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02920}02920     *col, \textcolor{keywordtype}{double} *v, \textcolor{keywordtype}{double} *p, integer *info)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02921}02921 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02922}02922     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02923}02923     integer sy\_dim1, sy\_offset, wt\_dim1, wt\_offset, i\_\_1, i\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02924}02924 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02925}02925     \textcolor{comment}{/* Builtin functions */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02926}02926     \textcolor{keywordtype}{double} sqrt(\textcolor{keywordtype}{double});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02927}02927 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02928}02928     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02929}02929      integer i\_\_, k, i2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02930}02930      \textcolor{keywordtype}{double} sum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02931}02931 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02932}02932 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02933}02933 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02934}02934 \textcolor{comment}{/*     Subroutine bmv */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02935}02935 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02936}02936 \textcolor{comment}{/*     This subroutine computes the product of the 2m x 2m middle matrix */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02937}02937 \textcolor{comment}{/*       in the compact L-\/BFGS formula of B and a 2m vector v; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02938}02938 \textcolor{comment}{/*       it returns the product in p. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02939}02939 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02940}02940 \textcolor{comment}{/*     m is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02941}02941 \textcolor{comment}{/*       On entry m is the maximum number of variable metric corrections */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02942}02942 \textcolor{comment}{/*         used to define the limited memory matrix. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02943}02943 \textcolor{comment}{/*       On exit m is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02944}02944 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02945}02945 \textcolor{comment}{/*     sy is a double precision array of dimension m x m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02946}02946 \textcolor{comment}{/*       On entry sy specifies the matrix S'Y. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02947}02947 \textcolor{comment}{/*       On exit sy is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02948}02948 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02949}02949 \textcolor{comment}{/*     wt is a double precision array of dimension m x m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02950}02950 \textcolor{comment}{/*       On entry wt specifies the upper triangular matrix J' which is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02951}02951 \textcolor{comment}{/*         the Cholesky factor of (thetaS'S+LD\string^(-\/1)L'). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02952}02952 \textcolor{comment}{/*       On exit wt is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02953}02953 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02954}02954 \textcolor{comment}{/*     col is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02955}02955 \textcolor{comment}{/*       On entry col specifies the number of s-\/vectors (or y-\/vectors) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02956}02956 \textcolor{comment}{/*         stored in the compact L-\/BFGS formula. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02957}02957 \textcolor{comment}{/*       On exit col is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02958}02958 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02959}02959 \textcolor{comment}{/*     v is a double precision array of dimension 2col. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02960}02960 \textcolor{comment}{/*       On entry v specifies vector v. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02961}02961 \textcolor{comment}{/*       On exit v is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02962}02962 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02963}02963 \textcolor{comment}{/*     p is a double precision array of dimension 2col. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02964}02964 \textcolor{comment}{/*       On entry p is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02965}02965 \textcolor{comment}{/*       On exit p is the product Mv. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02966}02966 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02967}02967 \textcolor{comment}{/*     info is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02968}02968 \textcolor{comment}{/*       On entry info is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02969}02969 \textcolor{comment}{/*       On exit info = 0       for normal return, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02970}02970 \textcolor{comment}{/*                    = nonzero for abnormal return when the system */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02971}02971 \textcolor{comment}{/*                                to be solved by dtrsl is singular. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02972}02972 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02973}02973 \textcolor{comment}{/*     Subprograms called: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02974}02974 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02975}02975 \textcolor{comment}{/*       Linpack ... dtrsl. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02976}02976 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02977}02977 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02978}02978 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02979}02979 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02980}02980 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02981}02981 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02982}02982 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02983}02983 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02984}02984 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02985}02985 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02986}02986 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02987}02987 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02988}02988 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02989}02989     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02990}02990     wt\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02991}02991     wt\_offset = 1 + wt\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02992}02992     wt -\/= wt\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02993}02993     sy\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02994}02994     sy\_offset = 1 + sy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02995}02995     sy -\/= sy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02996}02996     -\/-\/p;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02997}02997     -\/-\/v;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02998}02998 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l02999}02999     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03000}03000     \textcolor{keywordflow}{if} (*col == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03001}03001     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03002}03002     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03003}03003 \textcolor{comment}{/*     PART I: solve [  D\string^(1/2)      O ] [ p1 ] = [ v1 ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03004}03004 \textcolor{comment}{/*                   [ -\/L*D\string^(-\/1/2)   J ] [ p2 ]   [ v2 ]. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03005}03005 \textcolor{comment}{/*       solve Jp2=v2+LD\string^(-\/1)v1. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03006}03006     p[*col + 1] = v[*col + 1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03007}03007     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03008}03008     \textcolor{keywordflow}{for} (i\_\_ = 2; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03009}03009     i2 = *col + i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03010}03010     sum = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03011}03011     i\_\_2 = i\_\_ -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03012}03012     \textcolor{keywordflow}{for} (k = 1; k <= i\_\_2; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03013}03013         sum += sy[i\_\_ + k * sy\_dim1] * v[k] / sy[k + k * sy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03014}03014 \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03015}03015     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03016}03016     p[i2] = v[i2] + sum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03017}03017 \textcolor{comment}{/* L20: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03018}03018     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03019}03019 \textcolor{comment}{/*     Solve the triangular system */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03020}03020     dtrsl(\&wt[wt\_offset], m, col, \&p[*col + 1], \&c\_\_11, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03021}03021     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03022}03022     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03023}03023     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03024}03024 \textcolor{comment}{/*       solve D\string^(1/2)p1=v1. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03025}03025     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03026}03026     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03027}03027     p[i\_\_] = v[i\_\_] / sqrt(sy[i\_\_ + i\_\_ * sy\_dim1]);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03028}03028 \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03029}03029     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03030}03030 \textcolor{comment}{/*     PART II: solve [ -\/D\string^(1/2)   D\string^(-\/1/2)*L'  ] [ p1 ] = [ p1 ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03031}03031 \textcolor{comment}{/*                    [  0         J'           ] [ p2 ]   [ p2 ]. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03032}03032 \textcolor{comment}{/*       solve J\string^Tp2=p2. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03033}03033     dtrsl(\&wt[wt\_offset], m, col, \&p[*col + 1], \&c\_\_1, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03034}03034     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03035}03035     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03036}03036     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03037}03037 \textcolor{comment}{/*       compute p1=-\/D\string^(-\/1/2)(p1-\/D\string^(-\/1/2)L'p2) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03038}03038 \textcolor{comment}{/*                 =-\/D\string^(-\/1/2)p1+D\string^(-\/1)L'p2. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03039}03039     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03040}03040     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03041}03041     p[i\_\_] = -\/p[i\_\_] / sqrt(sy[i\_\_ + i\_\_ * sy\_dim1]);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03042}03042 \textcolor{comment}{/* L40: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03043}03043     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03044}03044     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03045}03045     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03046}03046     sum = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03047}03047     i\_\_2 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03048}03048     \textcolor{keywordflow}{for} (k = i\_\_ + 1; k <= i\_\_2; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03049}03049         sum += sy[k + i\_\_ * sy\_dim1] * p[*col + k] / sy[i\_\_ + i\_\_ *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03050}03050             sy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03051}03051 \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03052}03052     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03053}03053     p[i\_\_] += sum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03054}03054 \textcolor{comment}{/* L60: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03055}03055     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03056}03056     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03057}03057 \} \textcolor{comment}{/* bmv */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03058}03058 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03059}03059 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03060}03060 \textcolor{keywordtype}{int} Lbfgs::cauchy(integer *n, \textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{double} *l,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03061}03061     \textcolor{keywordtype}{double} *u, integer *nbd, \textcolor{keywordtype}{double} *g, integer *iorder, integer *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03062}03062     iwhere, \textcolor{keywordtype}{double} *t, \textcolor{keywordtype}{double} *d\_\_, \textcolor{keywordtype}{double} *xcp, integer *m,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03063}03063     \textcolor{keywordtype}{double} *wy, \textcolor{keywordtype}{double} *ws, \textcolor{keywordtype}{double} *sy, \textcolor{keywordtype}{double} *wt,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03064}03064     \textcolor{keywordtype}{double} *theta, integer *col, integer *head, \textcolor{keywordtype}{double} *p,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03065}03065     \textcolor{keywordtype}{double} *c\_\_, \textcolor{keywordtype}{double} *wbp, \textcolor{keywordtype}{double} *v, integer *nseg,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03066}03066     integer *iprint, \textcolor{keywordtype}{double} *sbgnrm, integer *info, \textcolor{keywordtype}{double} *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03067}03067     epsmch)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03068}03068 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03069}03069 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03070}03070     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03071}03071     integer wy\_dim1, wy\_offset, ws\_dim1, ws\_offset, sy\_dim1, sy\_offset,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03072}03072         wt\_dim1, wt\_offset, i\_\_1, i\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03073}03073     \textcolor{keywordtype}{double} d\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03074}03074 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03075}03075 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03076}03076     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03077}03077      integer i\_\_, j;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03078}03078      \textcolor{keywordtype}{double} f1, f2, dt, tj, tl, tu, tj0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03079}03079      integer ibp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03080}03080      \textcolor{keywordtype}{double} dtm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03081}03081    \textcolor{keywordtype}{double} wmc, wmp, wmw;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03082}03082    integer col2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03083}03083    \textcolor{keywordtype}{double} dibp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03084}03084     integer iter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03085}03085     \textcolor{keywordtype}{double} zibp, tsum, dibp2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03086}03086     logical bnded;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03087}03087     \textcolor{keywordtype}{double} neggi;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03088}03088     integer nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03089}03089     \textcolor{keywordtype}{double} bkmin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03090}03090     integer nleft;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03091}03091     \textcolor{keywordtype}{double} f2\_org\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03092}03092     integer nbreak, ibkmin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03093}03093     integer pointr;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03094}03094     logical xlower, xupper;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03095}03095 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03096}03096 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03097}03097 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03098}03098 \textcolor{comment}{/*     Subroutine cauchy */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03099}03099 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03100}03100 \textcolor{comment}{/*     For given x, l, u, g (with sbgnrm > 0), and a limited memory */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03101}03101 \textcolor{comment}{/*       BFGS matrix B defined in terms of matrices WY, WS, WT, and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03102}03102 \textcolor{comment}{/*       scalars head, col, and theta, this subroutine computes the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03103}03103 \textcolor{comment}{/*       generalized Cauchy point (GCP), defined as the first local */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03104}03104 \textcolor{comment}{/*       minimizer of the quadratic */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03105}03105 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03106}03106 \textcolor{comment}{/*                  Q(x + s) = g's + 1/2 s'Bs */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03107}03107 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03108}03108 \textcolor{comment}{/*       along the projected gradient direction P(x-\/tg,l,u). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03109}03109 \textcolor{comment}{/*       The routine returns the GCP in xcp. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03110}03110 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03111}03111 \textcolor{comment}{/*     n is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03112}03112 \textcolor{comment}{/*       On entry n is the dimension of the problem. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03113}03113 \textcolor{comment}{/*       On exit n is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03114}03114 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03115}03115 \textcolor{comment}{/*     x is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03116}03116 \textcolor{comment}{/*       On entry x is the starting point for the GCP computation. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03117}03117 \textcolor{comment}{/*       On exit x is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03118}03118 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03119}03119 \textcolor{comment}{/*     l is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03120}03120 \textcolor{comment}{/*       On entry l is the lower bound of x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03121}03121 \textcolor{comment}{/*       On exit l is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03122}03122 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03123}03123 \textcolor{comment}{/*     u is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03124}03124 \textcolor{comment}{/*       On entry u is the upper bound of x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03125}03125 \textcolor{comment}{/*       On exit u is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03126}03126 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03127}03127 \textcolor{comment}{/*     nbd is an integer array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03128}03128 \textcolor{comment}{/*       On entry nbd represents the type of bounds imposed on the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03129}03129 \textcolor{comment}{/*         variables, and must be specified as follows: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03130}03130 \textcolor{comment}{/*         nbd(i)=0 if x(i) is unbounded, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03131}03131 \textcolor{comment}{/*                1 if x(i) has only a lower bound, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03132}03132 \textcolor{comment}{/*                2 if x(i) has both lower and upper bounds, and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03133}03133 \textcolor{comment}{/*                3 if x(i) has only an upper bound. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03134}03134 \textcolor{comment}{/*       On exit nbd is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03135}03135 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03136}03136 \textcolor{comment}{/*     g is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03137}03137 \textcolor{comment}{/*       On entry g is the gradient of f(x).  g must be a nonzero vector. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03138}03138 \textcolor{comment}{/*       On exit g is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03139}03139 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03140}03140 \textcolor{comment}{/*     iorder is an integer working array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03141}03141 \textcolor{comment}{/*       iorder will be used to store the breakpoints in the piecewise */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03142}03142 \textcolor{comment}{/*       linear path and free variables encountered. On exit, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03143}03143 \textcolor{comment}{/*         iorder(1),...,iorder(nleft) are indices of breakpoints */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03144}03144 \textcolor{comment}{/*                                which have not been encountered; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03145}03145 \textcolor{comment}{/*         iorder(nleft+1),...,iorder(nbreak) are indices of */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03146}03146 \textcolor{comment}{/*                                     encountered breakpoints; and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03147}03147 \textcolor{comment}{/*         iorder(nfree),...,iorder(n) are indices of variables which */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03148}03148 \textcolor{comment}{/*                 have no bound constraits along the search direction. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03149}03149 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03150}03150 \textcolor{comment}{/*     iwhere is an integer array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03151}03151 \textcolor{comment}{/*       On entry iwhere indicates only the permanently fixed (iwhere=3) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03152}03152 \textcolor{comment}{/*       or free (iwhere= -\/1) components of x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03153}03153 \textcolor{comment}{/*       On exit iwhere records the status of the current x variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03154}03154 \textcolor{comment}{/*       iwhere(i)=-\/3  if x(i) is free and has bounds, but is not moved */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03155}03155 \textcolor{comment}{/*                 0   if x(i) is free and has bounds, and is moved */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03156}03156 \textcolor{comment}{/*                 1   if x(i) is fixed at l(i), and l(i) .ne. u(i) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03157}03157 \textcolor{comment}{/*                 2   if x(i) is fixed at u(i), and u(i) .ne. l(i) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03158}03158 \textcolor{comment}{/*                 3   if x(i) is always fixed, i.e.,  u(i)=x(i)=l(i) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03159}03159 \textcolor{comment}{/*                 -\/1  if x(i) is always free, i.e., it has no bounds. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03160}03160 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03161}03161 \textcolor{comment}{/*     t is a double precision working array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03162}03162 \textcolor{comment}{/*       t will be used to store the break points. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03163}03163 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03164}03164 \textcolor{comment}{/*     d is a double precision array of dimension n used to store */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03165}03165 \textcolor{comment}{/*       the Cauchy direction P(x-\/tg)-\/x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03166}03166 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03167}03167 \textcolor{comment}{/*     xcp is a double precision array of dimension n used to return the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03168}03168 \textcolor{comment}{/*       GCP on exit. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03169}03169 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03170}03170 \textcolor{comment}{/*     m is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03171}03171 \textcolor{comment}{/*       On entry m is the maximum number of variable metric corrections */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03172}03172 \textcolor{comment}{/*         used to define the limited memory matrix. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03173}03173 \textcolor{comment}{/*       On exit m is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03174}03174 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03175}03175 \textcolor{comment}{/*     ws, wy, sy, and wt are double precision arrays. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03176}03176 \textcolor{comment}{/*       On entry they store information that defines the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03177}03177 \textcolor{comment}{/*                             limited memory BFGS matrix: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03178}03178 \textcolor{comment}{/*         ws(n,m) stores S, a set of s-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03179}03179 \textcolor{comment}{/*         wy(n,m) stores Y, a set of y-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03180}03180 \textcolor{comment}{/*         sy(m,m) stores S'Y; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03181}03181 \textcolor{comment}{/*         wt(m,m) stores the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03182}03182 \textcolor{comment}{/*                 Cholesky factorization of (theta*S'S+LD\string^(-\/1)L'). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03183}03183 \textcolor{comment}{/*       On exit these arrays are unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03184}03184 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03185}03185 \textcolor{comment}{/*     theta is a double precision variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03186}03186 \textcolor{comment}{/*       On entry theta is the scaling factor specifying B\_0 = theta I. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03187}03187 \textcolor{comment}{/*       On exit theta is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03188}03188 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03189}03189 \textcolor{comment}{/*     col is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03190}03190 \textcolor{comment}{/*       On entry col is the actual number of variable metric */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03191}03191 \textcolor{comment}{/*         corrections stored so far. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03192}03192 \textcolor{comment}{/*       On exit col is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03193}03193 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03194}03194 \textcolor{comment}{/*     head is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03195}03195 \textcolor{comment}{/*       On entry head is the location of the first s-\/vector (or y-\/vector) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03196}03196 \textcolor{comment}{/*         in S (or Y). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03197}03197 \textcolor{comment}{/*       On exit col is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03198}03198 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03199}03199 \textcolor{comment}{/*     p is a double precision working array of dimension 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03200}03200 \textcolor{comment}{/*       p will be used to store the vector p = W\string^(T)d. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03201}03201 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03202}03202 \textcolor{comment}{/*     c is a double precision working array of dimension 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03203}03203 \textcolor{comment}{/*       c will be used to store the vector c = W\string^(T)(xcp-\/x). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03204}03204 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03205}03205 \textcolor{comment}{/*     wbp is a double precision working array of dimension 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03206}03206 \textcolor{comment}{/*       wbp will be used to store the row of W corresponding */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03207}03207 \textcolor{comment}{/*         to a breakpoint. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03208}03208 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03209}03209 \textcolor{comment}{/*     v is a double precision working array of dimension 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03210}03210 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03211}03211 \textcolor{comment}{/*     nseg is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03212}03212 \textcolor{comment}{/*       On exit nseg records the number of quadratic segments explored */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03213}03213 \textcolor{comment}{/*         in searching for the GCP. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03214}03214 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03215}03215 \textcolor{comment}{/*     sg and yg are double precision arrays of dimension m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03216}03216 \textcolor{comment}{/*       On entry sg  and yg store S'g and Y'g correspondingly. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03217}03217 \textcolor{comment}{/*       On exit they are unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03218}03218 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03219}03219 \textcolor{comment}{/*     iprint is an INTEGER variable that must be set by the user. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03220}03220 \textcolor{comment}{/*       It controls the frequency and type of output generated: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03221}03221 \textcolor{comment}{/*        iprint<0    no output is generated; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03222}03222 \textcolor{comment}{/*        iprint=0    print only one line at the last iteration; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03223}03223 \textcolor{comment}{/*        0<iprint<99 print also f and |proj g| every iprint iterations; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03224}03224 \textcolor{comment}{/*        iprint=99   print details of every iteration except n-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03225}03225 \textcolor{comment}{/*        iprint=100  print also the changes of active set and final x; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03226}03226 \textcolor{comment}{/*        iprint>100  print details of every iteration including x and g; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03227}03227 \textcolor{comment}{/*       When iprint > 0, the file iterate.dat will be created to */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03228}03228 \textcolor{comment}{/*                        summarize the iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03229}03229 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03230}03230 \textcolor{comment}{/*     sbgnrm is a double precision variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03231}03231 \textcolor{comment}{/*       On entry sbgnrm is the norm of the projected gradient at x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03232}03232 \textcolor{comment}{/*       On exit sbgnrm is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03233}03233 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03234}03234 \textcolor{comment}{/*     info is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03235}03235 \textcolor{comment}{/*       On entry info is 0. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03236}03236 \textcolor{comment}{/*       On exit info = 0       for normal return, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03237}03237 \textcolor{comment}{/*                    = nonzero for abnormal return when the the system */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03238}03238 \textcolor{comment}{/*                              used in routine bmv is singular. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03239}03239 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03240}03240 \textcolor{comment}{/*     Subprograms called: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03241}03241 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03242}03242 \textcolor{comment}{/*       L-\/BFGS-\/B Library ... hpsolb, bmv. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03243}03243 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03244}03244 \textcolor{comment}{/*       Linpack ... dscal dcopy, daxpy. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03245}03245 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03246}03246 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03247}03247 \textcolor{comment}{/*     References: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03248}03248 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03249}03249 \textcolor{comment}{/*       [1] R. H. Byrd, P. Lu, J. Nocedal and C. Zhu, ``A limited */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03250}03250 \textcolor{comment}{/*       memory algorithm for bound constrained optimization'', */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03251}03251 \textcolor{comment}{/*       SIAM J. Scientific Computing 16 (1995), no. 5, pp. 1190-\/-\/1208. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03252}03252 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03253}03253 \textcolor{comment}{/*       [2] C. Zhu, R.H. Byrd, P. Lu, J. Nocedal, ``L-\/BFGS-\/B: FORTRAN */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03254}03254 \textcolor{comment}{/*       Subroutines for Large Scale Bound Constrained Optimization'' */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03255}03255 \textcolor{comment}{/*       Tech. Report, NAM-\/11, EECS Department, Northwestern University, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03256}03256 \textcolor{comment}{/*       1994. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03257}03257 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03258}03258 \textcolor{comment}{/*       (Postscript files of these papers are available via anonymous */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03259}03259 \textcolor{comment}{/*        ftp to eecs.nwu.edu in the directory pub/lbfgs/lbfgs\_bcm.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03260}03260 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03261}03261 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03262}03262 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03263}03263 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03264}03264 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03265}03265 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03266}03266 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03267}03267 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03268}03268 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03269}03269 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03270}03270 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03271}03271 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03272}03272 \textcolor{comment}{/*     Check the status of the variables, reset iwhere(i) if necessary; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03273}03273 \textcolor{comment}{/*       compute the Cauchy direction d and the breakpoints t; initialize */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03274}03274 \textcolor{comment}{/*       the derivative f1 and the vector p = W'd (for theta = 1). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03275}03275     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03276}03276     -\/-\/xcp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03277}03277     -\/-\/d\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03278}03278     -\/-\/t;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03279}03279     -\/-\/iwhere;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03280}03280     -\/-\/iorder;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03281}03281     -\/-\/g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03282}03282     -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03283}03283     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03284}03284     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03285}03285     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03286}03286     -\/-\/v;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03287}03287     -\/-\/wbp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03288}03288     -\/-\/c\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03289}03289     -\/-\/p;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03290}03290     wt\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03291}03291     wt\_offset = 1 + wt\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03292}03292     wt -\/= wt\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03293}03293     sy\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03294}03294     sy\_offset = 1 + sy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03295}03295     sy -\/= sy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03296}03296     ws\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03297}03297     ws\_offset = 1 + ws\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03298}03298     ws -\/= ws\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03299}03299     wy\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03300}03300     wy\_offset = 1 + wy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03301}03301     wy -\/= wy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03302}03302 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03303}03303     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03304}03304     \textcolor{keywordflow}{if} (*sbgnrm <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03305}03305         \textcolor{keywordflow}{if} (*iprint >= 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03306}03306             printf(\textcolor{stringliteral}{"{}Subnorm = 0. GCP = X.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03307}03307         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03308}03308         dcopy(n, \&x[1], \&c\_\_1, \&xcp[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03309}03309         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03310}03310     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03311}03311     bnded = TRUE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03312}03312     nfree = *n + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03313}03313     nbreak = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03314}03314     ibkmin = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03315}03315     bkmin = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03316}03316     col2 = *col << 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03317}03317     f1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03318}03318     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03319}03319         printf(\textcolor{stringliteral}{"{}CAUCHY entered\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03320}03320     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03321}03321 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03322}03322     \textcolor{comment}{/*     We set p to zero and build it up as we determine d. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03323}03323     i\_\_1 = col2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03324}03324     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03325}03325         p[i\_\_] = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03326}03326         \textcolor{comment}{/* L20: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03327}03327     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03328}03328     \textcolor{comment}{/*     In the following loop we determine for each variable its bound */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03329}03329     \textcolor{comment}{/*        status and its breakpoint, and update p accordingly. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03330}03330     \textcolor{comment}{/*        Smallest breakpoint is identified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03331}03331     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03332}03332     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03333}03333         neggi = -\/g[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03334}03334         \textcolor{keywordflow}{if} (iwhere[i\_\_] != 3 \&\& iwhere[i\_\_] != -\/1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03335}03335             \textcolor{comment}{/*             if x(i) is not a constant and has bounds, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03336}03336             \textcolor{comment}{/*             compute the difference between x(i) and its bounds. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03337}03337             \textcolor{keywordflow}{if} (nbd[i\_\_] <= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03338}03338                 tl = x[i\_\_] -\/ l[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03339}03339             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03340}03340             \textcolor{keywordflow}{if} (nbd[i\_\_] >= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03341}03341                 tu = u[i\_\_] -\/ x[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03342}03342             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03343}03343             \textcolor{comment}{/*           If a variable is close enough to a bound */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03344}03344             \textcolor{comment}{/*             we treat it as at bound. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03345}03345             xlower = nbd[i\_\_] <= 2 \&\& tl <= 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03346}03346             xupper = nbd[i\_\_] >= 2 \&\& tu <= 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03347}03347             \textcolor{comment}{/*              reset iwhere(i). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03348}03348             iwhere[i\_\_] = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03349}03349             \textcolor{keywordflow}{if} (xlower) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03350}03350                 \textcolor{keywordflow}{if} (neggi <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03351}03351                     iwhere[i\_\_] = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03352}03352                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03353}03353             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (xupper) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03354}03354                 \textcolor{keywordflow}{if} (neggi >= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03355}03355                     iwhere[i\_\_] = 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03356}03356                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03357}03357             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03358}03358                 \textcolor{keywordflow}{if} (fabs(neggi) <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03359}03359                     iwhere[i\_\_] = -\/3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03360}03360                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03361}03361             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03362}03362         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03363}03363         pointr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03364}03364         \textcolor{keywordflow}{if} (iwhere[i\_\_] != 0 \&\& iwhere[i\_\_] != -\/1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03365}03365             d\_\_[i\_\_] = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03366}03366         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03367}03367             d\_\_[i\_\_] = neggi;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03368}03368             f1 -\/= neggi * neggi;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03369}03369             \textcolor{comment}{/*             calculate p := p -\/ W'e\_i* (g\_i). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03370}03370             i\_\_2 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03371}03371             \textcolor{keywordflow}{for} (j = 1; j <= i\_\_2; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03372}03372                 p[j] += wy[i\_\_ + pointr * wy\_dim1] * neggi;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03373}03373                 p[*col + j] += ws[i\_\_ + pointr * ws\_dim1] * neggi;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03374}03374                 pointr = pointr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03375}03375                 \textcolor{comment}{/* L40: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03376}03376             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03377}03377             \textcolor{keywordflow}{if} (nbd[i\_\_] <= 2 \&\& nbd[i\_\_] != 0 \&\& neggi < 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03378}03378                 \textcolor{comment}{/*                                 x(i) + d(i) is bounded; compute t(i). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03379}03379                 ++nbreak;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03380}03380                 iorder[nbreak] = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03381}03381                 t[nbreak] = tl / (-\/neggi);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03382}03382                 \textcolor{keywordflow}{if} (nbreak == 1 || t[nbreak] < bkmin) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03383}03383                     bkmin = t[nbreak];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03384}03384                     ibkmin = nbreak;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03385}03385                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03386}03386             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (nbd[i\_\_] >= 2 \&\& neggi > 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03387}03387                 \textcolor{comment}{/*                                 x(i) + d(i) is bounded; compute t(i). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03388}03388                 ++nbreak;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03389}03389                 iorder[nbreak] = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03390}03390                 t[nbreak] = tu / neggi;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03391}03391                 \textcolor{keywordflow}{if} (nbreak == 1 || t[nbreak] < bkmin) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03392}03392                     bkmin = t[nbreak];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03393}03393                     ibkmin = nbreak;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03394}03394                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03395}03395             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03396}03396                 \textcolor{comment}{/*                x(i) + d(i) is not bounded. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03397}03397                 -\/-\/nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03398}03398                 iorder[nfree] = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03399}03399                 \textcolor{keywordflow}{if} (fabs(neggi) > 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03400}03400                     bnded = FALSE\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03401}03401                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03402}03402             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03403}03403         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03404}03404         \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03405}03405     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03406}03406     \textcolor{comment}{/*     The indices of the nonzero components of d are now stored */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03407}03407     \textcolor{comment}{/*       in iorder(1),...,iorder(nbreak) and iorder(nfree),...,iorder(n). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03408}03408     \textcolor{comment}{/*       The smallest of the nbreak breakpoints is in t(ibkmin)=bkmin. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03409}03409     \textcolor{keywordflow}{if} (*theta != 1.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03410}03410         \textcolor{comment}{/*                   complete the initialization of p for theta not= one. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03411}03411         dscal(col, theta, \&p[*col + 1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03412}03412     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03413}03413     \textcolor{comment}{/*     Initialize GCP xcp = x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03414}03414     dcopy(n, \&x[1], \&c\_\_1, \&xcp[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03415}03415     \textcolor{keywordflow}{if} (nbreak == 0 \&\& nfree == *n + 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03416}03416         \textcolor{comment}{/*                  is a zero vector, return with the initial xcp as GCP. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03417}03417         \textcolor{keywordflow}{if} (*iprint > 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03418}03418             printf(\textcolor{stringliteral}{"{}Cauchy X = "{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03419}03419             i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03420}03420             \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03421}03421                 printf(\textcolor{stringliteral}{"{}\%5.2e "{}}, xcp[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03422}03422             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03423}03423             printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03424}03424         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03425}03425         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03426}03426     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03427}03427     \textcolor{comment}{/*     Initialize c = W'(xcp -\/ x) = 0. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03428}03428     i\_\_1 = col2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03429}03429     \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03430}03430         c\_\_[j] = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03431}03431         \textcolor{comment}{/* L60: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03432}03432     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03433}03433     \textcolor{comment}{/*     Initialize derivative f2. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03434}03434     f2 = -\/(*theta) * f1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03435}03435     f2\_org\_\_ = f2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03436}03436     \textcolor{keywordflow}{if} (*col > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03437}03437         bmv(m, \&sy[sy\_offset], \&wt[wt\_offset], col, \&p[1], \&v[1], info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03438}03438         \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03439}03439             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03440}03440         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03441}03441         f2 -\/= ddot(\&col2, \&v[1], \&c\_\_1, \&p[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03442}03442     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03443}03443     dtm = -\/f1 / f2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03444}03444     tsum = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03445}03445     *nseg = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03446}03446     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03447}03447         printf(\textcolor{stringliteral}{"{}There are \%ld breakpoints\(\backslash\)n"{}}, nbreak );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03448}03448     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03449}03449     \textcolor{comment}{/*     If there are no breakpoints, locate the GCP and return. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03450}03450     \textcolor{keywordflow}{if} (nbreak == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03451}03451         \textcolor{keywordflow}{goto} L888;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03452}03452     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03453}03453     nleft = nbreak;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03454}03454     iter = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03455}03455     tj = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03456}03456     \textcolor{comment}{/* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ the beginning of the loop -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03457}03457 L777:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03458}03458     \textcolor{comment}{/*     Find the next smallest breakpoint; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03459}03459     \textcolor{comment}{/*       compute dt = t(nleft) -\/ t(nleft + 1). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03460}03460     tj0 = tj;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03461}03461     \textcolor{keywordflow}{if} (iter == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03462}03462         \textcolor{comment}{/*         Since we already have the smallest breakpoint we need not do */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03463}03463         \textcolor{comment}{/*         heapsort yet. Often only one breakpoint is used and the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03464}03464         \textcolor{comment}{/*         cost of heapsort is avoided. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03465}03465         tj = bkmin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03466}03466         ibp = iorder[ibkmin];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03467}03467     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03468}03468         \textcolor{keywordflow}{if} (iter == 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03469}03469             \textcolor{comment}{/*             Replace the already used smallest breakpoint with the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03470}03470             \textcolor{comment}{/*             breakpoint numbered nbreak > nlast, before heapsort call. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03471}03471             \textcolor{keywordflow}{if} (ibkmin != nbreak) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03472}03472                 t[ibkmin] = t[nbreak];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03473}03473                 iorder[ibkmin] = iorder[nbreak];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03474}03474             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03475}03475             \textcolor{comment}{/*        Update heap structure of breakpoints */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03476}03476             \textcolor{comment}{/*           (if iter=2, initialize heap). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03477}03477         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03478}03478         i\_\_1 = iter -\/ 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03479}03479         hpsolb(\&nleft, \&t[1], \&iorder[1], \&i\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03480}03480         tj = t[nleft];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03481}03481         ibp = iorder[nleft];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03482}03482     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03483}03483     dt = tj -\/ tj0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03484}03484     \textcolor{keywordflow}{if} (dt != 0. \&\& *iprint >= 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03485}03485         printf(\textcolor{stringliteral}{"{}Piece \%ld -\/-\/f1, f2 at start point \%.2e \%.2e\(\backslash\)n"{}}, *nseg, f1, f2 );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03486}03486         printf(\textcolor{stringliteral}{"{}Distance to the next break point = \%.2e\(\backslash\)n"{}}, dt );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03487}03487         printf(\textcolor{stringliteral}{"{}Distance to the stationary point = \%.2e\(\backslash\)n"{}}, dtm );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03488}03488     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03489}03489     \textcolor{comment}{/*     If a minimizer is within this interval, locate the GCP and return. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03490}03490     \textcolor{keywordflow}{if} (dtm < dt) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03491}03491         \textcolor{keywordflow}{goto} L888;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03492}03492     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03493}03493     \textcolor{comment}{/*     Otherwise fix one variable and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03494}03494     \textcolor{comment}{/*       reset the corresponding component of d to zero. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03495}03495     tsum += dt;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03496}03496     -\/-\/nleft;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03497}03497     ++iter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03498}03498     dibp = d\_\_[ibp];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03499}03499     d\_\_[ibp] = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03500}03500     \textcolor{keywordflow}{if} (dibp > 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03501}03501         zibp = u[ibp] -\/ x[ibp];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03502}03502         xcp[ibp] = u[ibp];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03503}03503         iwhere[ibp] = 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03504}03504     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03505}03505         zibp = l[ibp] -\/ x[ibp];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03506}03506         xcp[ibp] = l[ibp];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03507}03507         iwhere[ibp] = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03508}03508     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03509}03509     \textcolor{keywordflow}{if} (*iprint >= 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03510}03510         printf(\textcolor{stringliteral}{"{}Variable \%ld is fixed\(\backslash\)n"{}}, ibp );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03511}03511     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03512}03512     \textcolor{keywordflow}{if} (nleft == 0 \&\& nbreak == *n) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03513}03513         \textcolor{comment}{/*                                             all n variables are fixed, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03514}03514         \textcolor{comment}{/*                                                return with xcp as GCP. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03515}03515         dtm = dt;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03516}03516         \textcolor{keywordflow}{goto} L999;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03517}03517     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03518}03518     \textcolor{comment}{/*     Update the derivative information. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03519}03519     ++(*nseg);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03520}03520     \textcolor{comment}{/* Computing 2nd power */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03521}03521     d\_\_1 = dibp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03522}03522     dibp2 = d\_\_1 * d\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03523}03523     \textcolor{comment}{/*     Update f1 and f2. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03524}03524     \textcolor{comment}{/*        temporarily set f1 and f2 for col=0. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03525}03525     f1 = f1 + dt * f2 + dibp2 -\/ *theta * dibp * zibp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03526}03526     f2 -\/= *theta * dibp2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03527}03527     \textcolor{keywordflow}{if} (*col > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03528}03528         \textcolor{comment}{/*                          update c = c + dt*p. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03529}03529         daxpy(\&col2, \&dt, \&p[1], \&c\_\_1, \&c\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03530}03530         \textcolor{comment}{/*           choose wbp, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03531}03531         \textcolor{comment}{/*           the row of W corresponding to the breakpoint encountered. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03532}03532         pointr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03533}03533         i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03534}03534         \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03535}03535             wbp[j] = wy[ibp + pointr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03536}03536             wbp[*col + j] = *theta * ws[ibp + pointr * ws\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03537}03537             pointr = pointr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03538}03538             \textcolor{comment}{/* L70: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03539}03539         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03540}03540         \textcolor{comment}{/*           compute (wbp)Mc, (wbp)Mp, and (wbp)M(wbp)'. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03541}03541         bmv(m, \&sy[sy\_offset], \&wt[wt\_offset], col, \&wbp[1], \&v[1], info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03542}03542         \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03543}03543             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03544}03544         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03545}03545         wmc = ddot(\&col2, \&c\_\_[1], \&c\_\_1, \&v[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03546}03546         wmp = ddot(\&col2, \&p[1], \&c\_\_1, \&v[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03547}03547         wmw = ddot(\&col2, \&wbp[1], \&c\_\_1, \&v[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03548}03548         \textcolor{comment}{/*           update p = p -\/ dibp*wbp. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03549}03549         d\_\_1 = -\/dibp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03550}03550         daxpy(\&col2, \&d\_\_1, \&wbp[1], \&c\_\_1, \&p[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03551}03551         \textcolor{comment}{/*           complete updating f1 and f2 while col > 0. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03552}03552         f1 += dibp * wmc;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03553}03553         f2 = f2 + dibp * 2. * wmp -\/ dibp2 * wmw;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03554}03554     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03555}03555     \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03556}03556     d\_\_1 = *epsmch * f2\_org\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03557}03557     f2 = fmax(d\_\_1,f2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03558}03558     \textcolor{keywordflow}{if} (nleft > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03559}03559         dtm = -\/f1 / f2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03560}03560         \textcolor{keywordflow}{goto} L777;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03561}03561         \textcolor{comment}{/*                 to repeat the loop for unsearched intervals. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03562}03562     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bnded) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03563}03563         f1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03564}03564         f2 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03565}03565         dtm = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03566}03566     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03567}03567         dtm = -\/f1 / f2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03568}03568     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03569}03569     \textcolor{comment}{/* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ the end of the loop -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03570}03570 L888:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03571}03571     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03572}03572         printf(\textcolor{stringliteral}{"{}\(\backslash\)nGCP found in this segment. Piece \%ld -\/-\/f1, f2 at start point \%.2e \%.2e\(\backslash\)n"{}}, *nseg, f1, f2 );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03573}03573         printf(\textcolor{stringliteral}{"{}Distance to the stationary point = \%.2e\(\backslash\)n"{}}, dtm );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03574}03574     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03575}03575     \textcolor{keywordflow}{if} (dtm <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03576}03576         dtm = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03577}03577     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03578}03578     tsum += dtm;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03579}03579     \textcolor{comment}{/*     Move free variables (i.e., the ones w/o breakpoints) and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03580}03580     \textcolor{comment}{/*       the variables whose breakpoints haven't been reached. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03581}03581     daxpy(n, \&tsum, \&d\_\_[1], \&c\_\_1, \&xcp[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03582}03582 L999:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03583}03583     \textcolor{comment}{/*     Update c = c + dtm*p = W'(x\string^c -\/ x) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03584}03584     \textcolor{comment}{/*       which will be used in computing r = Z'(B(x\string^c -\/ x) + g). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03585}03585     \textcolor{keywordflow}{if} (*col > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03586}03586         daxpy(\&col2, \&dtm, \&p[1], \&c\_\_1, \&c\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03587}03587     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03588}03588     \textcolor{keywordflow}{if} (*iprint > 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03589}03589 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03590}03590         printf(\textcolor{stringliteral}{"{}Cauchy X = "{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03591}03591         i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03592}03592         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03593}03593             printf(\textcolor{stringliteral}{"{}\%5.2e "{}}, xcp[i\_\_] );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03594}03594         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03595}03595     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03596}03596     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03597}03597         printf(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ exit CAUCHY -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03598}03598     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03599}03599     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03600}03600 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03601}03601 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03602}03602 \textcolor{keywordtype}{int} Lbfgs::cmprlb(integer *n, integer *m, \textcolor{keywordtype}{double} *x,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03603}03603     \textcolor{keywordtype}{double} *g, \textcolor{keywordtype}{double} *ws, \textcolor{keywordtype}{double} *wy, \textcolor{keywordtype}{double} *sy,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03604}03604     \textcolor{keywordtype}{double} *wt, \textcolor{keywordtype}{double} *z\_\_, \textcolor{keywordtype}{double} *r\_\_, \textcolor{keywordtype}{double} *wa,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03605}03605     integer *index, \textcolor{keywordtype}{double} *theta, integer *col, integer *head,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03606}03606     integer *nfree, logical *cnstnd, integer *info)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03607}03607 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03608}03608     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03609}03609     integer ws\_dim1, ws\_offset, wy\_dim1, wy\_offset, sy\_dim1, sy\_offset,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03610}03610         wt\_dim1, wt\_offset, i\_\_1, i\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03611}03611 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03612}03612     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03613}03613      integer i\_\_, j, k;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03614}03614      \textcolor{keywordtype}{double} a1, a2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03615}03615     integer pointr;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03616}03616 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03617}03617 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03618}03618 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03619}03619 \textcolor{comment}{/*     Subroutine cmprlb */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03620}03620 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03621}03621 \textcolor{comment}{/*       This subroutine computes r=-\/Z'B(xcp-\/xk)-\/Z'g by using */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03622}03622 \textcolor{comment}{/*         wa(2m+1)=W'(xcp-\/x) from subroutine cauchy. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03623}03623 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03624}03624 \textcolor{comment}{/*     Subprograms called: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03625}03625 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03626}03626 \textcolor{comment}{/*       L-\/BFGS-\/B Library ... bmv. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03627}03627 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03628}03628 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03629}03629 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03630}03630 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03631}03631 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03632}03632 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03633}03633 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03634}03634 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03635}03635 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03636}03636 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03637}03637 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03638}03638 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03639}03639 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03640}03640     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03641}03641     -\/-\/index;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03642}03642     -\/-\/r\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03643}03643     -\/-\/z\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03644}03644     -\/-\/g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03645}03645     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03646}03646     -\/-\/wa;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03647}03647     wt\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03648}03648     wt\_offset = 1 + wt\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03649}03649     wt -\/= wt\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03650}03650     sy\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03651}03651     sy\_offset = 1 + sy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03652}03652     sy -\/= sy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03653}03653     wy\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03654}03654     wy\_offset = 1 + wy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03655}03655     wy -\/= wy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03656}03656     ws\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03657}03657     ws\_offset = 1 + ws\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03658}03658     ws -\/= ws\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03659}03659 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03660}03660     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03661}03661     \textcolor{keywordflow}{if} (! (*cnstnd) \&\& *col > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03662}03662     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03663}03663     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03664}03664         r\_\_[i\_\_] = -\/g[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03665}03665 \textcolor{comment}{/* L26: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03666}03666     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03667}03667     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03668}03668     i\_\_1 = *nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03669}03669     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03670}03670         k = index[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03671}03671         r\_\_[i\_\_] = -\/(*theta) * (z\_\_[k] -\/ x[k]) -\/ g[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03672}03672 \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03673}03673     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03674}03674     bmv(m, \&sy[sy\_offset], \&wt[wt\_offset], col, \&wa[(*m << 1) + 1], \&wa[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03675}03675         1], info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03676}03676     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03677}03677         *info = -\/8;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03678}03678         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03679}03679     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03680}03680     pointr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03681}03681     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03682}03682     \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03683}03683         a1 = wa[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03684}03684         a2 = *theta * wa[*col + j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03685}03685         i\_\_2 = *nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03686}03686         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_2; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03687}03687         k = index[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03688}03688         r\_\_[i\_\_] = r\_\_[i\_\_] + wy[k + pointr * wy\_dim1] * a1 + ws[k +}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03689}03689             pointr * ws\_dim1] * a2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03690}03690 \textcolor{comment}{/* L32: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03691}03691         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03692}03692         pointr = pointr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03693}03693 \textcolor{comment}{/* L34: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03694}03694     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03695}03695     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03696}03696     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03697}03697 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03698}03698 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03699}03699 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03700}03700 \textcolor{keywordtype}{int} Lbfgs::formk(integer *n, integer *nsub, integer *ind, integer *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03701}03701     nenter, integer *ileave, integer *indx2, integer *iupdat, logical *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03702}03702     updatd, \textcolor{keywordtype}{double} *wn, \textcolor{keywordtype}{double} *wn1, integer *m, \textcolor{keywordtype}{double} *ws,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03703}03703     \textcolor{keywordtype}{double} *wy, \textcolor{keywordtype}{double} *sy, \textcolor{keywordtype}{double} *theta, integer *col,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03704}03704     integer *head, integer *info)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03705}03705 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03706}03706     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03707}03707     integer wn\_dim1, wn\_offset, wn1\_dim1, wn1\_offset, ws\_dim1, ws\_offset,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03708}03708         wy\_dim1, wy\_offset, sy\_dim1, sy\_offset, i\_\_1, i\_\_2, i\_\_3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03709}03709 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03710}03710     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03711}03711      integer i\_\_, k, k1, m2, is, js, iy, jy, is1, js1, col2, dend, pend;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03712}03712      integer upcl;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03713}03713     \textcolor{keywordtype}{double} temp1, temp2, temp3, temp4;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03714}03714     integer ipntr, jpntr, dbegin, pbegin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03715}03715 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03716}03716 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03717}03717 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03718}03718 \textcolor{comment}{/*     Subroutine formk */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03719}03719 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03720}03720 \textcolor{comment}{/*     This subroutine forms  the LEL\string^T factorization of the indefinite */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03721}03721 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03722}03722 \textcolor{comment}{/*       matrix    K = [-\/D -\/Y'ZZ'Y/theta     L\_a'-\/R\_z'  ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03723}03723 \textcolor{comment}{/*                     [L\_a -\/R\_z           theta*S'AA'S ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03724}03724 \textcolor{comment}{/*                                                    where E = [-\/I  0] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03725}03725 \textcolor{comment}{/*                                                              [ 0  I] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03726}03726 \textcolor{comment}{/*     The matrix K can be shown to be equal to the matrix M\string^[-\/1]N */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03727}03727 \textcolor{comment}{/*       occurring in section 5.1 of [1], as well as to the matrix */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03728}03728 \textcolor{comment}{/*       Mbar\string^[-\/1] Nbar in section 5.3. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03729}03729 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03730}03730 \textcolor{comment}{/*     n is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03731}03731 \textcolor{comment}{/*       On entry n is the dimension of the problem. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03732}03732 \textcolor{comment}{/*       On exit n is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03733}03733 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03734}03734 \textcolor{comment}{/*     nsub is an integer variable */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03735}03735 \textcolor{comment}{/*       On entry nsub is the number of subspace variables in free set. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03736}03736 \textcolor{comment}{/*       On exit nsub is not changed. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03737}03737 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03738}03738 \textcolor{comment}{/*     ind is an integer array of dimension nsub. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03739}03739 \textcolor{comment}{/*       On entry ind specifies the indices of subspace variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03740}03740 \textcolor{comment}{/*       On exit ind is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03741}03741 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03742}03742 \textcolor{comment}{/*     nenter is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03743}03743 \textcolor{comment}{/*       On entry nenter is the number of variables entering the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03744}03744 \textcolor{comment}{/*         free set. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03745}03745 \textcolor{comment}{/*       On exit nenter is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03746}03746 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03747}03747 \textcolor{comment}{/*     ileave is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03748}03748 \textcolor{comment}{/*       On entry indx2(ileave),...,indx2(n) are the variables leaving */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03749}03749 \textcolor{comment}{/*         the free set. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03750}03750 \textcolor{comment}{/*       On exit ileave is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03751}03751 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03752}03752 \textcolor{comment}{/*     indx2 is an integer array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03753}03753 \textcolor{comment}{/*       On entry indx2(1),...,indx2(nenter) are the variables entering */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03754}03754 \textcolor{comment}{/*         the free set, while indx2(ileave),...,indx2(n) are the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03755}03755 \textcolor{comment}{/*         variables leaving the free set. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03756}03756 \textcolor{comment}{/*       On exit indx2 is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03757}03757 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03758}03758 \textcolor{comment}{/*     iupdat is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03759}03759 \textcolor{comment}{/*       On entry iupdat is the total number of BFGS updates made so far. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03760}03760 \textcolor{comment}{/*       On exit iupdat is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03761}03761 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03762}03762 \textcolor{comment}{/*     updatd is a logical variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03763}03763 \textcolor{comment}{/*       On entry 'updatd' is true if the L-\/BFGS matrix is updatd. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03764}03764 \textcolor{comment}{/*       On exit 'updatd' is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03765}03765 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03766}03766 \textcolor{comment}{/*     wn is a double precision array of dimension 2m x 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03767}03767 \textcolor{comment}{/*       On entry wn is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03768}03768 \textcolor{comment}{/*       On exit the upper triangle of wn stores the LEL\string^T factorization */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03769}03769 \textcolor{comment}{/*         of the 2*col x 2*col indefinite matrix */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03770}03770 \textcolor{comment}{/*                     [-\/D -\/Y'ZZ'Y/theta     L\_a'-\/R\_z'  ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03771}03771 \textcolor{comment}{/*                     [L\_a -\/R\_z           theta*S'AA'S ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03772}03772 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03773}03773 \textcolor{comment}{/*     wn1 is a double precision array of dimension 2m x 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03774}03774 \textcolor{comment}{/*       On entry wn1 stores the lower triangular part of */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03775}03775 \textcolor{comment}{/*                     [Y' ZZ'Y   L\_a'+R\_z'] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03776}03776 \textcolor{comment}{/*                     [L\_a+R\_z   S'AA'S   ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03777}03777 \textcolor{comment}{/*         in the previous iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03778}03778 \textcolor{comment}{/*       On exit wn1 stores the corresponding updated matrices. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03779}03779 \textcolor{comment}{/*       The purpose of wn1 is just to store these inner products */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03780}03780 \textcolor{comment}{/*       so they can be easily updated and inserted into wn. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03781}03781 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03782}03782 \textcolor{comment}{/*     m is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03783}03783 \textcolor{comment}{/*       On entry m is the maximum number of variable metric corrections */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03784}03784 \textcolor{comment}{/*         used to define the limited memory matrix. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03785}03785 \textcolor{comment}{/*       On exit m is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03786}03786 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03787}03787 \textcolor{comment}{/*     ws, wy, sy, and wtyy are double precision arrays; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03788}03788 \textcolor{comment}{/*     theta is a double precision variable; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03789}03789 \textcolor{comment}{/*     col is an integer variable; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03790}03790 \textcolor{comment}{/*     head is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03791}03791 \textcolor{comment}{/*       On entry they store the information defining the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03792}03792 \textcolor{comment}{/*                                          limited memory BFGS matrix: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03793}03793 \textcolor{comment}{/*         ws(n,m) stores S, a set of s-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03794}03794 \textcolor{comment}{/*         wy(n,m) stores Y, a set of y-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03795}03795 \textcolor{comment}{/*         sy(m,m) stores S'Y; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03796}03796 \textcolor{comment}{/*         wtyy(m,m) stores the Cholesky factorization */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03797}03797 \textcolor{comment}{/*                                   of (theta*S'S+LD\string^(-\/1)L') */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03798}03798 \textcolor{comment}{/*         theta is the scaling factor specifying B\_0 = theta I; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03799}03799 \textcolor{comment}{/*         col is the number of variable metric corrections stored; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03800}03800 \textcolor{comment}{/*         head is the location of the 1st s-\/ (or y-\/) vector in S (or Y). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03801}03801 \textcolor{comment}{/*       On exit they are unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03802}03802 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03803}03803 \textcolor{comment}{/*     info is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03804}03804 \textcolor{comment}{/*       On entry info is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03805}03805 \textcolor{comment}{/*       On exit info =  0 for normal return; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03806}03806 \textcolor{comment}{/*                    = -\/1 when the 1st Cholesky factorization failed; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03807}03807 \textcolor{comment}{/*                    = -\/2 when the 2st Cholesky factorization failed. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03808}03808 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03809}03809 \textcolor{comment}{/*     Subprograms called: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03810}03810 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03811}03811 \textcolor{comment}{/*       Linpack ... dcopy, dpofa, dtrsl. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03812}03812 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03813}03813 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03814}03814 \textcolor{comment}{/*     References: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03815}03815 \textcolor{comment}{/*       [1] R. H. Byrd, P. Lu, J. Nocedal and C. Zhu, ``A limited */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03816}03816 \textcolor{comment}{/*       memory algorithm for bound constrained optimization'', */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03817}03817 \textcolor{comment}{/*       SIAM J. Scientific Computing 16 (1995), no. 5, pp. 1190-\/-\/1208. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03818}03818 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03819}03819 \textcolor{comment}{/*       [2] C. Zhu, R.H. Byrd, P. Lu, J. Nocedal, ``L-\/BFGS-\/B: a */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03820}03820 \textcolor{comment}{/*       limited memory FORTRAN code for solving bound constrained */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03821}03821 \textcolor{comment}{/*       optimization problems'', Tech. Report, NAM-\/11, EECS Department, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03822}03822 \textcolor{comment}{/*       Northwestern University, 1994. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03823}03823 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03824}03824 \textcolor{comment}{/*       (Postscript files of these papers are available via anonymous */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03825}03825 \textcolor{comment}{/*        ftp to eecs.nwu.edu in the directory pub/lbfgs/lbfgs\_bcm.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03826}03826 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03827}03827 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03828}03828 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03829}03829 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03830}03830 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03831}03831 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03832}03832 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03833}03833 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03834}03834 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03835}03835 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03836}03836 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03837}03837 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03838}03838 \textcolor{comment}{/*     Form the lower triangular part of */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03839}03839 \textcolor{comment}{/*               WN1 = [Y' ZZ'Y   L\_a'+R\_z'] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03840}03840 \textcolor{comment}{/*                     [L\_a+R\_z   S'AA'S   ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03841}03841 \textcolor{comment}{/*        where L\_a is the strictly lower triangular part of S'AA'Y */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03842}03842 \textcolor{comment}{/*              R\_z is the upper triangular part of S'ZZ'Y. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03843}03843     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03844}03844     -\/-\/indx2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03845}03845     -\/-\/ind;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03846}03846     sy\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03847}03847     sy\_offset = 1 + sy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03848}03848     sy -\/= sy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03849}03849     wy\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03850}03850     wy\_offset = 1 + wy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03851}03851     wy -\/= wy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03852}03852     ws\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03853}03853     ws\_offset = 1 + ws\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03854}03854     ws -\/= ws\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03855}03855     wn1\_dim1 = 2 * *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03856}03856     wn1\_offset = 1 + wn1\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03857}03857     wn1 -\/= wn1\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03858}03858     wn\_dim1 = 2 * *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03859}03859     wn\_offset = 1 + wn\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03860}03860     wn -\/= wn\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03861}03861 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03862}03862     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03863}03863     \textcolor{keywordflow}{if} (*updatd) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03864}03864     \textcolor{keywordflow}{if} (*iupdat > *m) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03865}03865 \textcolor{comment}{/*                                 shift old part of WN1. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03866}03866         i\_\_1 = *m -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03867}03867         \textcolor{keywordflow}{for} (jy = 1; jy <= i\_\_1; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03868}03868         js = *m + jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03869}03869         i\_\_2 = *m -\/ jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03870}03870         dcopy(\&i\_\_2, \&wn1[jy + 1 + (jy + 1) * wn1\_dim1], \&c\_\_1, \&wn1[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03871}03871             jy + jy * wn1\_dim1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03872}03872         i\_\_2 = *m -\/ jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03873}03873         dcopy(\&i\_\_2, \&wn1[js + 1 + (js + 1) * wn1\_dim1], \&c\_\_1, \&wn1[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03874}03874             js + js * wn1\_dim1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03875}03875         i\_\_2 = *m -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03876}03876         dcopy(\&i\_\_2, \&wn1[*m + 2 + (jy + 1) * wn1\_dim1], \&c\_\_1, \&wn1[}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03877}03877             *m + 1 + jy * wn1\_dim1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03878}03878 \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03879}03879         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03880}03880     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03881}03881 \textcolor{comment}{/*          put new rows in blocks (1,1), (2,1) and (2,2). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03882}03882     pbegin = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03883}03883     pend = *nsub;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03884}03884     dbegin = *nsub + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03885}03885     dend = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03886}03886     iy = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03887}03887     is = *m + *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03888}03888     ipntr = *head + *col -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03889}03889     \textcolor{keywordflow}{if} (ipntr > *m) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03890}03890         ipntr -\/= *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03891}03891     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03892}03892     jpntr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03893}03893     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03894}03894     \textcolor{keywordflow}{for} (jy = 1; jy <= i\_\_1; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03895}03895         js = *m + jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03896}03896         temp1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03897}03897         temp2 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03898}03898         temp3 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03899}03899 \textcolor{comment}{/*             compute element jy of row 'col' of Y'ZZ'Y */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03900}03900         i\_\_2 = pend;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03901}03901         \textcolor{keywordflow}{for} (k = pbegin; k <= i\_\_2; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03902}03902         k1 = ind[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03903}03903         temp1 += wy[k1 + ipntr * wy\_dim1] * wy[k1 + jpntr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03904}03904 \textcolor{comment}{/* L15: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03905}03905         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03906}03906 \textcolor{comment}{/*             compute elements jy of row 'col' of L\_a and S'AA'S */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03907}03907         i\_\_2 = dend;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03908}03908         \textcolor{keywordflow}{for} (k = dbegin; k <= i\_\_2; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03909}03909         k1 = ind[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03910}03910         temp2 += ws[k1 + ipntr * ws\_dim1] * ws[k1 + jpntr * ws\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03911}03911         temp3 += ws[k1 + ipntr * ws\_dim1] * wy[k1 + jpntr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03912}03912 \textcolor{comment}{/* L16: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03913}03913         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03914}03914         wn1[iy + jy * wn1\_dim1] = temp1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03915}03915         wn1[is + js * wn1\_dim1] = temp2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03916}03916         wn1[is + jy * wn1\_dim1] = temp3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03917}03917         jpntr = jpntr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03918}03918 \textcolor{comment}{/* L20: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03919}03919     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03920}03920 \textcolor{comment}{/*          put new column in block (2,1). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03921}03921     jy = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03922}03922     jpntr = *head + *col -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03923}03923     \textcolor{keywordflow}{if} (jpntr > *m) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03924}03924         jpntr -\/= *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03925}03925     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03926}03926     ipntr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03927}03927     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03928}03928     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03929}03929         is = *m + i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03930}03930         temp3 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03931}03931 \textcolor{comment}{/*             compute element i of column 'col' of R\_z */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03932}03932         i\_\_2 = pend;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03933}03933         \textcolor{keywordflow}{for} (k = pbegin; k <= i\_\_2; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03934}03934         k1 = ind[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03935}03935         temp3 += ws[k1 + ipntr * ws\_dim1] * wy[k1 + jpntr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03936}03936 \textcolor{comment}{/* L25: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03937}03937         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03938}03938         ipntr = ipntr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03939}03939         wn1[is + jy * wn1\_dim1] = temp3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03940}03940 \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03941}03941     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03942}03942     upcl = *col -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03943}03943     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03944}03944     upcl = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03945}03945     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03946}03946 \textcolor{comment}{/*       modify the old parts in blocks (1,1) and (2,2) due to changes */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03947}03947 \textcolor{comment}{/*       in the set of free variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03948}03948     ipntr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03949}03949     i\_\_1 = upcl;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03950}03950     \textcolor{keywordflow}{for} (iy = 1; iy <= i\_\_1; ++iy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03951}03951     is = *m + iy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03952}03952     jpntr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03953}03953     i\_\_2 = iy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03954}03954     \textcolor{keywordflow}{for} (jy = 1; jy <= i\_\_2; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03955}03955         js = *m + jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03956}03956         temp1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03957}03957         temp2 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03958}03958         temp3 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03959}03959         temp4 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03960}03960         i\_\_3 = *nenter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03961}03961         \textcolor{keywordflow}{for} (k = 1; k <= i\_\_3; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03962}03962         k1 = indx2[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03963}03963         temp1 += wy[k1 + ipntr * wy\_dim1] * wy[k1 + jpntr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03964}03964         temp2 += ws[k1 + ipntr * ws\_dim1] * ws[k1 + jpntr * ws\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03965}03965 \textcolor{comment}{/* L35: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03966}03966         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03967}03967         i\_\_3 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03968}03968         \textcolor{keywordflow}{for} (k = *ileave; k <= i\_\_3; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03969}03969         k1 = indx2[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03970}03970         temp3 += wy[k1 + ipntr * wy\_dim1] * wy[k1 + jpntr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03971}03971         temp4 += ws[k1 + ipntr * ws\_dim1] * ws[k1 + jpntr * ws\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03972}03972 \textcolor{comment}{/* L36: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03973}03973         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03974}03974         wn1[iy + jy * wn1\_dim1] = wn1[iy + jy * wn1\_dim1] + temp1 -\/ temp3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03975}03975         wn1[is + js * wn1\_dim1] = wn1[is + js * wn1\_dim1] -\/ temp2 + temp4;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03976}03976         jpntr = jpntr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03977}03977 \textcolor{comment}{/* L40: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03978}03978     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03979}03979     ipntr = ipntr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03980}03980 \textcolor{comment}{/* L45: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03981}03981     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03982}03982 \textcolor{comment}{/*       modify the old parts in block (2,1). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03983}03983     ipntr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03984}03984     i\_\_1 = *m + upcl;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03985}03985     \textcolor{keywordflow}{for} (is = *m + 1; is <= i\_\_1; ++is) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03986}03986     jpntr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03987}03987     i\_\_2 = upcl;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03988}03988     \textcolor{keywordflow}{for} (jy = 1; jy <= i\_\_2; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03989}03989         temp1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03990}03990         temp3 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03991}03991         i\_\_3 = *nenter;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03992}03992         \textcolor{keywordflow}{for} (k = 1; k <= i\_\_3; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03993}03993         k1 = indx2[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03994}03994         temp1 += ws[k1 + ipntr * ws\_dim1] * wy[k1 + jpntr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03995}03995 \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03996}03996         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03997}03997         i\_\_3 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03998}03998         \textcolor{keywordflow}{for} (k = *ileave; k <= i\_\_3; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l03999}03999         k1 = indx2[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04000}04000         temp3 += ws[k1 + ipntr * ws\_dim1] * wy[k1 + jpntr * wy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04001}04001 \textcolor{comment}{/* L51: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04002}04002         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04003}04003         \textcolor{keywordflow}{if} (is <= jy + *m) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04004}04004         wn1[is + jy * wn1\_dim1] = wn1[is + jy * wn1\_dim1] + temp1 -\/}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04005}04005             temp3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04006}04006         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04007}04007         wn1[is + jy * wn1\_dim1] = wn1[is + jy * wn1\_dim1] -\/ temp1 +}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04008}04008             temp3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04009}04009         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04010}04010         jpntr = jpntr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04011}04011 \textcolor{comment}{/* L55: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04012}04012     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04013}04013     ipntr = ipntr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04014}04014 \textcolor{comment}{/* L60: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04015}04015     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04016}04016 \textcolor{comment}{/*     Form the upper triangle of WN = [D+Y' ZZ'Y/theta   -\/L\_a'+R\_z' ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04017}04017 \textcolor{comment}{/*                                     [-\/L\_a +R\_z        S'AA'S*theta] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04018}04018     m2 = *m << 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04019}04019     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04020}04020     \textcolor{keywordflow}{for} (iy = 1; iy <= i\_\_1; ++iy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04021}04021     is = *col + iy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04022}04022     is1 = *m + iy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04023}04023     i\_\_2 = iy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04024}04024     \textcolor{keywordflow}{for} (jy = 1; jy <= i\_\_2; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04025}04025         js = *col + jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04026}04026         js1 = *m + jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04027}04027         wn[jy + iy * wn\_dim1] = wn1[iy + jy * wn1\_dim1] / *theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04028}04028         wn[js + is * wn\_dim1] = wn1[is1 + js1 * wn1\_dim1] * *theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04029}04029 \textcolor{comment}{/* L65: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04030}04030     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04031}04031     i\_\_2 = iy -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04032}04032     \textcolor{keywordflow}{for} (jy = 1; jy <= i\_\_2; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04033}04033         wn[jy + is * wn\_dim1] = -\/wn1[is1 + jy * wn1\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04034}04034 \textcolor{comment}{/* L66: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04035}04035     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04036}04036     i\_\_2 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04037}04037     \textcolor{keywordflow}{for} (jy = iy; jy <= i\_\_2; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04038}04038         wn[jy + is * wn\_dim1] = wn1[is1 + jy * wn1\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04039}04039 \textcolor{comment}{/* L67: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04040}04040     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04041}04041     wn[iy + iy * wn\_dim1] += sy[iy + iy * sy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04042}04042 \textcolor{comment}{/* L70: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04043}04043     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04044}04044 \textcolor{comment}{/*     Form the upper triangle of WN= [  LL'            L\string^-\/1(-\/L\_a'+R\_z')] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04045}04045 \textcolor{comment}{/*                                    [(-\/L\_a +R\_z)L'\string^-\/1   S'AA'S*theta  ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04046}04046 \textcolor{comment}{/*        first Cholesky factor (1,1) block of wn to get LL' */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04047}04047 \textcolor{comment}{/*                          with L' stored in the upper triangle of wn. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04048}04048     dpofa(\&wn[wn\_offset], \&m2, col, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04049}04049     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04050}04050     *info = -\/1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04051}04051     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04052}04052     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04053}04053 \textcolor{comment}{/*        then form L\string^-\/1(-\/L\_a'+R\_z') in the (1,2) block. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04054}04054     col2 = *col << 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04055}04055     i\_\_1 = col2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04056}04056     \textcolor{keywordflow}{for} (js = *col + 1; js <= i\_\_1; ++js) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04057}04057     dtrsl(\&wn[wn\_offset], \&m2, col, \&wn[js * wn\_dim1 + 1], \&c\_\_11, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04058}04058 \textcolor{comment}{/* L71: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04059}04059     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04060}04060 \textcolor{comment}{/*     Form S'AA'S*theta + (L\string^-\/1(-\/L\_a'+R\_z'))'L\string^-\/1(-\/L\_a'+R\_z') in the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04061}04061 \textcolor{comment}{/*        upper triangle of (2,2) block of wn. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04062}04062     i\_\_1 = col2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04063}04063     \textcolor{keywordflow}{for} (is = *col + 1; is <= i\_\_1; ++is) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04064}04064     i\_\_2 = col2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04065}04065     \textcolor{keywordflow}{for} (js = is; js <= i\_\_2; ++js) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04066}04066         wn[is + js * wn\_dim1] += ddot(col, \&wn[is * wn\_dim1 + 1], \&c\_\_1,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04067}04067             \&wn[js * wn\_dim1 + 1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04068}04068 \textcolor{comment}{/* L74: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04069}04069     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04070}04070 \textcolor{comment}{/* L72: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04071}04071     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04072}04072 \textcolor{comment}{/*     Cholesky factorization of (2,2) block of wn. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04073}04073     dpofa(\&wn[*col + 1 + (*col + 1) * wn\_dim1], \&m2, col, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04074}04074     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04075}04075     *info = -\/2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04076}04076     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04077}04077     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04078}04078     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04079}04079 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04080}04080 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04081}04081 \textcolor{keywordtype}{int} Lbfgs::formt(integer *m, \textcolor{keywordtype}{double} *wt, \textcolor{keywordtype}{double} *sy,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04082}04082     \textcolor{keywordtype}{double} *ss, integer *col, \textcolor{keywordtype}{double} *theta, integer *info)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04083}04083 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04084}04084     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04085}04085     integer wt\_dim1, wt\_offset, sy\_dim1, sy\_offset, ss\_dim1, ss\_offset, i\_\_1,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04086}04086         i\_\_2, i\_\_3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04087}04087 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04088}04088     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04089}04089      integer i\_\_, j, k, k1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04090}04090      \textcolor{keywordtype}{double} ddum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04091}04091 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04092}04092 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04093}04093 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04094}04094 \textcolor{comment}{/*     Subroutine formt */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04095}04095 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04096}04096 \textcolor{comment}{/*       This subroutine forms the upper half of the pos. def. and symm. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04097}04097 \textcolor{comment}{/*         T = theta*SS + L*D\string^(-\/1)*L', stores T in the upper triangle */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04098}04098 \textcolor{comment}{/*         of the array wt, and performs the Cholesky factorization of T */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04099}04099 \textcolor{comment}{/*         to produce J*J', with J' stored in the upper triangle of wt. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04100}04100 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04101}04101 \textcolor{comment}{/*     Subprograms called: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04102}04102 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04103}04103 \textcolor{comment}{/*       Linpack ... dpofa. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04104}04104 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04105}04105 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04106}04106 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04107}04107 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04108}04108 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04109}04109 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04110}04110 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04111}04111 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04112}04112 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04113}04113 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04114}04114 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04115}04115 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04116}04116 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04117}04117 \textcolor{comment}{/*     Form the upper half of  T = theta*SS + L*D\string^(-\/1)*L', */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04118}04118 \textcolor{comment}{/*        store T in the upper triangle of the array wt. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04119}04119     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04120}04120     ss\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04121}04121     ss\_offset = 1 + ss\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04122}04122     ss -\/= ss\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04123}04123     sy\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04124}04124     sy\_offset = 1 + sy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04125}04125     sy -\/= sy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04126}04126     wt\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04127}04127     wt\_offset = 1 + wt\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04128}04128     wt -\/= wt\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04129}04129 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04130}04130     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04131}04131     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04132}04132     \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04133}04133     wt[j * wt\_dim1 + 1] = *theta * ss[j * ss\_dim1 + 1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04134}04134 \textcolor{comment}{/* L52: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04135}04135     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04136}04136     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04137}04137     \textcolor{keywordflow}{for} (i\_\_ = 2; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04138}04138     i\_\_2 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04139}04139     \textcolor{keywordflow}{for} (j = i\_\_; j <= i\_\_2; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04140}04140         k1 = fmin(i\_\_,j) -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04141}04141         ddum = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04142}04142         i\_\_3 = k1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04143}04143         \textcolor{keywordflow}{for} (k = 1; k <= i\_\_3; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04144}04144         ddum += sy[i\_\_ + k * sy\_dim1] * sy[j + k * sy\_dim1] / sy[k +}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04145}04145             k * sy\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04146}04146 \textcolor{comment}{/* L53: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04147}04147         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04148}04148         wt[i\_\_ + j * wt\_dim1] = ddum + *theta * ss[i\_\_ + j * ss\_dim1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04149}04149 \textcolor{comment}{/* L54: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04150}04150     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04151}04151 \textcolor{comment}{/* L55: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04152}04152     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04153}04153 \textcolor{comment}{/*     Cholesky factorize T to J*J' with */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04154}04154 \textcolor{comment}{/*        J' stored in the upper triangle of wt. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04155}04155     dpofa(\&wt[wt\_offset], m, col, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04156}04156     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04157}04157     *info = -\/3;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04158}04158     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04159}04159     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04160}04160 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04161}04161 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04162}04162 \textcolor{keywordtype}{int} Lbfgs::freev(integer *n, integer *nfree, integer *index,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04163}04163     integer *nenter, integer *ileave, integer *indx2, integer *iwhere,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04164}04164     logical *wrk, logical *updatd, logical *cnstnd, integer *iprint,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04165}04165     integer *iter)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04166}04166 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04167}04167     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04168}04168     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04169}04169 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04170}04170     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04171}04171     integer i\_\_, k, iact;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04172}04172 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04173}04173 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04174}04174 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04175}04175 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04176}04176 \textcolor{comment}{/*     Subroutine freev */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04177}04177 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04178}04178 \textcolor{comment}{/*     This subroutine counts the entering and leaving variables when */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04179}04179 \textcolor{comment}{/*       iter > 0, and finds the index set of free and active variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04180}04180 \textcolor{comment}{/*       at the GCP. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04181}04181 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04182}04182 \textcolor{comment}{/*     cnstnd is a logical variable indicating whether bounds are present */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04183}04183 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04184}04184 \textcolor{comment}{/*     index is an integer array of dimension n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04185}04185 \textcolor{comment}{/*       for i=1,...,nfree, index(i) are the indices of free variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04186}04186 \textcolor{comment}{/*       for i=nfree+1,...,n, index(i) are the indices of bound variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04187}04187 \textcolor{comment}{/*       On entry after the first iteration, index gives */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04188}04188 \textcolor{comment}{/*         the free variables at the previous iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04189}04189 \textcolor{comment}{/*       On exit it gives the free variables based on the determination */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04190}04190 \textcolor{comment}{/*         in cauchy using the array iwhere. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04191}04191 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04192}04192 \textcolor{comment}{/*     indx2 is an integer array of dimension n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04193}04193 \textcolor{comment}{/*       On entry indx2 is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04194}04194 \textcolor{comment}{/*       On exit with iter>0, indx2 indicates which variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04195}04195 \textcolor{comment}{/*          have changed status since the previous iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04196}04196 \textcolor{comment}{/*       For i= 1,...,nenter, indx2(i) have changed from bound to free. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04197}04197 \textcolor{comment}{/*       For i= ileave+1,...,n, indx2(i) have changed from free to bound. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04198}04198 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04199}04199 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04200}04200 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04201}04201 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04202}04202 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04203}04203 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04204}04204 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04205}04205 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04206}04206 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04207}04207 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04208}04208 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04209}04209 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04210}04210 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04211}04211     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04212}04212     -\/-\/iwhere;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04213}04213     -\/-\/indx2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04214}04214     -\/-\/index;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04215}04215 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04216}04216     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04217}04217     *nenter = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04218}04218     *ileave = *n + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04219}04219     \textcolor{keywordflow}{if} (*iter > 0 \&\& *cnstnd) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04220}04220         \textcolor{comment}{/*                           count the entering and leaving variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04221}04221         i\_\_1 = *nfree;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04222}04222         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04223}04223             k = index[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04224}04224             \textcolor{comment}{/*            write(6,*) ' k  = index(i) ', k */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04225}04225             \textcolor{comment}{/*            write(6,*) ' index = ', i */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04226}04226             \textcolor{keywordflow}{if} (iwhere[k] > 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04227}04227                 -\/-\/(*ileave);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04228}04228                 indx2[*ileave] = k;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04229}04229                 \textcolor{keywordflow}{if} (*iprint >= 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04230}04230                     printf(\textcolor{stringliteral}{"{}Variable \%ld leaves the set of free variables\(\backslash\)n"{}}, k );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04231}04231                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04232}04232             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04233}04233             \textcolor{comment}{/* L20: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04234}04234         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04235}04235         i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04236}04236         \textcolor{keywordflow}{for} (i\_\_ = *nfree + 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04237}04237             k = index[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04238}04238             \textcolor{keywordflow}{if} (iwhere[k] <= 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04239}04239                 ++(*nenter);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04240}04240                 indx2[*nenter] = k;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04241}04241                 \textcolor{keywordflow}{if} (*iprint >= 100) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04242}04242                     printf(\textcolor{stringliteral}{"{}Variable \%ld leaves the set of free variables\(\backslash\)n"{}}, k );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04243}04243                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04244}04244             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04245}04245             \textcolor{comment}{/* L22: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04246}04246         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04247}04247         \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04248}04248             i\_\_1 = *n + 1 -\/ *ileave;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04249}04249             printf(\textcolor{stringliteral}{"{}\%ld variables leave; \%ld variables enter\(\backslash\)n"{}}, i\_\_1, *nenter );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04250}04250         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04251}04251     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04252}04252     *wrk = *ileave < *n + 1 || *nenter > 0 || *updatd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04253}04253     \textcolor{comment}{/*     Find the index set of free and active variables at the GCP. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04254}04254     *nfree = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04255}04255     iact = *n + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04256}04256     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04257}04257     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04258}04258         \textcolor{keywordflow}{if} (iwhere[i\_\_] <= 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04259}04259             ++(*nfree);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04260}04260             index[*nfree] = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04261}04261         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04262}04262             -\/-\/iact;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04263}04263             index[iact] = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04264}04264         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04265}04265         \textcolor{comment}{/* L24: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04266}04266     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04267}04267     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04268}04268         i\_\_1 = *iter + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04269}04269         printf(\textcolor{stringliteral}{"{}\%ld variables are free at GCP iter \%ld\(\backslash\)n"{}}, *nfree, i\_\_1 );}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04270}04270     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04271}04271     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04272}04272 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04273}04273 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04274}04274 \textcolor{keywordtype}{int} Lbfgs::hpsolb(integer *n, \textcolor{keywordtype}{double} *t, integer *iorder,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04275}04275         integer *iheap)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04276}04276 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04277}04277     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04278}04278     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04279}04279 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04280}04280     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04281}04281      integer i\_\_, j, k;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04282}04282      \textcolor{keywordtype}{double} out, ddum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04283}04283      integer indxin, indxou;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04284}04284 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04285}04285 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04286}04286 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04287}04287 \textcolor{comment}{/*     Subroutine hpsolb */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04288}04288 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04289}04289 \textcolor{comment}{/*     This subroutine sorts out the least element of t, and puts the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04290}04290 \textcolor{comment}{/*       remaining elements of t in a heap. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04291}04291 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04292}04292 \textcolor{comment}{/*     n is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04293}04293 \textcolor{comment}{/*       On entry n is the dimension of the arrays t and iorder. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04294}04294 \textcolor{comment}{/*       On exit n is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04295}04295 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04296}04296 \textcolor{comment}{/*     t is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04297}04297 \textcolor{comment}{/*       On entry t stores the elements to be sorted, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04298}04298 \textcolor{comment}{/*       On exit t(n) stores the least elements of t, and t(1) to t(n-\/1) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04299}04299 \textcolor{comment}{/*         stores the remaining elements in the form of a heap. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04300}04300 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04301}04301 \textcolor{comment}{/*     iorder is an integer array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04302}04302 \textcolor{comment}{/*       On entry iorder(i) is the index of t(i). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04303}04303 \textcolor{comment}{/*       On exit iorder(i) is still the index of t(i), but iorder may be */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04304}04304 \textcolor{comment}{/*         permuted in accordance with t. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04305}04305 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04306}04306 \textcolor{comment}{/*     iheap is an integer variable specifying the task. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04307}04307 \textcolor{comment}{/*       On entry iheap should be set as follows: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04308}04308 \textcolor{comment}{/*         iheap .eq. 0 if t(1) to t(n) is not in the form of a heap, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04309}04309 \textcolor{comment}{/*         iheap .ne. 0 if otherwise. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04310}04310 \textcolor{comment}{/*       On exit iheap is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04311}04311 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04312}04312 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04313}04313 \textcolor{comment}{/*     References: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04314}04314 \textcolor{comment}{/*       Algorithm 232 of CACM (J. W. J. Williams): HEAPSORT. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04315}04315 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04316}04316 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04317}04317 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04318}04318 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04319}04319 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04320}04320 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04321}04321 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04322}04322 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04323}04323 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04324}04324 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04325}04325 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04326}04326     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04327}04327     -\/-\/iorder;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04328}04328     -\/-\/t;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04329}04329 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04330}04330     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04331}04331     \textcolor{keywordflow}{if} (*iheap == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04332}04332 \textcolor{comment}{/*        Rearrange the elements t(1) to t(n) to form a heap. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04333}04333     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04334}04334     \textcolor{keywordflow}{for} (k = 2; k <= i\_\_1; ++k) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04335}04335         ddum = t[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04336}04336         indxin = iorder[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04337}04337 \textcolor{comment}{/*           Add ddum to the heap. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04338}04338         i\_\_ = k;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04339}04339 L10:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04340}04340         \textcolor{keywordflow}{if} (i\_\_ > 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04341}04341         j = i\_\_ / 2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04342}04342         \textcolor{keywordflow}{if} (ddum < t[j]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04343}04343             t[i\_\_] = t[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04344}04344             iorder[i\_\_] = iorder[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04345}04345             i\_\_ = j;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04346}04346             \textcolor{keywordflow}{goto} L10;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04347}04347         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04348}04348         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04349}04349         t[i\_\_] = ddum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04350}04350         iorder[i\_\_] = indxin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04351}04351 \textcolor{comment}{/* L20: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04352}04352     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04353}04353     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04354}04354 \textcolor{comment}{/*     Assign to 'out' the value of t(1), the least member of the heap, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04355}04355 \textcolor{comment}{/*        and rearrange the remaining members to form a heap as */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04356}04356 \textcolor{comment}{/*        elements 1 to n-\/1 of t. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04357}04357     \textcolor{keywordflow}{if} (*n > 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04358}04358     i\_\_ = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04359}04359     out = t[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04360}04360     indxou = iorder[1];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04361}04361     ddum = t[*n];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04362}04362     indxin = iorder[*n];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04363}04363 \textcolor{comment}{/*        Restore the heap */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04364}04364 L30:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04365}04365     j = i\_\_ + i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04366}04366     \textcolor{keywordflow}{if} (j <= *n -\/ 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04367}04367         \textcolor{keywordflow}{if} (t[j + 1] < t[j]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04368}04368         ++j;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04369}04369         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04370}04370         \textcolor{keywordflow}{if} (t[j] < ddum) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04371}04371         t[i\_\_] = t[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04372}04372         iorder[i\_\_] = iorder[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04373}04373         i\_\_ = j;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04374}04374         \textcolor{keywordflow}{goto} L30;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04375}04375         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04376}04376     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04377}04377     t[i\_\_] = ddum;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04378}04378     iorder[i\_\_] = indxin;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04379}04379 \textcolor{comment}{/*     Put the least member in t(n). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04380}04380     t[*n] = out;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04381}04381     iorder[*n] = indxou;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04382}04382     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04383}04383     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04384}04384 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04385}04385 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04386}04386 \textcolor{keywordtype}{int} Lbfgs::matupd(integer *n, integer *m, \textcolor{keywordtype}{double} *ws,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04387}04387     \textcolor{keywordtype}{double} *wy, \textcolor{keywordtype}{double} *sy, \textcolor{keywordtype}{double} *ss, \textcolor{keywordtype}{double} *d\_\_,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04388}04388     \textcolor{keywordtype}{double} *r\_\_, integer *itail, integer *iupdat, integer *col,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04389}04389     integer *head, \textcolor{keywordtype}{double} *theta, \textcolor{keywordtype}{double} *rr, \textcolor{keywordtype}{double} *dr,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04390}04390     \textcolor{keywordtype}{double} *stp, \textcolor{keywordtype}{double} *dtd)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04391}04391 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04392}04392     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04393}04393     integer ws\_dim1, ws\_offset, wy\_dim1, wy\_offset, sy\_dim1, sy\_offset,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04394}04394         ss\_dim1, ss\_offset, i\_\_1, i\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04395}04395 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04396}04396     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04397}04397      integer j;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04398}04398      integer pointr;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04399}04399 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04400}04400 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04401}04401 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04402}04402 \textcolor{comment}{/*     Subroutine matupd */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04403}04403 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04404}04404 \textcolor{comment}{/*       This subroutine updates matrices WS and WY, and forms the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04405}04405 \textcolor{comment}{/*         middle matrix in B. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04406}04406 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04407}04407 \textcolor{comment}{/*     Subprograms called: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04408}04408 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04409}04409 \textcolor{comment}{/*       Linpack ... dcopy, ddot. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04410}04410 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04411}04411 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04412}04412 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04413}04413 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04414}04414 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04415}04415 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04416}04416 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04417}04417 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04418}04418 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04419}04419 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04420}04420 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04421}04421 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04422}04422 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04423}04423 \textcolor{comment}{/*     Set pointers for matrices WS and WY. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04424}04424     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04425}04425     -\/-\/r\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04426}04426     -\/-\/d\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04427}04427     ss\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04428}04428     ss\_offset = 1 + ss\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04429}04429     ss -\/= ss\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04430}04430     sy\_dim1 = *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04431}04431     sy\_offset = 1 + sy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04432}04432     sy -\/= sy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04433}04433     wy\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04434}04434     wy\_offset = 1 + wy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04435}04435     wy -\/= wy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04436}04436     ws\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04437}04437     ws\_offset = 1 + ws\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04438}04438     ws -\/= ws\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04439}04439 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04440}04440     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04441}04441     \textcolor{keywordflow}{if} (*iupdat <= *m) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04442}04442         *col = *iupdat;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04443}04443         *itail = (*head + *iupdat -\/ 2) \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04444}04444     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04445}04445         *itail = *itail \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04446}04446         *head = *head \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04447}04447     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04448}04448     \textcolor{comment}{/*     Update matrices WS and WY. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04449}04449     dcopy(n, \&d\_\_[1], \&c\_\_1, \&ws[*itail * ws\_dim1 + 1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04450}04450     dcopy(n, \&r\_\_[1], \&c\_\_1, \&wy[*itail * wy\_dim1 + 1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04451}04451     \textcolor{comment}{/*     Set theta=yy/ys. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04452}04452     *theta = *rr / *dr;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04453}04453     \textcolor{comment}{/*     Form the middle matrix in B. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04454}04454     \textcolor{comment}{/*        update the upper triangle of SS, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04455}04455     \textcolor{comment}{/*                                         and the lower triangle of SY: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04456}04456     \textcolor{keywordflow}{if} (*iupdat > *m) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04457}04457         \textcolor{comment}{/*                              move old information */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04458}04458         i\_\_1 = *col -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04459}04459         \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04460}04460             dcopy(\&j, \&ss[(j + 1) * ss\_dim1 + 2], \&c\_\_1, \&ss[j * ss\_dim1 + 1]}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04461}04461                     , \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04462}04462             i\_\_2 = *col -\/ j;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04463}04463             dcopy(\&i\_\_2, \&sy[j + 1 + (j + 1) * sy\_dim1], \&c\_\_1, \&sy[j + j *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04464}04464                     sy\_dim1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04465}04465             \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04466}04466         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04467}04467     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04468}04468     \textcolor{comment}{/*        add new information: the last row of SY */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04469}04469     \textcolor{comment}{/*                                             and the last column of SS: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04470}04470     pointr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04471}04471     i\_\_1 = *col -\/ 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04472}04472     \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04473}04473         sy[*col + j * sy\_dim1] = ddot(n, \&d\_\_[1], \&c\_\_1, \&wy[pointr *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04474}04474                 wy\_dim1 + 1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04475}04475         ss[j + *col * ss\_dim1] = ddot(n, \&ws[pointr * ws\_dim1 + 1], \&c\_\_1, \&}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04476}04476                 d\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04477}04477         pointr = pointr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04478}04478         \textcolor{comment}{/* L51: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04479}04479     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04480}04480     \textcolor{keywordflow}{if} (*stp == 1.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04481}04481         ss[*col + *col * ss\_dim1] = *dtd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04482}04482     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04483}04483         ss[*col + *col * ss\_dim1] = *stp * *stp * *dtd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04484}04484     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04485}04485     sy[*col + *col * sy\_dim1] = *dr;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04486}04486     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04487}04487 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04488}04488 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04489}04489 \textcolor{keywordtype}{int} Lbfgs::projgr(integer *n, \textcolor{keywordtype}{double} *l, \textcolor{keywordtype}{double} *u,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04490}04490         integer *nbd, \textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{double} *g, \textcolor{keywordtype}{double} *sbgnrm)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04491}04491 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04492}04492     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04493}04493     integer i\_\_1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04494}04494     \textcolor{keywordtype}{double} d\_\_1, d\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04495}04495 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04496}04496     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04497}04497      integer i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04498}04498      \textcolor{keywordtype}{double} gi;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04499}04499 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04500}04500 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04501}04501 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04502}04502 \textcolor{comment}{/*     Subroutine projgr */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04503}04503 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04504}04504 \textcolor{comment}{/*     This subroutine computes the infinity norm of the projected */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04505}04505 \textcolor{comment}{/*       gradient. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04506}04506 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04507}04507 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04508}04508 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04509}04509 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04510}04510 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04511}04511 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04512}04512 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04513}04513 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04514}04514 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04515}04515 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04516}04516 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04517}04517 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04518}04518 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04519}04519     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04520}04520     -\/-\/g;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04521}04521     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04522}04522     -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04523}04523     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04524}04524     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04525}04525 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04526}04526     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04527}04527     *sbgnrm = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04528}04528     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04529}04529     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04530}04530         gi = g[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04531}04531         \textcolor{keywordflow}{if} (nbd[i\_\_] != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04532}04532             \textcolor{keywordflow}{if} (gi < 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04533}04533                 \textcolor{keywordflow}{if} (nbd[i\_\_] >= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04534}04534                     \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04535}04535                     d\_\_1 = x[i\_\_] -\/ u[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04536}04536                     gi = fmax(d\_\_1,gi);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04537}04537                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04538}04538             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04539}04539                 \textcolor{keywordflow}{if} (nbd[i\_\_] <= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04540}04540                     \textcolor{comment}{/* Computing MIN */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04541}04541                     d\_\_1 = x[i\_\_] -\/ l[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04542}04542                     gi = fmin(d\_\_1,gi);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04543}04543                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04544}04544             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04545}04545         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04546}04546         \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04547}04547         d\_\_1 = *sbgnrm, d\_\_2 = fabs(gi);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04548}04548         *sbgnrm = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04549}04549         \textcolor{comment}{/* L15: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04550}04550     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04551}04551     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04552}04552 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04553}04553 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04554}04554  \textcolor{keywordtype}{int} Lbfgs::subsm(integer *n, integer *m, integer *nsub, integer *}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04555}04555     ind, \textcolor{keywordtype}{double} *l, \textcolor{keywordtype}{double} *u, integer *nbd, \textcolor{keywordtype}{double} *x,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04556}04556     \textcolor{keywordtype}{double} *d\_\_, \textcolor{keywordtype}{double} *xp, \textcolor{keywordtype}{double} *ws, \textcolor{keywordtype}{double} *wy,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04557}04557     \textcolor{keywordtype}{double} *theta, \textcolor{keywordtype}{double} *xx, \textcolor{keywordtype}{double} *gg, integer *col,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04558}04558     integer *head, integer *iword, \textcolor{keywordtype}{double} *wv, \textcolor{keywordtype}{double} *wn,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04559}04559     integer *iprint, integer *info)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04560}04560 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04561}04561 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04562}04562     \textcolor{comment}{/* System generated locals */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04563}04563     integer ws\_dim1, ws\_offset, wy\_dim1, wy\_offset, wn\_dim1, wn\_offset, i\_\_1,}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04564}04564         i\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04565}04565     \textcolor{keywordtype}{double} d\_\_1, d\_\_2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04566}04566 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04567}04567     \textcolor{comment}{/* Local variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04568}04568     integer i\_\_, j, k, m2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04569}04569     \textcolor{keywordtype}{double} dk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04570}04570     integer js, jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04571}04571     \textcolor{keywordtype}{double} xk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04572}04572     integer ibd, col2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04573}04573      \textcolor{keywordtype}{double} dd\_p\_\_, temp1, temp2, alpha;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04574}04574      integer pointr;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04575}04575 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04576}04576 \textcolor{comment}{/*     ********************************************************************** */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04577}04577 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04578}04578 \textcolor{comment}{/*     This routine contains the major changes in the updated version. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04579}04579 \textcolor{comment}{/*     The changes are described in the accompanying paper */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04580}04580 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04581}04581 \textcolor{comment}{/*      Jose Luis Morales, Jorge Nocedal */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04582}04582 \textcolor{comment}{/*      "{}Remark On Algorithm 788: L-\/BFGS-\/B: Fortran Subroutines for Large-\/Scale */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04583}04583 \textcolor{comment}{/*       Bound Constrained Optimization"{}. Decemmber 27, 2010. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04584}04584 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04585}04585 \textcolor{comment}{/*             J.L. Morales  Departamento de Matematicas, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04586}04586 \textcolor{comment}{/*                           Instituto Tecnologico Autonomo de Mexico */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04587}04587 \textcolor{comment}{/*                           Mexico D.F. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04588}04588 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04589}04589 \textcolor{comment}{/*             J, Nocedal    Department of Electrical Engineering and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04590}04590 \textcolor{comment}{/*                           Computer Science. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04591}04591 \textcolor{comment}{/*                           Northwestern University. Evanston, IL. USA */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04592}04592 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04593}04593 \textcolor{comment}{/*                           January 17, 2011 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04594}04594 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04595}04595 \textcolor{comment}{/*      ********************************************************************** */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04596}04596 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04597}04597 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04598}04598 \textcolor{comment}{/*     Subroutine subsm */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04599}04599 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04600}04600 \textcolor{comment}{/*     Given xcp, l, u, r, an index set that specifies */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04601}04601 \textcolor{comment}{/*       the active set at xcp, and an l-\/BFGS matrix B */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04602}04602 \textcolor{comment}{/*       (in terms of WY, WS, SY, WT, head, col, and theta), */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04603}04603 \textcolor{comment}{/*       this subroutine computes an approximate solution */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04604}04604 \textcolor{comment}{/*       of the subspace problem */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04605}04605 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04606}04606 \textcolor{comment}{/*       (P)   min Q(x) = r'(x-\/xcp) + 1/2 (x-\/xcp)' B (x-\/xcp) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04607}04607 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04608}04608 \textcolor{comment}{/*             subject to l<=x<=u */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04609}04609 \textcolor{comment}{/*                       x\_i=xcp\_i for all i in A(xcp) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04610}04610 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04611}04611 \textcolor{comment}{/*       along the subspace unconstrained Newton direction */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04612}04612 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04613}04613 \textcolor{comment}{/*          d = -\/(Z'BZ)\string^(-\/1) r. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04614}04614 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04615}04615 \textcolor{comment}{/*       The formula for the Newton direction, given the L-\/BFGS matrix */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04616}04616 \textcolor{comment}{/*       and the Sherman-\/Morrison formula, is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04617}04617 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04618}04618 \textcolor{comment}{/*          d = (1/theta)r + (1/theta*2) Z'WK\string^(-\/1)W'Z r. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04619}04619 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04620}04620 \textcolor{comment}{/*       where */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04621}04621 \textcolor{comment}{/*                 K = [-\/D -\/Y'ZZ'Y/theta     L\_a'-\/R\_z'  ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04622}04622 \textcolor{comment}{/*                     [L\_a -\/R\_z           theta*S'AA'S ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04623}04623 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04624}04624 \textcolor{comment}{/*     Note that this procedure for computing d differs */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04625}04625 \textcolor{comment}{/*     from that described in [1]. One can show that the matrix K is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04626}04626 \textcolor{comment}{/*     equal to the matrix M\string^[-\/1]N in that paper. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04627}04627 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04628}04628 \textcolor{comment}{/*     n is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04629}04629 \textcolor{comment}{/*       On entry n is the dimension of the problem. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04630}04630 \textcolor{comment}{/*       On exit n is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04631}04631 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04632}04632 \textcolor{comment}{/*     m is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04633}04633 \textcolor{comment}{/*       On entry m is the maximum number of variable metric corrections */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04634}04634 \textcolor{comment}{/*         used to define the limited memory matrix. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04635}04635 \textcolor{comment}{/*       On exit m is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04636}04636 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04637}04637 \textcolor{comment}{/*     nsub is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04638}04638 \textcolor{comment}{/*       On entry nsub is the number of free variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04639}04639 \textcolor{comment}{/*       On exit nsub is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04640}04640 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04641}04641 \textcolor{comment}{/*     ind is an integer array of dimension nsub. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04642}04642 \textcolor{comment}{/*       On entry ind specifies the coordinate indices of free variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04643}04643 \textcolor{comment}{/*       On exit ind is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04644}04644 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04645}04645 \textcolor{comment}{/*     l is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04646}04646 \textcolor{comment}{/*       On entry l is the lower bound of x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04647}04647 \textcolor{comment}{/*       On exit l is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04648}04648 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04649}04649 \textcolor{comment}{/*     u is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04650}04650 \textcolor{comment}{/*       On entry u is the upper bound of x. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04651}04651 \textcolor{comment}{/*       On exit u is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04652}04652 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04653}04653 \textcolor{comment}{/*     nbd is a integer array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04654}04654 \textcolor{comment}{/*       On entry nbd represents the type of bounds imposed on the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04655}04655 \textcolor{comment}{/*         variables, and must be specified as follows: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04656}04656 \textcolor{comment}{/*         nbd(i)=0 if x(i) is unbounded, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04657}04657 \textcolor{comment}{/*                1 if x(i) has only a lower bound, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04658}04658 \textcolor{comment}{/*                2 if x(i) has both lower and upper bounds, and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04659}04659 \textcolor{comment}{/*                3 if x(i) has only an upper bound. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04660}04660 \textcolor{comment}{/*       On exit nbd is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04661}04661 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04662}04662 \textcolor{comment}{/*     x is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04663}04663 \textcolor{comment}{/*       On entry x specifies the Cauchy point xcp. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04664}04664 \textcolor{comment}{/*       On exit x(i) is the minimizer of Q over the subspace of */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04665}04665 \textcolor{comment}{/*                                                        free variables. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04666}04666 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04667}04667 \textcolor{comment}{/*     d is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04668}04668 \textcolor{comment}{/*       On entry d is the reduced gradient of Q at xcp. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04669}04669 \textcolor{comment}{/*       On exit d is the Newton direction of Q. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04670}04670 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04671}04671 \textcolor{comment}{/*    xp is a double precision array of dimension n. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04672}04672 \textcolor{comment}{/*       used to safeguard the projected Newton direction */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04673}04673 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04674}04674 \textcolor{comment}{/*    xx is a double precision array of dimension n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04675}04675 \textcolor{comment}{/*       On entry it holds the current iterate */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04676}04676 \textcolor{comment}{/*       On output it is unchanged */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04677}04677 \textcolor{comment}{/*    gg is a double precision array of dimension n */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04678}04678 \textcolor{comment}{/*       On entry it holds the gradient at the current iterate */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04679}04679 \textcolor{comment}{/*       On output it is unchanged */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04680}04680 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04681}04681 \textcolor{comment}{/*     ws and wy are double precision arrays; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04682}04682 \textcolor{comment}{/*     theta is a double precision variable; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04683}04683 \textcolor{comment}{/*     col is an integer variable; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04684}04684 \textcolor{comment}{/*     head is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04685}04685 \textcolor{comment}{/*       On entry they store the information defining the */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04686}04686 \textcolor{comment}{/*                                          limited memory BFGS matrix: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04687}04687 \textcolor{comment}{/*         ws(n,m) stores S, a set of s-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04688}04688 \textcolor{comment}{/*         wy(n,m) stores Y, a set of y-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04689}04689 \textcolor{comment}{/*         theta is the scaling factor specifying B\_0 = theta I; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04690}04690 \textcolor{comment}{/*         col is the number of variable metric corrections stored; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04691}04691 \textcolor{comment}{/*         head is the location of the 1st s-\/ (or y-\/) vector in S (or Y). */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04692}04692 \textcolor{comment}{/*       On exit they are unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04693}04693 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04694}04694 \textcolor{comment}{/*     iword is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04695}04695 \textcolor{comment}{/*       On entry iword is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04696}04696 \textcolor{comment}{/*       On exit iword specifies the status of the subspace solution. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04697}04697 \textcolor{comment}{/*         iword = 0 if the solution is in the box, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04698}04698 \textcolor{comment}{/*                 1 if some bound is encountered. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04699}04699 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04700}04700 \textcolor{comment}{/*     wv is a double precision working array of dimension 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04701}04701 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04702}04702 \textcolor{comment}{/*     wn is a double precision array of dimension 2m x 2m. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04703}04703 \textcolor{comment}{/*       On entry the upper triangle of wn stores the LEL\string^T factorization */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04704}04704 \textcolor{comment}{/*         of the indefinite matrix */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04705}04705 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04706}04706 \textcolor{comment}{/*              K = [-\/D -\/Y'ZZ'Y/theta     L\_a'-\/R\_z'  ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04707}04707 \textcolor{comment}{/*                  [L\_a -\/R\_z           theta*S'AA'S ] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04708}04708 \textcolor{comment}{/*                                                    where E = [-\/I  0] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04709}04709 \textcolor{comment}{/*                                                              [ 0  I] */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04710}04710 \textcolor{comment}{/*       On exit wn is unchanged. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04711}04711 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04712}04712 \textcolor{comment}{/*     iprint is an INTEGER variable that must be set by the user. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04713}04713 \textcolor{comment}{/*       It controls the frequency and type of output generated: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04714}04714 \textcolor{comment}{/*        iprint<0    no output is generated; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04715}04715 \textcolor{comment}{/*        iprint=0    print only one line at the last iteration; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04716}04716 \textcolor{comment}{/*        0<iprint<99 print also f and |proj g| every iprint iterations; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04717}04717 \textcolor{comment}{/*        iprint=99   print details of every iteration except n-\/vectors; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04718}04718 \textcolor{comment}{/*        iprint=100  print also the changes of active set and final x; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04719}04719 \textcolor{comment}{/*        iprint>100  print details of every iteration including x and g; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04720}04720 \textcolor{comment}{/*       When iprint > 0, the file iterate.dat will be created to */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04721}04721 \textcolor{comment}{/*                        summarize the iteration. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04722}04722 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04723}04723 \textcolor{comment}{/*     info is an integer variable. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04724}04724 \textcolor{comment}{/*       On entry info is unspecified. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04725}04725 \textcolor{comment}{/*       On exit info = 0       for normal return, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04726}04726 \textcolor{comment}{/*                    = nonzero for abnormal return */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04727}04727 \textcolor{comment}{/*                                  when the matrix K is ill-\/conditioned. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04728}04728 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04729}04729 \textcolor{comment}{/*     Subprograms called: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04730}04730 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04731}04731 \textcolor{comment}{/*       Linpack dtrsl. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04732}04732 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04733}04733 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04734}04734 \textcolor{comment}{/*     References: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04735}04735 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04736}04736 \textcolor{comment}{/*       [1] R. H. Byrd, P. Lu, J. Nocedal and C. Zhu, ``A limited */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04737}04737 \textcolor{comment}{/*       memory algorithm for bound constrained optimization'', */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04738}04738 \textcolor{comment}{/*       SIAM J. Scientific Computing 16 (1995), no. 5, pp. 1190-\/-\/1208. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04739}04739 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04740}04740 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04741}04741 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04742}04742 \textcolor{comment}{/*                           *  *  * */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04743}04743 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04744}04744 \textcolor{comment}{/*     NEOS, November 1994. (Latest revision June 1996.) */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04745}04745 \textcolor{comment}{/*     Optimization Technology Center. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04746}04746 \textcolor{comment}{/*     Argonne National Laboratory and Northwestern University. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04747}04747 \textcolor{comment}{/*     Written by */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04748}04748 \textcolor{comment}{/*                        Ciyou Zhu */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04749}04749 \textcolor{comment}{/*     in collaboration with R.H. Byrd, P. Lu-\/Chen and J. Nocedal. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04750}04750 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04751}04751 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04752}04752 \textcolor{comment}{/*     ************ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04753}04753 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04754}04754     \textcolor{comment}{/* Parameter adjustments */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04755}04755     -\/-\/gg;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04756}04756     -\/-\/xx;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04757}04757     -\/-\/xp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04758}04758     -\/-\/d\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04759}04759     -\/-\/x;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04760}04760     -\/-\/nbd;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04761}04761     -\/-\/u;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04762}04762     -\/-\/l;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04763}04763     wn\_dim1 = 2 * *m;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04764}04764     wn\_offset = 1 + wn\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04765}04765     wn -\/= wn\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04766}04766     -\/-\/wv;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04767}04767     wy\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04768}04768     wy\_offset = 1 + wy\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04769}04769     wy -\/= wy\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04770}04770     ws\_dim1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04771}04771     ws\_offset = 1 + ws\_dim1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04772}04772     ws -\/= ws\_offset;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04773}04773     -\/-\/ind;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04774}04774 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04775}04775     \textcolor{comment}{/* Function Body */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04776}04776     \textcolor{keywordflow}{if} (*nsub <= 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04777}04777         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04778}04778     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04779}04779     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04780}04780         printf(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/SUBSM entered-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04781}04781     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04782}04782     \textcolor{comment}{/*     Compute wv = W'Zd. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04783}04783     pointr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04784}04784     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04785}04785     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04786}04786         temp1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04787}04787         temp2 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04788}04788         i\_\_2 = *nsub;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04789}04789         \textcolor{keywordflow}{for} (j = 1; j <= i\_\_2; ++j) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04790}04790             k = ind[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04791}04791             temp1 += wy[k + pointr * wy\_dim1] * d\_\_[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04792}04792             temp2 += ws[k + pointr * ws\_dim1] * d\_\_[j];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04793}04793             \textcolor{comment}{/* L10: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04794}04794         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04795}04795         wv[i\_\_] = temp1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04796}04796         wv[*col + i\_\_] = *theta * temp2;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04797}04797         pointr = pointr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04798}04798         \textcolor{comment}{/* L20: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04799}04799     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04800}04800     \textcolor{comment}{/*     Compute wv:=K\string^(-\/1)wv. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04801}04801     m2 = *m << 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04802}04802     col2 = *col << 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04803}04803     dtrsl(\&wn[wn\_offset], \&m2, \&col2, \&wv[1], \&c\_\_11, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04804}04804     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04805}04805         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04806}04806     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04807}04807     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04808}04808     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04809}04809         wv[i\_\_] = -\/wv[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04810}04810         \textcolor{comment}{/* L25: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04811}04811     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04812}04812     dtrsl(\&wn[wn\_offset], \&m2, \&col2, \&wv[1], \&c\_\_1, info);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04813}04813     \textcolor{keywordflow}{if} (*info != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04814}04814         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04815}04815     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04816}04816     \textcolor{comment}{/*     Compute d = (1/theta)d + (1/theta**2)Z'W wv. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04817}04817     pointr = *head;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04818}04818     i\_\_1 = *col;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04819}04819     \textcolor{keywordflow}{for} (jy = 1; jy <= i\_\_1; ++jy) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04820}04820         js = *col + jy;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04821}04821         i\_\_2 = *nsub;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04822}04822         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_2; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04823}04823             k = ind[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04824}04824             d\_\_[i\_\_] = d\_\_[i\_\_] + wy[k + pointr * wy\_dim1] * wv[jy] / *theta}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04825}04825                 + ws[k + pointr * ws\_dim1] * wv[js];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04826}04826             \textcolor{comment}{/* L30: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04827}04827         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04828}04828         pointr = pointr \% *m + 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04829}04829         \textcolor{comment}{/* L40: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04830}04830     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04831}04831     d\_\_1 = 1. / *theta;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04832}04832     dscal(nsub, \&d\_\_1, \&d\_\_[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04833}04833 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04834}04834     \textcolor{comment}{/* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04835}04835     \textcolor{comment}{/*     Let us try the projection, d is the Newton direction */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04836}04836     *iword = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04837}04837     dcopy(n, \&x[1], \&c\_\_1, \&xp[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04838}04838 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04839}04839     i\_\_1 = *nsub;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04840}04840     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04841}04841         k = ind[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04842}04842         dk = d\_\_[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04843}04843         xk = x[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04844}04844         \textcolor{keywordflow}{if} (nbd[k] != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04845}04845 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04846}04846             \textcolor{keywordflow}{if} (nbd[k] == 1) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04847}04847                 \textcolor{comment}{/* lower bounds only */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04848}04848                 \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04849}04849                 d\_\_1 = l[k], d\_\_2 = xk + dk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04850}04850                 x[k] = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04851}04851                 \textcolor{keywordflow}{if} (x[k] == l[k]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04852}04852                     *iword = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04853}04853                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04854}04854             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04855}04855 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04856}04856                 \textcolor{keywordflow}{if} (nbd[k] == 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04857}04857                     \textcolor{comment}{/* upper and lower bounds */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04858}04858                     \textcolor{comment}{/* Computing MAX */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04859}04859                     d\_\_1 = l[k], d\_\_2 = xk + dk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04860}04860                     xk = fmax(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04861}04861                     \textcolor{comment}{/* Computing MIN */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04862}04862                     d\_\_1 = u[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04863}04863                     x[k] = fmin(d\_\_1,xk);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04864}04864                     \textcolor{keywordflow}{if} (x[k] == l[k] || x[k] == u[k]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04865}04865                         *iword = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04866}04866                     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04867}04867                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04868}04868 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04869}04869                     \textcolor{keywordflow}{if} (nbd[k] == 3) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04870}04870                         \textcolor{comment}{/* upper bounds only */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04871}04871                         \textcolor{comment}{/* Computing MIN */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04872}04872                         d\_\_1 = u[k], d\_\_2 = xk + dk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04873}04873                         x[k] = fmin(d\_\_1,d\_\_2);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04874}04874                         \textcolor{keywordflow}{if} (x[k] == u[k]) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04875}04875                             *iword = 1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04876}04876                         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04877}04877                     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04878}04878                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04879}04879             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04880}04880 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04881}04881         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04882}04882             \textcolor{comment}{/* free variables */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04883}04883             x[k] = xk + dk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04884}04884         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04885}04885         \textcolor{comment}{/* L50: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04886}04886     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04887}04887 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04888}04888     \textcolor{keywordflow}{if} (*iword == 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04889}04889         \textcolor{keywordflow}{goto} L911;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04890}04890     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04891}04891 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04892}04892     \textcolor{comment}{/*     check sign of the directional derivative */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04893}04893 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04894}04894     dd\_p\_\_ = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04895}04895     i\_\_1 = *n;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04896}04896     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04897}04897         dd\_p\_\_ += (x[i\_\_] -\/ xx[i\_\_]) * gg[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04898}04898         \textcolor{comment}{/* L55: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04899}04899     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04900}04900     \textcolor{keywordflow}{if} (dd\_p\_\_ > 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04901}04901         dcopy(n, \&xp[1], \&c\_\_1, \&x[1], \&c\_\_1);}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04902}04902 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04903}04903     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04904}04904         \textcolor{keywordflow}{goto} L911;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04905}04905     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04906}04906 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04907}04907     \textcolor{comment}{/* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04908}04908 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04909}04909     alpha = 1.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04910}04910     temp1 = alpha;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04911}04911     ibd = 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04912}04912     i\_\_1 = *nsub;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04913}04913     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04914}04914         k = ind[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04915}04915         dk = d\_\_[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04916}04916         \textcolor{keywordflow}{if} (nbd[k] != 0) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04917}04917             \textcolor{keywordflow}{if} (dk < 0. \&\& nbd[k] <= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04918}04918                 temp2 = l[k] -\/ x[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04919}04919                 \textcolor{keywordflow}{if} (temp2 >= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04920}04920                     temp1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04921}04921                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dk * alpha < temp2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04922}04922                     temp1 = temp2 / dk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04923}04923                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04924}04924             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dk > 0. \&\& nbd[k] >= 2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04925}04925                 temp2 = u[k] -\/ x[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04926}04926                 \textcolor{keywordflow}{if} (temp2 <= 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04927}04927                     temp1 = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04928}04928                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dk * alpha > temp2) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04929}04929                     temp1 = temp2 / dk;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04930}04930                 \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04931}04931             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04932}04932             \textcolor{keywordflow}{if} (temp1 < alpha) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04933}04933                 alpha = temp1;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04934}04934                 ibd = i\_\_;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04935}04935             \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04936}04936         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04937}04937         \textcolor{comment}{/* L60: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04938}04938     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04939}04939     \textcolor{keywordflow}{if} (alpha < 1.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04940}04940         dk = d\_\_[ibd];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04941}04941         k = ind[ibd];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04942}04942         \textcolor{keywordflow}{if} (dk > 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04943}04943             x[k] = u[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04944}04944             d\_\_[ibd] = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04945}04945         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dk < 0.) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04946}04946             x[k] = l[k];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04947}04947             d\_\_[ibd] = 0.;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04948}04948         \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04949}04949     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04950}04950     i\_\_1 = *nsub;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04951}04951     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04952}04952         k = ind[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04953}04953         x[k] += alpha * d\_\_[i\_\_];}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04954}04954         \textcolor{comment}{/* L70: */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04955}04955     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04956}04956     \textcolor{comment}{/* ccccc */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04957}04957 L911:}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04958}04958     \textcolor{keywordflow}{if} (*iprint >= 99) \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04959}04959         printf(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ exit SUBSM -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04960}04960     \}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04961}04961     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04962}04962 \} \textcolor{comment}{/* subsm */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04963}04963 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04964}04964 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04965}04965 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04966}04966 \textcolor{keywordtype}{int} Lbfgs::timer(\textcolor{keywordtype}{double} *ttime)}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04967}04967 \{}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04968}04968     clock\_t temp;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04969}04969 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04970}04970 \textcolor{comment}{/*     this routine computes cpu time in double precision; it makes use of */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04971}04971 \textcolor{comment}{/*     the intrinsic f90 cpu\_time therefore a conversion type is */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04972}04972 \textcolor{comment}{/*     needed. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04973}04973 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04974}04974 \textcolor{comment}{/*           j.l morales  departamento de Matematicas, */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04975}04975 \textcolor{comment}{/*                        instituto Tecnologico Autonomo de Mexico */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04976}04976 \textcolor{comment}{/*                        mexico D.F. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04977}04977 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04978}04978 \textcolor{comment}{/*           j.l nocedal  department of Electrical Engineering and */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04979}04979 \textcolor{comment}{/*                        computer Science. */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04980}04980 \textcolor{comment}{/*                        northwestern University. Evanston, IL. USA */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04981}04981 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04982}04982 \textcolor{comment}{/*                        january 21, 2011 */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04983}04983 }
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04984}04984 \textcolor{comment}{/*     temp = (real) (*ttime); */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04985}04985 \textcolor{comment}{/*     *ttime = (double) temp; */}}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04986}04986     temp    = clock();}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04987}04987     *ttime  = ((double) temp)/CLOCKS\_PER\_SEC;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04988}04988     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{lbfgs_8cpp_source_l04989}04989 \} \textcolor{comment}{/* timer */}}

\end{DoxyCode}
